"use strict";(self.webpackChunkWTRW=self.webpackChunkWTRW||[]).push([[232],{670:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.a(module,(async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.r(__webpack_exports__);var _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(277),_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(146);function _createForOfIteratorHelper(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==o.return||o.return()}finally{if(s)throw r}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}function _iterableToArrayLimit(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,i,r,a,s=[],c=!0,l=!1;try{if(r=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;c=!1}else for(;!(c=(n=r.call(o)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var _await$import=await __webpack_require__.e(20).then(__webpack_require__.bind(__webpack_require__,690)),_Map_=_await$import._Map_,Avatar=_await$import.Avatar,House1=_await$import.House1,UrbanFence=_await$import.UrbanFence,UrbanFenceHalf=_await$import.UrbanFenceHalf,UrbanFenceVertical=_await$import.UrbanFenceVertical,RoadRail=_await$import.RoadRail,RoadRailVertical=_await$import.RoadRailVertical,PicnicTable=_await$import.PicnicTable,StreetLight=_await$import.StreetLight,Chair=_await$import.Chair,Table=_await$import.Table,GLOCK_20=_await$import.GLOCK_20,Text=_await$import.Text,VisibleBarrier=_await$import.VisibleBarrier,DownwardLight=_await$import.DownwardLight,Barrier=_await$import.Barrier,Laptop=_await$import.Laptop,BlackBook=_await$import.BlackBook,WhiteBook=_await$import.WhiteBook,NXR_44_MAG=_await$import.NXR_44_MAG,GP_K100=_await$import.GP_K100,KC_357=_await$import.KC_357,USP_45=_await$import.USP_45,Grass=_await$import.Grass,Grass2=_await$import.Grass2,Bench=_await$import.Bench,Rocks1=_await$import.Rocks1,Rocks2=_await$import.Rocks2,BulletShell=_await$import.BulletShell,Plus100=_await$import.Plus100,KitchenKnife=_await$import.KitchenKnife,AssassinsKnife=_await$import.AssassinsKnife,Bot=_await$import.Bot,Bush=_await$import.Bush,ConvenienceStore=_await$import.ConvenienceStore,LightBush=_await$import.LightBush,MixedBush=_await$import.MixedBush,Stopper=_await$import.Stopper,MetalFence=_await$import.MetalFence,MetalFenceVertical=_await$import.MetalFenceVertical,Atm=_await$import.Atm,Gazebo=_await$import.Gazebo,Floor=_await$import.Floor,Shed=_await$import.Shed,Tile=_await$import.Tile,Syringe=_await$import.Syringe,Vendor1=_await$import.Vendor1,_Joystick_=_await$import._Joystick_,_Button_=_await$import._Button_,House2=_await$import.House2,GunStore=_await$import.GunStore,GreyBackpack=_await$import.GreyBackpack,WhiteBackpack=_await$import.WhiteBackpack,BlackBackpack=_await$import.BlackBackpack,Whiteboard=_await$import.Whiteboard,Pinboard=_await$import.Pinboard,SmallTable=_await$import.SmallTable,MedKit=_await$import.MedKit,AmmoBox=_await$import.AmmoBox,MultiAmmoBox=_await$import.MultiAmmoBox,BasicArmour=_await$import.BasicArmour,MercenaryArmour=_await$import.MercenaryArmour,SwatArmour=_await$import.SwatArmour,SteakAndFries=_await$import.SteakAndFries,DX_9=_await$import.DX_9,FURS_55=_await$import.FURS_55,NOSS_7=_await$import.NOSS_7,X6_91=_await$import.X6_91,RemoteExplosive=_await$import.RemoteExplosive,RemoteDetonator=_await$import.RemoteDetonator,ProximityExplosive=_await$import.ProximityExplosive,CombatKnife=_await$import.CombatKnife,Money=_await$import.Money,Door=_await$import.Door,LightSwitch=_await$import.LightSwitch,SmallPlant=_await$import.SmallPlant,grabButton=document.querySelector(".grab-button"),actionButton=document.querySelector(".action-button");function toggleGrab(e){e.preventDefault(),$AVATAR.grab()?grabButton.style.opacity="0.5":($AVATAR.drop(),grabButton.style.opacity="1")}function runAction(e){if($CURRENT_MAP.currentInteractable&&$CURRENT_MAP.currentInteractable!==$AVATAR.state.pickup.current){var t=$CURRENT_MAP.interactables[$CURRENT_MAP.currentInteractable.id];t&&t.action(),$CURRENT_MAP.updateInteractable()}}grabButton.ontouchstart=toggleGrab,grabButton.onclick=toggleGrab,$IS_MOBILE||window.addEventListener("keydown",(function(e){"KeyE"===e.code&&runAction(e)})),actionButton.ontouchstart=runAction,actionButton.onclick=runAction;var subtitles=document.querySelector(".subtitles"),optionsContainer=document.querySelector(".bottom-panel__options"),dialogueOption1=document.querySelector(".option-1"),dialogueOption2=document.querySelector(".option-2"),optionNavUp=document.querySelector(".nav-up"),optionNavDown=document.querySelector(".nav-down"),speakButton=document.querySelector(".speak-button"),selectedModule=0,selectedOption=0,currentOptions=[0,1],optionSelect=!0;function updateOptions(){if(_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[0]){if(optionSelect?(dialogueOption1.innerText=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].label||_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].getContent(),dialogueOption2.innerText=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption+1].label||_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption+1].getContent()):(dialogueOption1.innerText="...",dialogueOption2.innerText="..."),updateNav(),selectedOption===currentOptions[0])return dialogueOption1.style.backgroundColor="#444444",void(dialogueOption2.style.backgroundColor="#222222");dialogueOption2.style.backgroundColor="#444444",dialogueOption1.style.backgroundColor="#222222"}}function updateNav(){document.querySelector(".nav-up div").style.opacity=selectedOption-1<0?"0.5":"1",document.querySelector(".nav-down div").style.opacity=selectedOption+1>_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options.length-1?"0.5":"1"}function updateSubtitles(e,t){var o=optionSelect?$AVATAR.character:$ACTIVE_DIALOGUE_PARTY.character;subtitles.innerHTML="<strong>".concat(o,":</strong> ..."),setTimeout((function(){var n,i=0,r=e;n=setInterval((function(){subtitles.innerHTML="<strong>".concat(o,":</strong> ")+r.slice(0,i),++i>r.length&&(clearInterval(n),t&&t())}),50)}),1e3)}function processResponse(){updateSubtitles(_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].getContent(),(function(){_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].action&&_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].action(),_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].getDestination()&&setTimeout((function(){var e=_slicedToArray(_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].getDestination(),2),t=e[0],o=e[1];updateSubtitles(_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[t].responses[o].getContent(),(function(){_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[t].responses[o].action&&_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[t].responses[o].action(),_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[t].responses[o].getDestination()&&(selectedModule=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[t].responses[o].getDestination()[0],selectedOption=0,currentOptions=[0,1],optionSelect=!0,updateOptions())}))}),1e3)})),optionSelect=!1,updateOptions()}function startDialogue(e){toggleNote("Sorry, we're working on that! Dialogue will be included in newer versions.")}optionNavUp.onmousedown=function(){if(selectedOption>0&&optionSelect){if(selectedOption--,updateNav(),selectedOption<currentOptions[0]&&selectedOption<currentOptions[1]&&(currentOptions=[selectedOption,selectedOption+1]),dialogueOption1.style.color=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[0]].enabled?"white":"darkgray",dialogueOption2.style.color=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[1]].enabled?"white":"darkgray",dialogueOption1.innerText=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[0]].label||_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[0]].getContent(),dialogueOption2.innerText=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[1]].label||_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[1]].getContent(),selectedOption===currentOptions[0])return dialogueOption1.style.backgroundColor="#444444",void(dialogueOption2.style.backgroundColor="#222222");dialogueOption2.style.backgroundColor="#444444",dialogueOption1.style.backgroundColor="#222222"}},optionNavDown.onmousedown=function(){if(selectedOption<_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options.length-1&&optionSelect){if(selectedOption++,updateNav(),selectedOption>currentOptions[0]&&selectedOption>currentOptions[1]&&(currentOptions=[selectedOption-1,selectedOption]),dialogueOption1.style.color=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[0]].enabled?"white":"darkgray",dialogueOption2.style.color=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[1]].enabled?"white":"darkgray",dialogueOption1.innerText=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[0]].label||_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[0]].getContent(),dialogueOption2.innerText=_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[1]].label||_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[currentOptions[1]].getContent(),selectedOption===currentOptions[0])return dialogueOption1.style.backgroundColor="#444444",void(dialogueOption2.style.backgroundColor="#222222");dialogueOption2.style.backgroundColor="#444444",dialogueOption1.style.backgroundColor="#222222"}},optionsContainer.onclick=function(){optionSelect&&$ACTIVE_DIALOGUE_PARTY&&_src_scripts_dialogue_js__WEBPACK_IMPORTED_MODULE_0__.A[selectedModule].options[selectedOption].enabled&&processResponse()},window.endDialogue=function(e){$ACTIVE_DIALOGUE_PARTY&&($ACTIVE_DIALOGUE_PARTY.wander(),$ACTIVE_DIALOGUE_PARTY=void 0,requestTransition((function(){document.querySelector("#mainControls").style.display="block",document.querySelector("#dialogue").style.display="none",$CURRENT_MAP.move=!0}),10))},speakButton.ontouchstart=startDialogue,speakButton.onclick=startDialogue,updateOptions();var openCraftingButton=document.querySelectorAll(".controls-container__button").item(2);openCraftingButton.addEventListener("click",(function(){toggleNote("Sorry, we're working on that! Crafting will be included in newer versions.")}));var mapContainer=document.querySelector("#map"),closeMapButton=document.querySelector("#map-close"),openMapButton=document.querySelectorAll(".controls-container__button").item(1),setWaypointButton=document.querySelector("#set-waypoint");function showMap(e){e.preventDefault(),updateMapData(),$MAP_DISPLAY.useInteractiveDisplay=!0,updateCoordinates($CURRENT_MAP.centerX+$MAP_DISPLAY.displayOffset.x,$CURRENT_MAP.centerY-$MAP_DISPLAY.displayOffset.y),mapContainer.style.display="grid",updateDisplayViewport()}function hideMap(e){e.preventDefault(),$MAP_DISPLAY.useInteractiveDisplay=!1,$MAP_DISPLAY.useWorldMap=!1,$MAP_DISPLAY.displayOffset.x=0,$MAP_DISPLAY.displayOffset.y=0,mapContainer.style.display="none"}setWaypointButton.ontouchstart=toggleWaypoint,setWaypointButton.onclick=toggleWaypoint,closeMapButton.ontouchstart=hideMap,closeMapButton.onclick=hideMap,openMapButton.ontouchstart=showMap,openMapButton.onclick=showMap;var mapDisplay=document.querySelector("#mapDisplay"),mdContext1=mapDisplay.getContext("webgl");mapDisplay.width=1e3,mapDisplay.height=1e3;var interactiveMap=document.querySelector("#interactive-map"),mdContext2=interactiveMap.getContext("webgl");interactiveMap.width=1e3,interactiveMap.height=1e3;var offsetAnchor={x:0,y:0},move=!1;function startDisplayMovement(e){e.preventDefault(),move=!0,$MAP_DISPLAY.useWorldMap?(offsetAnchor.x=(e.touches?e.touches[0].clientX:e.clientX)+$MAP_DISPLAY.worldMapOffset.x,offsetAnchor.y=(e.touches?e.touches[0].clientY:e.clientY)+$MAP_DISPLAY.worldMapOffset.y):(offsetAnchor.x=(e.touches?e.touches[0].clientX:e.clientX)+$MAP_DISPLAY.displayOffset.x,offsetAnchor.y=(e.touches?e.touches[0].clientY:e.clientY)+$MAP_DISPLAY.displayOffset.y)}function moveDisplay(e){e.preventDefault(),move&&($MAP_DISPLAY.useWorldMap?($MAP_DISPLAY.worldMapOffset.x=offsetAnchor.x-(e.touches?e.touches[0].clientX:e.clientX),$MAP_DISPLAY.worldMapOffset.y=offsetAnchor.y-(e.touches?e.touches[0].clientY:e.clientY),updateCoordinates($MAP_DISPLAY.worldMapOffset.x,$MAP_DISPLAY.worldMapOffset.y)):($MAP_DISPLAY.displayOffset.x=offsetAnchor.x-(e.touches?e.touches[0].clientX:e.clientX),$MAP_DISPLAY.displayOffset.y=offsetAnchor.y-(e.touches?e.touches[0].clientY:e.clientY),updateCoordinates($CURRENT_MAP.centerX+$MAP_DISPLAY.displayOffset.x,$CURRENT_MAP.centerY-$MAP_DISPLAY.displayOffset.y)))}function stopDisplayMovement(e){e.preventDefault(),move=!1,offsetAnchor={x:0,y:0}}function updateCoordinates(e,t){document.querySelector(".map__coordinates").innerText="x:".concat(Math.round(e),", y:").concat(Math.round(t))}interactiveMap.ontouchstart=startDisplayMovement,interactiveMap.ontouchend=stopDisplayMovement,interactiveMap.ontouchmove=moveDisplay,interactiveMap.onmousedown=startDisplayMovement,interactiveMap.onmouseup=stopDisplayMovement,interactiveMap.onmousemove=moveDisplay;var vShaderSrc="\n        #version 100\n\n        precision highp float;\n\n        attribute vec3 coords;\n        attribute float color;\n        attribute vec2 point;\n        attribute vec2 tcoords;\n\n        varying float colorCode;\n        varying vec2 textrCoord;\n\n        uniform float worldUnitX;\n        uniform float worldUnitY;\n\n        float x;\n        float y;\n\n        uniform vec2 translation;\n        uniform float scale;\n \n        void main() {\n         float offsetX = translation.x; \n         float offsetY = translation.y;\n         float size = scale;\n\n         if (point[0] != 0.01) {\n          offsetX = (point[0] + translation.x) / scale;\n          offsetY = (point[1] + translation.y) / scale;\n          size = 1.0;\n         }\n\n         x = (coords.x + offsetX)*worldUnitX;\n         y = (coords.y + offsetY)*worldUnitY;\n \n         gl_Position = vec4(x,y,1,size);\n         textrCoord = vec2(tcoords[0],tcoords[1]);\n         colorCode = color;\n        }\n  ",fShaderSrc="\n        #version 100\n\n        precision highp float;\n\n        varying float colorCode;\n        varying vec2 textrCoord;\n\n        uniform vec4 color1; \n        uniform vec4 color2;\n        uniform vec4 color3;\n        uniform vec4 color4;\n        uniform vec4 color5;\n        uniform vec4 color6;\n        uniform sampler2D texture;\n        uniform sampler2D texture2;\n        \n        void main() {\n         vec4 color = texture2D(texture,textrCoord);\n        \n          if (colorCode == 1.0) {\n           color = color1;\n          } else if (colorCode == 2.0) {\n           color = color2;\n          } else if (colorCode == 3.0) {\n           color = color3;\n          } else if (colorCode == 4.0) {\n           color = color4;\n          } else if (colorCode == 5.0) {\n           color = color5;\n          } else if (colorCode == 6.0) {\n           color = color6;\n          } else if (colorCode == 0.5) {\n           color = texture2D(texture2,textrCoord);\n           if (color[3] < 0.4) {\n            color[0] = 0.0;\n            color[1] = 0.0;\n            color[2] = 0.0;\n            color[3] = 0.0;\n           }\n          } else if (color[3] > 0.0) {\n           color[0] = 0.7;\n           color[1] = 0.7;\n           color[2] = 0.7;\n           color[3] = 1.0;\n          }\n     \n         gl_FragColor = color;\n        }\n        ";function setDisplayContext(e){var t=e.getExtension("OES_vertex_array_object");e===mdContext1?e.viewport(0,0,mapDisplay.width,mapDisplay.height):e.viewport(0,0,interactiveMap.width,interactiveMap.height),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA);var o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,vShaderSrc),e.compileShader(o);var n=e.getShaderInfoLog(o);n.length>0&&console.log(n);var i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(i,fShaderSrc),e.compileShader(i);var r=e.getShaderInfoLog(i);r.length>0&&console.log(r);var a=e.createProgram();e.attachShader(a,o),e.attachShader(a,i),e.linkProgram(a),e.useProgram(a);var s={translation:e.getUniformLocation(a,"translation"),scale:e.getUniformLocation(a,"scale"),worldUnitX:e.getUniformLocation(a,"worldUnitX"),worldUnitY:e.getUniformLocation(a,"worldUnitY"),color1:e.getUniformLocation(a,"color1"),color2:e.getUniformLocation(a,"color2"),color3:e.getUniformLocation(a,"color3"),color4:e.getUniformLocation(a,"color4"),color5:e.getUniformLocation(a,"color5"),color6:e.getUniformLocation(a,"color6"),coords:e.getAttribLocation(a,"coords"),tcoords:e.getAttribLocation(a,"tcoords"),point:e.getAttribLocation(a,"point"),color:e.getAttribLocation(a,"color"),texture:e.getUniformLocation(a,"texture"),texture2:e.getUniformLocation(a,"texture2")};e.uniform1i(s.texture,0),e.uniform1i(s.texture2,1),e.uniform1f(s.scale,1),e.uniform2fv(s.translation,[0,0]),e.uniform4fv(s.color1,[.39,.39,.39,1]),e.uniform4fv(s.color2,(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Wg)([44,143,219,1])),e.uniform4fv(s.color3,(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Wg)([219,44,44,1])),e.uniform4fv(s.color4,[.7,.7,.7,1]),e.uniform4fv(s.color5,[1,1,1,1]),e.uniform4fv(s.color6,(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Wg)([204,44,219,1])),e.uniform1f(s.worldUnitX,worldUnitX/4+worldUnitY/4),e.uniform1f(s.worldUnitY,worldUnitX/4+worldUnitY/4),e.vertexAttrib2fv(s.point,[.01,.01]);var c=e.createTexture();e.bindTexture(e.TEXTURE_2D,c),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,document.querySelector("#world-map")),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);var l=e.createTexture();return e.bindTexture(e.TEXTURE_2D,l),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,document.querySelector("#pinpoint")),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),{buffer:e.createBuffer(),vao:t.createVertexArrayOES(),ext:t,locations:s,texture:c,texture2:l}}function renderDisplayContext(e,t){e.clear(e.COLOR_BUFFER_BIT),t.ext.bindVertexArrayOES(t.vao),e.uniform1f(t.locations.scale,$MAP_DISPLAY.useInteractiveDisplay?$MAP_DISPLAY.useWorldMap?$MAP_DISPLAY.worldMapScale:$MAP_DISPLAY.interactiveScale:$MAP_DISPLAY.scale),e.uniform2fv(t.locations.translation,[$MAP_DISPLAY.useWorldMap?-$MAP_DISPLAY.worldMapOffset.x:-$CURRENT_MAP.centerX-$MAP_DISPLAY.displayOffset.x,$MAP_DISPLAY.useWorldMap?$MAP_DISPLAY.worldMapOffset.y:-$CURRENT_MAP.centerY+$MAP_DISPLAY.displayOffset.y]),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t.texture2);var o=[].concat(_toConsumableArray($MAP_DISPLAY.objectsVertices),_toConsumableArray($MAP_DISPLAY.avatarsVertices));if($MAP_DISPLAY.useWorldMap&&(o=_toConsumableArray($MAP_DISPLAY.mapVertices)),e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.DYNAMIC_DRAW),e.vertexAttribPointer(t.locations.coords,3,e.FLOAT,!1,32,0),e.vertexAttribPointer(t.locations.color,1,e.FLOAT,!1,32,12),e.vertexAttribPointer(t.locations.point,2,e.FLOAT,!1,32,16),e.vertexAttribPointer(t.locations.tcoords,2,e.FLOAT,!1,32,24),e.enableVertexAttribArray(0),e.enableVertexAttribArray(1),e.enableVertexAttribArray(2),e.enableVertexAttribArray(3),$MAP_DISPLAY.useWorldMap||(e.disableVertexAttribArray(2),e.disableVertexAttribArray(3)),e.drawArrays(e.TRIANGLES,0,o.length/8),$MAP_DISPLAY.useWorldMap&&(o=_toConsumableArray($MAP_DISPLAY.pinpointVertices),e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.DYNAMIC_DRAW),e.drawArrays(e.TRIANGLES,0,o.length/8)),$MAP_DISPLAY.waypoint.set&&$CURRENT_MAP.id===$MAP_DISPLAY.waypoint.map&&!$MAP_DISPLAY.useWorldMap){if((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Io)($CURRENT_MAP.centerX,$CURRENT_MAP.centerY,$MAP_DISPLAY.waypoint.x,$MAP_DISPLAY.waypoint.y)<30)return void toggleWaypoint();e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(_toConsumableArray($MAP_DISPLAY.waypointVertices)),e.DYNAMIC_DRAW),e.vertexAttribPointer(t.locations.coords,3,e.FLOAT,!1,16,0),e.vertexAttribPointer(t.locations.color,1,e.FLOAT,!1,16,12),e.enableVertexAttribArray(0),e.enableVertexAttribArray(1),e.drawArrays(e.TRIANGLE_STRIP,0,$MAP_DISPLAY.waypointVertices.length/4)}}$MAP_DISPLAY={scale:2,interactiveScale:7,worldMapScale:7,useInteractiveDisplay:!1,useWorldMap:!1,displayOffset:{x:0,y:0},worldMapOffset:{x:0,y:0},objectsVertices:[],avatarsVertices:[],waypointVertices:[],pinpointVertices:[],mapVertices:[-600,300,1,0,.01,.01,0,0,600,300,1,0,.01,.01,1,0,-600,-300,1,0,.01,.01,0,1,600,300,1,0,.01,.01,1,0,-600,-300,1,0,.01,.01,0,1,600,-300,1,0,.01,.01,1,1],waypoint:{x:0,y:0,set:!1,map:void 0},colorCodes:{door:5,building:5,"visible barrier":4},updateWaypoint:function(e,t,o,n){$MAP_DISPLAY.waypointVertices=[e,t,1,6,e,t+5,1,6,o,n,1,6,o,n+5,1,6,e+5,t,1,6,e,t,1,6,o,n,1,6,o+5,n,1,6]},addObject:function(e){var t=e.trans,o=t.offsetX,n=t.offsetY,i=this.colorCodes[e.name]||this.colorCodes[e.type]||1;this.objectsVertices=this.objectsVertices.concat((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Jj)([[-e.width/2+o+$CURRENT_MAP.centerX,-e.height/2+n+$CURRENT_MAP.centerY,e.width,e.height]],!1,[1,i,0,0,0,0],!0))},update:function(e){for(var t in e?this.avatarsVertices=[]:this.objectsVertices=[],$CURRENT_MAP.obstacles){var o=$CURRENT_MAP.obstacles[t];if(!("avatar"===o.type&&!e||"avatar"!==o.type&&e||o.hideFromMap)){var n=o.trans,i=n.offsetX,r=n.offsetY,a=this.colorCodes[o.name]||this.colorCodes[o.type]||1;e?this.avatarsVertices=this.avatarsVertices.concat((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Jj)([[-o.width/2+i+$CURRENT_MAP.centerX,-o.height/2+r+$CURRENT_MAP.centerY,o.width,o.height]],!1,[1,o.state.hostile?3:2,0,0,0,0],!0)):this.objectsVertices=this.objectsVertices.concat((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Jj)([[-o.width/2+i+$CURRENT_MAP.centerX,-o.height/2+r+$CURRENT_MAP.centerY,o.width,o.height]],!1,[1,a,0,0,0,0],!0))}}this.waypoint.set&&this.updateWaypoint($CURRENT_MAP.centerX,$CURRENT_MAP.centerY,this.waypoint.x,this.waypoint.y)},addPinpoint:function(e,t){this.pinpointVertices.push(-8,16,1,.5,e,t,0,0,8,16,1,.5,e,t,1,0,-8,-16,1,.5,e,t,0,1,8,16,1,.5,e,t,1,0,-8,-16,1,.5,e,t,0,1,8,-16,1,.5,e,t,1,1)},render:function(){this.useInteractiveDisplay?renderDisplayContext(mdContext2,mdContextProperties2):renderDisplayContext(mdContext1,mdContextProperties1)}},$MAP_DISPLAY.addPinpoint(0,0),$MAP_DISPLAY.addPinpoint(-377,80),$MAP_DISPLAY.addPinpoint(-190,240),$MAP_DISPLAY.addPinpoint(-159,220),$MAP_DISPLAY.addPinpoint(61,172),$MAP_DISPLAY.addPinpoint(-412,55),$MAP_DISPLAY.addPinpoint(-313,39),$MAP_DISPLAY.addPinpoint(-297,8),$MAP_DISPLAY.addPinpoint(-268,75),$MAP_DISPLAY.addPinpoint(-292,-51),$MAP_DISPLAY.addPinpoint(-327,-19),$MAP_DISPLAY.addPinpoint(-544,-184),$MAP_DISPLAY.addPinpoint(-480,136),$MAP_DISPLAY.addPinpoint(-416,170),$MAP_DISPLAY.addPinpoint(-304,177),$MAP_DISPLAY.addPinpoint(-340,192),$MAP_DISPLAY.addPinpoint(-409,114),$MAP_DISPLAY.addPinpoint(-253,-192),$MAP_DISPLAY.addPinpoint(-220,-178),$MAP_DISPLAY.addPinpoint(-49,54),$MAP_DISPLAY.addPinpoint(338,144),$MAP_DISPLAY.addPinpoint(408,86),$MAP_DISPLAY.addPinpoint(398,-151),$MAP_DISPLAY.addPinpoint(451,-172),$MAP_DISPLAY.addPinpoint(543,167);var mdContextProperties1=setDisplayContext(mdContext1),mdContextProperties2=setDisplayContext(mdContext2);function toggleWaypoint(e){e&&e.preventDefault(),$MAP_DISPLAY.useWorldMap||($MAP_DISPLAY.waypoint.set?($MAP_DISPLAY.waypoint.set=!1,$MAP_DISPLAY.waypoint.map=void 0,setWaypointButton.innerText="Set Waypoint"):($MAP_DISPLAY.waypoint.x=$CURRENT_MAP.centerX+$MAP_DISPLAY.displayOffset.x,$MAP_DISPLAY.waypoint.y=$CURRENT_MAP.centerY-$MAP_DISPLAY.displayOffset.y,$MAP_DISPLAY.waypoint.map=$CURRENT_MAP.id,$MAP_DISPLAY.waypoint.set=!0,setWaypointButton.innerText="Unset Waypoint"))}function updateMapData(){document.querySelector("#map-name").innerText=$CURRENT_MAP.name,document.querySelector("#map-dimensions").innerText="".concat($CURRENT_MAP.width,"x").concat($CURRENT_MAP.height),document.querySelector("#map-population").innerText=$CURRENT_MAP.avatarCount,document.querySelector("#map-rooms").innerText=$CURRENT_MAP.SUB_MAP_COUNT,document.querySelector("#map-pickups").innerText=Object.keys($CURRENT_MAP.pickups).length,document.querySelector("#map-objects").innerText=$CURRENT_MAP.objectCount}window.updateDisplayViewport=function(){var e=interactiveMap.getBoundingClientRect(),t=e.width,o=e.height,n=Math.max(t,o),i=n/Math.min(t,o),r=n===t?.01+.01/i:.01+.01*i,a=n===t?.01+.01*i:.01+.01/i;mdContext2.uniform1f(mdContextProperties2.locations.worldUnitX,r),mdContext2.uniform1f(mdContextProperties2.locations.worldUnitY,a),interactiveMap.width=2*t,interactiveMap.height=2*o,mdContext2.viewport(0,0,2*t,2*o)};var mapZoomInButton=document.querySelector("#map-zoom-in"),mapZoomOutButton=document.querySelector("#map-zoom-out");function mapZoomIn(e){e.preventDefault(),$MAP_DISPLAY.useWorldMap?$MAP_DISPLAY.worldMapScale-.5>1&&($MAP_DISPLAY.worldMapScale-=.5):$MAP_DISPLAY.interactiveScale-.5>1&&($MAP_DISPLAY.interactiveScale-=.5)}function mapZoomOut(e){e.preventDefault(),$MAP_DISPLAY.useWorldMap?$MAP_DISPLAY.worldMapScale+.5<15&&($MAP_DISPLAY.worldMapScale+=.5):$MAP_DISPLAY.interactiveScale+.5<15&&($MAP_DISPLAY.interactiveScale+=.5)}mapZoomInButton.ontouchstart=mapZoomIn,mapZoomInButton.onmousedown=mapZoomIn,mapZoomOutButton.ontouchstart=mapZoomOut,mapZoomOutButton.onmousedown=mapZoomOut;var moneyDisplay=document.querySelector("#money");moneyDisplay.innerText=Math.round(localStorage.getItem("player-cash"))||0,window.updateMoneyDisplay=function(){moneyDisplay.innerText=Math.round($AVATAR.inventory.cash),localStorage.setItem("player-cash",$AVATAR.inventory.cash.toString())};var ammoDisplay=document.querySelector("#ammo-display");ammoDisplay.onmousedown=function(){$AVATAR.reload()},ammoDisplay.ontouchstart=function(){$AVATAR.reload()},window.showAmmoDisplay=function(){ammoDisplay.style.display="flex"},window.hideAmmoDisplay=function(){ammoDisplay.style.display="none"},window.disableReloadDisplay=function(){document.querySelector("#ammo-display img").style.display="none",document.querySelector("#ammo-display div").style.display="flex"},window.enableReloadDisplay=function(){document.querySelector("#ammo-display div").style.display="none",document.querySelector("#ammo-display img").style.display="block"},window.updateAmmoDisplay=function(){var e=$AVATAR.state.equippedItems.mainTool;ammoDisplay.querySelector("p").style.color=e.constructor._properties.capacity===e.reloadProgress?"#e30f00":"white",ammoDisplay.querySelector("p").innerText="".concat(Math.min(e.constructor._properties.capacity-e.reloadProgress,$AVATAR.inventory.weapons[e.name].ammo),"/").concat($AVATAR.inventory.weapons[e.name].ammo)};var armourDisplay=document.querySelector("#armour-display");if(window.showArmourDisplay=function(){armourDisplay.style.display="flex"},window.hideArmourDisplay=function(){armourDisplay.style.display="none"},window.updateArmourDisplay=function(){armourDisplay.querySelector("p").innerText="".concat($AVATAR.state.armour)},$HEALTH_BAR=document.querySelector("#healthbar"),window.updateHealthBar=function(){$HEALTH_BAR.style.width="".concat(Math.round((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.l_)($AVATAR.state.vitals.health,100)),"%")},$JOYSTICK_L=new _Joystick_(!0,joystickSizes.left,fixedJoysticks,joystickPositions.left),$IS_MOBILE){var moveJoystick=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.preventDefault(),e.touches[0],e.touches[1],$JOYSTICK_L.base.anchored)c($JOYSTICK_L);else if(t)for(var o=0;o<2;o++){var n,i;if((null===(n=e.touches[o])||void 0===n?void 0:n.clientX)<window.innerWidth/2&&(null===(i=e.touches[o])||void 0===i?void 0:i.identifier)!==$JOYSTICK_R.id){$JOYSTICK_L.id=e.touches[o].identifier,c($JOYSTICK_L);break}}if($JOYSTICK_R.base.anchored)c($JOYSTICK_R);else if(t)for(var r=0;r<2;r++){var a,s;if((null===(a=e.touches[r])||void 0===a?void 0:a.clientX)>window.innerWidth/2&&(null===(s=e.touches[r])||void 0===s?void 0:s.identifier)!==$JOYSTICK_L.id){$JOYSTICK_R.id=e.touches[r].identifier,c($JOYSTICK_R);break}}function c(t){for(var o,n=0;n<2;n++){var i;if((null===(i=e.touches[n])||void 0===i?void 0:i.identifier)===t.id){o=e.touches[n];break}}if(o){var r=o.clientX,a=o.clientY,s=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.np)((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.l_)(r,window.innerWidth),worldWidth)-worldWidth/2,c=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.np)(100-(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.l_)(a,window.innerHeight),worldHeight)-worldHeight/2,l=t.base,u=(l.width,l.height,l.x),d=l.y,p=l.radius,_=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Io)(u,d,s,c),m=p/_;t.base.anchored&&_>p&&(s=(1-m)*u+m*s,c=(1-m)*d+m*c),(_<p||t.base.anchored||!t.fixed)&&t.translate(s,c)}}};$JOYSTICK_R=new _Joystick_(!1,joystickSizes.right,fixedJoysticks,joystickPositions.right),$RELOAD_BUTTON=new _Button_(textures.controls.reloadbutton,textures.controls.reloadbuttonactive,worldWidth/2-38,-worldHeight/2+20,(function(e,t){this.enabled&&($AVATAR.reload(),this.enabled=!1)}),8.5,1.4,!1,[-6,6,1,0,0,6,6,1,.9375,0,-6,-6,1,0,.9375,6,6,1,.9375,0,-6,-6,1,0,.9375,6,-6,1,.9375,.9375]),$RELOAD_BUTTON.hidden=!0,$AVATAR_MODE_BUTTON=new _Button_(textures.controls.avatarmode2,textures.controls.avatarmode1,worldWidth/2-10,worldHeight/2-15,(function(e,t){this.on=!this.on,$AVATAR.state.hostile=!$AVATAR.state.hostile}),9,1.5,!0,[-4.5,4.5,1,0,0,4.5,4.5,1,.703125,0,-4.5,-4.5,1,0,.703125,4.5,4.5,1,.703125,0,-4.5,-4.5,1,0,.703125,4.5,-4.5,1,.703125,.703125]),$AVATAR_MODE_BUTTON.hidden=!0,$DROP_ITEM_BUTTON=new _Button_(textures.controls.dropitem1,textures.controls.dropitem2,worldWidth/2-35,-worldHeight/2+30,(function(e,t){$AVATAR.drop()}),8.5,1.4,!1,[-6,6,1,0,0,6,6,1,.9375,0,-6,-6,1,0,.9375,6,6,1,.9375,0,-6,-6,1,0,.9375,6,-6,1,.9375,.9375]),$DROP_ITEM_BUTTON.hidden=!0,canvas.addEventListener("touchstart",(function(e){e.preventDefault();var t,o=e.touches[e.touches.length-1],n=o.clientX,i=o.clientY,r=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.np)((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.l_)(n,window.innerWidth),worldWidth)-worldWidth/2,a=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.np)(100-(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.l_)(i,window.innerHeight),worldHeight)-worldHeight/2,s=!1,c=_createForOfIteratorHelper($CONTROLS);try{for(c.s();!(t=c.n()).done;){var l=t.value;l instanceof _Button_&&!l.hidden&&l.enabled&&(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Io)(r,a,l.trans.offsetX,l.trans.offsetY)<l.radius&&(l.active=!0,l.touch=o.identifier,l.action(r,a),s=!0)}}catch(e){c.e(e)}finally{c.f()}s||$ACTIVE_DIALOGUE_PARTY||moveJoystick(e)})),canvas.addEventListener("touchmove",(function(e){moveJoystick(e,!1)})),canvas.addEventListener("touchend",(function(e){e.preventDefault();var t,o=Object.values(e.touches).reduce((function(e,t){e.push(t.identifier)}),[]),n=_createForOfIteratorHelper($CONTROLS);try{for(n.s();!(t=n.n()).done;){var i=t.value;!(i instanceof _Button_&&i.active)||i.hidden||null!=o&&o.includes(i.touch)||(i.active=!1,i.postAction&&i.postAction())}}catch(e){n.e(e)}finally{n.f()}for(var r=!1,a=!1,s=0;s<2;s++){var c,l;(null===(c=e.touches[s])||void 0===c?void 0:c.identifier)===$JOYSTICK_L.id&&(r=!0),(null===(l=e.touches[s])||void 0===l?void 0:l.identifier)===$JOYSTICK_R.id&&(a=!0)}r||($AVATAR.state.walking=!1,$JOYSTICK_L.unanchor(),$JOYSTICK_L.fix(),$JOYSTICK_L.id=void 0),a||($CURRENT_MAP.move&&$AVATAR.holsterWeapon(),$JOYSTICK_R.unanchor(),$JOYSTICK_R.fix(),$JOYSTICK_R.id=void 0)})),window.addEventListener("contextmenu",(function(e){e.preventDefault()}))}var inventoryButton=document.querySelectorAll(".controls-container__button").item(0),inventoryCloseButton=document.querySelector(".main-inventory__close"),inventoryWindow=document.querySelector("#main-inventory"),inventoryItemsContainer=document.querySelector("#main-items-container");function closeInventory(e){e.preventDefault(),inventoryWindow.style.display="none"}function openInventory(e){e.preventDefault(),inventoryWindow.style.display="grid",updateDescription()}window.onerror=function(e,t,o,n){sendSystemMessage("".concat(e," (").concat(t,")(").concat(o,":").concat(n,")"))},inventoryCloseButton.onmousedown=closeInventory,inventoryButton.onmousedown=openInventory,inventoryCloseButton.ontouchstart=closeInventory,inventoryButton.ontouchstart=openInventory;var consoleContainer=document.querySelector("#console"),consoleButton=document.querySelector("#console-button"),consoleCloseButton=document.querySelector("#console-close"),consoleSendButton=document.querySelector("#console-send"),consoleInput=document.querySelector("#console-input"),consoleMessages=document.querySelector(".console__messages"),consoleMessageTemplate=document.querySelector("#message-template");function openConsole(e){e.preventDefault(),consoleContainer.style.display="grid"}function closeConsole(e){e.preventDefault(),consoleContainer.style.display="none"}var holdEnter=!1;consoleInput.onkeydown=function(e){"Enter"!==e.key||holdEnter?"Shift"===e.key&&(holdEnter=!0):sendMessage(e)},consoleInput.onkeyup=function(e){"Shift"===e.key&&(holdEnter=!1)};var itemPlacementQueue=[],placeItemButton=document.querySelector("#place-item");function placeItem(e){if(e.preventDefault(),itemPlacementQueue.length){var t=itemPlacementQueue.pop();t.translate($MAP_DISPLAY.displayOffset.x,-$MAP_DISPLAY.displayOffset.y),$CURRENT_MAP.link(t),itemPlacementQueue.length||(placeItemButton.style.display="none")}}function sendSystemMessage(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Script ran sucessfully.",t=consoleMessageTemplate.content.cloneNode(!0);e.length<1||(t.querySelector("div").setAttribute("class","console__message--system"),t.querySelector("strong").innerHTML="WTRW@System: ",t.querySelector("i").innerText=e,consoleMessages.appendChild(t))}function evalCommand(cmd){var command=cmd.replace("cmd","").trim(),result="command not found!",prefix=command.split(" ")[0];switch(command=command.replace(prefix,"").trim(),prefix){case"maximize":document.body.requestFullscreen();break;case"run":try{result=eval(command)}catch(e){result="Couldn't run that script! Error: ".concat(e)}break;case"carry":$CURRENT_MAP.CARRY=$CURRENT_MAP.locateObject(command)||void 0,result="Carrying ".concat(command||"nothing","..."),$MAP_DISPLAY.update();break;case"add":try{$CURRENT_MAP.link(eval("new "+command.replace("add","").trim())),result=command+" added."}catch(e){result="Object not found!"}break;case"place":try{itemPlacementQueue.unshift(eval("new "+command.replace("add","").trim())),placeItemButton.style.display="inline-block",result=command+" added to placement queue. Use '+' on the selected map coordinates."}catch(e){result="Object not found!"}break;case"delete":try{var obj=$CURRENT_MAP.locateObject(command);obj.delete(),result="".concat(command," (").concat(obj.id,") deleted.")}catch(e){result="Object not found!"}break;case"godmode":$AVATAR.state.invinsible=!$AVATAR.state.invinsible,result="God mode "+($AVATAR.state.invinsible?"activated.":"deactivated.");break;case"printlayout":result=$MAP.printLayoutScript();break;case"noclip":noclip=!noclip,result="No clip "+(noclip?"activated.":"deactivated.");break;case"day":$MAP.darkness=1,$MAP.lighting=!1,result="Daytime active.";break;case"evening":$MAP.darkness=2,$MAP.lighting=!1,result="Evening active.";break;case"night":$MAP.darkness=5,$MAP.lighting=!0,result="Nighttime active."}return result}function sendMessage(e){e.preventDefault();var t=consoleInput.value,o=consoleMessageTemplate.content.cloneNode(!0);o.querySelector("div").addEventListener("dblclick",(function(e){consoleInput.value=t})),t.length<1||(o.querySelector("strong").innerHTML=$AVATAR.character+"@User: ",o.querySelector("i").innerText=t,consoleMessages.appendChild(o),t.trim().startsWith("cmd")&&setTimeout((function(){sendSystemMessage(evalCommand(t))}),500),consoleInput.value="")}placeItemButton.onmousedown=placeItem,placeItemButton.ontouchstart=placeItem,consoleCloseButton.onmousedown=closeConsole,consoleButton.onmousedown=openConsole,consoleCloseButton.ontouchstart=closeConsole,consoleButton.ontouchstart=openConsole,consoleSendButton.ontouchstart=sendMessage,consoleSendButton.onmousedown=sendMessage;var itemDescriptions={default:"<strong>Pro tip:</strong> Click an item to select it and see a full description of its properties and usage.</br></br>Oh wait, what items? You're a noob lol.","glock 20":"<h3><u>GLOCK 20</u></h3>A simple, compact and lightweight handgun built for self defense and petty crime. Careful, there's no saftey!","usp 45":"<h3><u>USP 45</u></h3>Powerful high powered scilenced pistol. The most elegible option for a slick assassin.","nxr 44 mag":"<h3><u>NXR_44_MAG</u></h3>High powered, large revolver. Go play sheriff with this I guess. This town ain't big enough for...nevermind.","gp k100":"<h3><u>GP K100</u></h3>This quick and reliable handgun features good capacity, and a basic scilencer and is perfect for a good ol' gun-fight.","kc 357":"<h3><u>KC 357</u></h3> Need a reliable side arm? Try this lightweight revolver with good durability and a long lasting build. Sensetive trigger so, watch it bro. Don't really have anything funny to say here.","kitchen knife":"<h3><u>Kitchen Knife</u></h3>Your run-of-the-mill, single edged cooking knife. Go use this to slice some veggies...or somthing else.","assassins knife":"<h3><u>Assassin's Knife</u></h3>One of the sharpest of blades with a fine edge built for the hand of a professional. This top-of-the-line knife can make quick work of any enemy with minimal armour.",syringe:"<h3><u>Syringe</u></h3>Basic medicine for rapid health regain and quick injection.","med kit":"<h3><u>Med Kit</u></h3>A fully equipped medical store, good for thorough treatment of injuries and heavy health regain. A couple of these on hand will keep your medicinal needs covered. And I know what you're thinking..the answer is no. You can't drink rubbing alcohol.","grey backpack":"<h3><u>Grey Backpack</u></h3>A light backpack. Essential for collecting useful items to ensure survival.","white backpack":"<h3><u>White Backpack</u></h3>Intermediate backpack with high capacity. A preference for many tacticians.","black backpack":"<h3><u>Black Backpack</u></h3>This heavy-duty, military-grade backpack is the clear choice for professionals of all expertises. Never again will you have to decide between what to keep, and what to drop.","ammo box":"<h3><u>Ammo Box</u></h3>Best for a quick bullet refill in the middle of intense battel. Use this to increase the bullet count for the currently equipped weapon by a given factor.","multi ammo box":"<h3><u>Multi Ammo Box</u></h3>An army grade ammunition store, with a variety of calibers for all types of arms. Use this to increase the bullet count for all weapons in your inventory by a given factor.","basic armour":"<h3><u>Basic Armour</u></h3>Lightweight armour built for protection from close calls and bullet scathes. I mean, I wouldn't go looking for trouble or anything with this on though. Then again, pfft, do whatever you want lol.","mercenary armour":"<h3><u>Mercenary Armour</u></h3>Top quality armour made to withstand large blows. Used by soldiers, mercenaries, S.W.A.T and now you. You're in the big leagues now son.","swat armour":"<h3><u>S.W.A.T Armour</u></h3>Ok, I now I know I used S.W.A.T. in the description for the mercenary armour but, hear me out...I ran out of soldier names. Look just, point is, this is some decent armour. not the best, but decent. Shut up and wear it.","dx 9":"<h3><u>DX 9</u></h3> High end handgun built to be light and reliable, and features a light trigger which alows for no hesitation. High capacity, quick fire and decent damage. You can't beat it!","x6 91":"<h3><u>X6 91</u></h3> A powerful firearm made for battling multiple foes with heavy armour. Moderate capacity, sky-high damage. Try this one on for size.","noss 7":"<h3><u>NOSS 7</u></h3> This scilenced pistol puts most others to shame by taking speed to the next level. It features an extended magazine allowing for a split-second mag dump of epic proportions. Not very accurate though.","furs 55":"<h3><u>FURS 55</u></h3> Try on this oldschool revolver pulled right out of a Clint Eastwood film. Good capacity and acceptable damage. Take of that what you will.","remote detonator":"<h3><u>Remote Detonator</u></h3> Use <i>\"Equip\"</i> on this object to detonate all currently armed explosives. </br></br>Don't lose this, because you'll only ever need one.","remote explosive":"<h3><u>Remote Explosive</u></h3> A powerful nitroglycerin based explosive, used for building traps and taking out a large number of enemies.</br></br> Use <i>\"Equip\"</i> to arm and place the explosive. You'll need a <i>Remote Detonator</i> to detonate it.</br></br>Careful, you'll want to stand way back.","proximity explosive":'<h3><u>Proximity Explosive</u></h3> A powerful C-4 based explosive rigged to a motion sensor.</br></br> Use <i>"Equip"</i> to arm and place the explosive. Any enemy within close proximity will cause the explosive to detonate, no remote needed. </br></br>The sensor will be active 3 seconds after being armed.',"combat knife":"<h3><u>Combat Knife</u></h3> A common choice of melee used by hunters to mercy-kill deer, and by soldiers to get the job done. Features good durabilty, and good damage.",money:"<h3><u>Money</u></h3> It's money. If you need me to explain any further you probably shouldn't have it. Use <i>\"Equip\"</i> to add the specified amount into your cash balance."},equippedIndex=1/0,selectedIndex=void 0,lastIndex=void 0,switchMode=!1;function equipSlot(e){$AVATAR.equipItem(e)&&($IS_MOBILE&&$AVATAR.state.equippedItems.mainTool&&"gun"===$AVATAR.state.equippedItems.mainTool.type&&$AVATAR.drawWeapon(),equippedIndex<5&&quickAccessItems.item(equippedIndex).classList.remove("controls-container__item--equipped"),inventoryItems.item(equippedIndex).style.borderBottom="none",equippedIndex!==e?(e<5&&quickAccessItems.item(e).classList.add("controls-container__item--equipped"),inventoryItems.item(e).style.borderBottom="3px solid white",equippedIndex=e):($AVATAR.unequipItem(e),equippedIndex=1/0),updateDescription())}var quickAccessItems=document.querySelectorAll(".controls-container__item"),inventoryItems=document.querySelectorAll(".main-inventory__item"),controlButtonsContainer=document.querySelector(".main-inventory__buttons"),itemDescription=document.querySelector(".main-inventory__description-content"),controlSwitchButton;function selectSlot(e){var t,o;($AVATAR.inventory.items[e]||switchMode)&&(controlButtonsContainer.style.opacity=1,inventoryItems.item(selectedIndex).style.backgroundColor="rgba(0,0,0,0.2)",inventoryItems.item(e).style.backgroundColor="rgba(0,0,0,0.4)",switchMode&&($AVATAR.inventory.swapItems(selectedIndex,e),updateInventoryItem(selectedIndex,null===(t=$AVATAR.inventory.items[selectedIndex])||void 0===t?void 0:t.name),updateInventoryItem(e,null===(o=$AVATAR.inventory.items[e])||void 0===o?void 0:o.name),equippedIndex===e?equipSlot(selectedIndex):equippedIndex===selectedIndex&&equipSlot(e),controlSwitchButton.style.opacity=1,switchMode=!1),selectedIndex=e,lastIndex=e,updateDescription())}window.updateDescription=function(e,t){var o=t||$AVATAR.inventory.items[lastIndex],n=null==o?void 0:o.name,i=itemDescriptions[n]||itemDescriptions.default;if(o&&i)if("cash"===o.type)i+="</br></br><strong>Amount _____ ".concat(o.amount,"$</strong>");else if("armour"===o.type){if(o.constructor._properties.integrity,i+="</br></br><strong>Strength _____ ".concat(o.constructor._properties.strength,"</strong>"),e)return i;i=(i=i.concat(o===$AVATAR.state.equippedItems.armour?"<br><br><i>Equipped</i>":"<br><br><i>Not Equipped</i>")).concat("</br><i>Integrity ".concat(Math.round((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.l_)(o.integrity,o.constructor._properties.strength)),"%</i>"))}else if("ammo"===o.type){var r=o.constructor._properties.increase;if(i+="</br></br><strong>Increase _____ capacity x".concat(r,"</strong>"),e)return i;i=i.concat(o.used?"<br><br><i>Empty</i>":"<br><br><i>Full</i>")}else if("medicine"===o.type){var a=o.constructor._properties.regain;if(i+="</br></br><strong>Regain _____ ".concat(a,"</strong>"),e)return i;i=i.concat(o.used?"<br><br><i>Used</i>":"<br><br><i>New</i>")}else if("backpack"===o.type){var s=o.constructor._properties.capacity;if(i+="</br></br><strong>Capacity _____ ".concat(s,"</strong>"),e)return i;i=i.concat(o===$AVATAR.state.equippedItems.mainTool||o===$AVATAR.state.equippedItems.accessory1?"<br><br><i>Equipped</i>":"<br><br><i>Not Equipped</i>")}else if("knife"===o.type){var c=o.constructor._properties,l=c.damage,u=c.durability;if(i+="</br></br><strong>Damage _____ ".concat(l,"</strong></br><strong>Durability _____ ").concat(u,"</strong>"),e)return i;i=(i=i.concat(o===$AVATAR.state.equippedItems.mainTool||o===$AVATAR.state.equippedItems.accessory1?"<br><br><i>Equipped</i>":"</br></br><i>Not Equipped</i>")).concat("</br><i>Integrity ".concat(o.integrity,"%</i>"))}else if("gun"===o.type){var d=o.constructor._properties,p=d.damage,_=d.fireRate,m=d.accuracy,y=d.capacity;if(i+="</br></br><strong>Damage _____ ".concat(p,"</strong></br><strong>Fire Rate _____ ").concat(_,"</strong></br><strong>Accuracy _____ ").concat(m,"</strong></br><strong>Capacity _____ ").concat(y,"</strong>"),e)return i;i=i.concat(o===$AVATAR.state.equippedItems.mainTool||o===$AVATAR.state.equippedItems.accessory1?"<br><br><i>Equipped</i>":"<br><br><i>Not Equipped</i>")}if(e)return i;itemDescription.innerHTML=i},window.setInventoryCapacity=function(e){if(e>$AVATAR.inventory.slots)for(var t=function(e){var t=document.createElement("div");t.setAttribute("id","inv-item-".concat(e)),t.setAttribute("class","main-inventory__item"),t.onclick=function(){selectSlot(e-1)},inventoryItemsContainer.appendChild(t)},o=$AVATAR.inventory.slots+1;o<=e;o++)t(o);else if(e<$AVATAR.inventory.slots)for(var n=e;n<$AVATAR.inventory.slots;n++)inventoryItems.item(n).remove();inventoryItems=document.querySelectorAll(".main-inventory__item"),$AVATAR.inventory.slots=e,selectedIndex>14&&(selectedIndex=0)};for(var _loop2=function(e){quickAccessItems.item(e).ontouchstart=function(t){t.preventDefault(),equipSlot(e)},quickAccessItems.item(e).onclick=function(t){t.preventDefault(),equipSlot(e)}},i=0;i<quickAccessItems.length;i++)_loop2(i);for(var _loop3=function(e){inventoryItems.item(e).onclick=function(){selectSlot(e)}},_i5=0;_i5<inventoryItems.length;_i5++)_loop3(_i5);window.updateInventoryItem=function(e,t,o){o?(controlButtonsContainer.style.opacity=.5,inventoryItems.item(e).style.backgroundImage="none",inventoryItems.item(e).style.borderBottom="none",inventoryItems.item(e).style.backgroundColor="rgba(0,0,0,0.2)",e<5&&(quickAccessItems.item(e).classList.remove("controls-container__item--equipped"),quickAccessItems.item(e).style.backgroundImage="none"),selectedIndex=void 0):t?(e<5&&(quickAccessItems.item(e).style.backgroundImage='url("/public/images/icons/'.concat(t.replaceAll(" ","_"),'_icon.png")')),inventoryItems.item(e).style.backgroundImage='url("/public/images/icons/'.concat(t.replaceAll(" ","_"),'_icon.png")')):(e<5&&(quickAccessItems.item(e).style.backgroundImage="none"),inventoryItems.item(e).style.backgroundImage="none")};var controlEquipButton=document.querySelector(".main-inventory__controls-equip");controlEquipButton.onclick=function(){equipSlot(selectedIndex)};var helpContainer=document.querySelector(".main-inventory__help"),statsContainer=document.querySelector(".main-inventory__stats"),descriptionContainer=document.querySelector(".main-inventory__description"),viewStatsButton=document.querySelector(".main-inventory__view-stats");function showHelp(){descriptionContainer.style.display="none",statsContainer.style.display="none",helpContainer.style.display="block"}function showDescription(){descriptionContainer.style.display="block",helpContainer.style.display="none",statsContainer.style.display="none",viewStatsButton.innerText="View Stats"}function showStats(){descriptionContainer.style.display="none",helpContainer.style.display="none",statsContainer.style.display="block",viewStatsButton.innerText="View Desc"}viewStatsButton.onclick=function(){"block"===statsContainer.style.display?showDescription():showStats()};var controlHelpButton=document.querySelector(".main-inventory__controls-help");controlHelpButton.onclick=function(){"block"===helpContainer.style.display?showDescription():showHelp()};var controlDropButton=document.querySelector(".main-inventory__controls-drop");controlDropButton.onclick=function(){controlSwitchButton.style.opacity=1,switchMode=!1,equippedIndex===selectedIndex&&(equippedIndex=1/0),$AVATAR.dropItem(selectedIndex),lastIndex=void 0,updateDescription()},controlSwitchButton=document.querySelector(".main-inventory__controls-switch"),controlSwitchButton.onclick=function(){if(void 0!==selectedIndex){if(!switchMode)return switchMode=!0,void(controlSwitchButton.style.opacity=.5);controlSwitchButton.style.opacity=1,switchMode=!1}};var switchMap=document.querySelector("#switch-map"),goTo=document.querySelector("#goto");switchMap.onclick=function(){if(!$MAP_DISPLAY.useWorldMap)return $MAP_DISPLAY.useWorldMap=!0,goTo.style.opacity=1,setWaypointButton.style.opacity=.5,switchMap.innerText="Local Map",void updateCoordinates($MAP_DISPLAY.worldMapOffset.x,$MAP_DISPLAY.worldMapOffset.y);$MAP_DISPLAY.useWorldMap=!1,goTo.style.opacity=.5,setWaypointButton.style.opacity=1,switchMap.innerText="World Map",updateCoordinates($MAP_DISPLAY.displayOffset.x,$MAP_DISPLAY.displayOffset.y)};var storeContainer=document.querySelector("#store"),closeStoreButton=document.querySelector("#store-close"),storeItemsContainer=document.querySelector(".store__items"),storeItemTemplate=document.querySelector("#store-item-template"),currentStoreItem=void 0,highlightedItem=void 0;function updateStore(e){var t=storeItemsContainer.querySelectorAll(".store__item");currentStoreItem=e[0],t.forEach((function(e){e.remove()}));var o,n=_createForOfIteratorHelper(e);try{var i=function(){var t=o.value,n=storeItemTemplate.content.cloneNode(!0),i=n.querySelector(".store__item");t===e[0]&&((highlightedItem=i).style.background="#555555"),i.addEventListener("click",(function(){updateCheckout(t),highlightedItem.style.background="rgba(0,0,0,0.2)",(highlightedItem=i).style.background="#555555"})),n.querySelector(".item__icon").setAttribute("src","/public/images/icons/".concat(t.name.replaceAll(" ","_"),"_icon.png")),n.querySelector(".item__name").innerText=t.title,storeItemsContainer.appendChild(n)};for(n.s();!(o=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}updateCheckout(currentStoreItem)}closeStoreButton.onclick=function(){toggleStore()},window.toggleStore=function(e){if("grid"!==storeContainer.style.display)return document.querySelector("#store-cash").innerHTML="$"+Math.round($AVATAR.inventory.cash),document.querySelector("#store-bank").innerHTML="$"+Math.round($AVATAR.inventory.bank),void(storeContainer.style.display="grid");storeContainer.style.display="none"};var itemTitle=document.querySelector(".item__title u"),itemPrice=document.querySelector(".item__price"),itemIcon=document.querySelector(".info-box__icon"),itemTotal=document.querySelector("#item-total"),infoDescription=document.querySelector(".info-box__description p"),itemQuantity=document.querySelector("#item-quantity"),purchaseButton=document.querySelector("#item-purchase");function updateCheckout(storeItem){var name=storeItem.name,title=storeItem.title,price=storeItem.price,type=storeItem.type;itemTitle.innerText=title,itemPrice.innerText="Price: $"+price,itemIcon.src="/public/images/icons/".concat(name.replaceAll(" ","_"),"_icon.png"),itemTotal.innerText="$"+price,infoDescription.innerHTML=updateDescription(!0,{name,type,constructor:"gun"===type?eval(title.replaceAll(" ","_")):eval(title.replaceAll(" ",""))}),itemQuantity.value=1,currentStoreItem=storeItem}purchaseButton.onclick=function(){var total=currentStoreItem.price*itemQuantity.value;if(itemQuantity.value>$AVATAR.inventory.slots-$AVATAR.inventory.count)toggleNote("Sorry, we couldn't make this purchase! You dont have enough space in your inventory to hold these items. Try dropping a few things you dont need.");else if(total>$AVATAR.inventory.cash)toggleNote("You dont have enough money to make this purchase! Try getting a job you bum.");else{for(var _i6=0;_i6<itemQuantity.value;_i6++)$AVATAR.addItem(eval("new ".concat(currentStoreItem.title.replaceAll(" ",""))));$AVATAR.inventory.cash-=total,updateMoneyDisplay(),toggleNote("Purchase successful! ".concat(itemQuantity.value," ").concat(currentStoreItem.name+(itemQuantity.value>1?"s were":" was")," added to your inventory."))}},itemQuantity.addEventListener("change",(function(){itemTotal.innerText="$"+Math.round(itemQuantity.value*currentStoreItem.price)})),updateStore([{name:"glock 20",title:"GLOCK_20",price:50,type:"gun"},{name:"kc 357",title:"KC_357",price:45.5,type:"gun"},{name:"gp k100",title:"GP_K100",price:130.15,type:"gun"},{name:"nxr 44 mag",title:"NXR_44_MAG",price:233.5,type:"gun"},{name:"usp 45",title:"USP_45",price:543.5,type:"gun"},{name:"dx 9",title:"DX_9",price:385,type:"gun"},{name:"noss 7",title:"NOSS_7",price:880.5,type:"gun"},{name:"x6 91",title:"X6_91",price:742.3,type:"gun"},{name:"furs 55",title:"FURS_55",price:190,type:"gun"},{name:"x6 91",title:"X6_91",price:742.3,type:"gun"},{name:"kitchen knife",title:"KitchenKnife",price:30.5,type:"knife"},{name:"combat knife",title:"CombatKnife",price:95,type:"knife"},{name:"assassins knife",title:"AssassinsKnife",price:420.9,type:"knife"},{name:"remote explosive",title:"RemoteExplosive",price:120,type:"explosive"},{name:"proximity explosive",title:"ProximityExplosive",price:185,type:"explosive"},{name:"remote detonator",title:"RemoteDetonator",price:342,type:"detonator"},{name:"basic armour",title:"BasicArmour",price:480.5,type:"armour"},{name:"swat armour",title:"SwatArmour",price:620,type:"armour"},{name:"mercenary armour",title:"MercenaryArmour",price:852.5,type:"armour"},{name:"grey backpack",title:"GreyBackpack",price:240,type:"backpack"},{name:"white backpack",title:"WhiteBackpack",price:380.4,type:"backpack"},{name:"black backpack",title:"BlackBackpack",price:520,type:"backpack"},{name:"syringe",title:"Syringe",price:42,type:"medicine"},{name:"med kit",title:"MedKit",price:120,type:"medicine"}]);var noteContainer=document.querySelector(".note-wrapper"),closeNoteButton=document.querySelector("#note-close"),noteContent=document.querySelector(".note__content p"),noteTitle=document.querySelector(".note__content-title"),noteImage=document.querySelector(".note__image"),noteCallback;if(window.toggleNote=function(e,t,o,n){noteContent.innerText=e,noteContainer.style.display="flex",noteCallback=t,o?(noteTitle.style.display="block",noteTitle.innerText=o):noteTitle.style.display="none",n?(noteImage.style.display="block",noteImage.src=n):noteImage.style.display="none"},closeNoteButton.addEventListener("click",(function(){noteContainer.style.display="none",noteCallback&&noteCallback()})),!$IS_MOBILE){var desktopMovementFactor=1,movementX=0,movementY=0,wKeyDown=!1,aKeyDown=!1,sKeyDown=!1,dKeyDown=!1,position={x:$JOYSTICK_L.position.x,y:$JOYSTICK_L.position.y};$JOYSTICK_L.desktopMovementCallback=function(){if(!$ACTIVE_DIALOGUE_PARTY){wKeyDown&&position.y&&(position.y+=desktopMovementFactor),aKeyDown&&(position.x-=desktopMovementFactor),sKeyDown&&(position.y-=desktopMovementFactor),dKeyDown&&(position.x+=desktopMovementFactor);var e=$JOYSTICK_L.base,t=(e.width,e.height,e.x),o=e.y,n=e.radius,i=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_1__.Io)(t,o,position.x,position.y),r=n/i;$JOYSTICK_L.base.anchored&&i>n&&(position.x=(1-r)*t+r*position.x,position.y=(1-r)*o+r*position.y),(i<n||$JOYSTICK_L.base.anchored||$JOYSTICK_L.fixed)&&$JOYSTICK_L.translate(position.x,position.y)}};var controlKeys=["w","a","s","d"],mouseDown=!1;window.addEventListener("keydown",(function(e){"grid"!==consoleContainer.style.display&&("KeyR"===e.code&&$AVATAR.state.equippedItems.mainTool&&$AVATAR.reload(),"KeyQ"===e.code&&toggleGrab(e),"KeyP"===e.code&&($PAUSED=!$PAUSED),$AVATAR.state.equippedItems.mainTool&&"KeyX"===e.code&&$AVATAR.dropItem($AVATAR.state.equippedItems.mainTool.slot),/\d/.test(e.key.toLowerCase())&&equipSlot(Number(e.key)?Number(e.key-1):9),controlKeys.includes(e.key.toLowerCase())&&(eval("".concat(e.key.toLowerCase(),"KeyDown = ",!0)),$JOYSTICK_L.desktopMovementAnimation.active=!0))})),window.addEventListener("keyup",(function(e){controlKeys.includes(e.key.toLowerCase())&&(eval("".concat(e.key.toLowerCase(),"KeyDown = ",!1)),wKeyDown||aKeyDown||sKeyDown||dKeyDown||($AVATAR.state.walking=!1,$JOYSTICK_L.desktopMovementAnimation.active=!1,$JOYSTICK_L.unanchor(),$JOYSTICK_L.fix(),position={x:$JOYSTICK_L.position.x,y:$JOYSTICK_L.position.y}))})),canvas.addEventListener("mousemove",(function(e){($AVATAR.state.equippedItems.mainTool||$AVATAR.state.punching||$AVATAR.state.sitting||mouseDown)&&($AVATAR.trans.rotation=Math.atan2(e.pageX-window.innerWidth/2,e.pageY-window.innerHeight/2)+3.14159)})),canvas.addEventListener("mousedown",(function(){mouseDown=!0,$AVATAR.state.pickup.current?($AVATAR.state.fire=!1,$AVATAR.state.punching=!1,$AVATAR.state.stabbing=!1):$AVATAR.state.armed?$AVATAR.state.fire=!0:$AVATAR.state.melee?$AVATAR.state.stabbing=!0:$AVATAR.state.punching=!0})),canvas.addEventListener("mouseup",(function(){mouseDown=!1,$AVATAR.state.fire=!1,$AVATAR.state.punching=!1,$AVATAR.state.stabbing=!1}))}window.updateCoordsDisplay=function(){document.querySelector("#coords").innerText="x:".concat(Math.round($CURRENT_MAP.centerX),", y:").concat(Math.round($CURRENT_MAP.centerY))};var settings=document.querySelector("#settings"),openSettingsButton=document.querySelectorAll(".controls-container__button").item(3),closeSettingsButton=document.querySelector("#settings-close");function openSettings(){settings.style.display="grid"}function closeSettings(){settings.style.display="none"}openSettingsButton.onclick=openSettings,closeSettingsButton.onclick=closeSettings;var onscreenMapStyleSetting=document.querySelector("#onscreen-map-style-setting"),zoomSetting=document.querySelector("#zoom-setting"),graphicsQualitySetting=document.querySelector("#graphics-quality-setting"),musicSetting=document.querySelector("#music-setting"),volumeSetting=document.querySelector("#volume-setting"),joysticksSetting=document.querySelector("#joysticks-setting"),fullscreenSetting=document.querySelector("#fullscreen-setting"),pauseSetting=document.querySelector("#pause-setting");function saveSettings(){localStorage.setItem("game-settings",JSON.stringify($SETTINGS))}function updateOnscreenMapStyle(){document.querySelector("#mapInfo").style.background=["none","red","#00ff15","#00fffb","#ff8800"][$SETTINGS.onscreenMapStyle]}function updateZoom(){scale=zoomSetting.value}function applySettings(){updateOnscreenMapStyle()}fullscreenSetting.onchange=function(){fullscreenSetting.checked?document.body.requestFullscreen():document.exitFullscreen()},pauseSetting.onchange=function(){$PAUSED=pauseSetting.checked},onscreenMapStyleSetting.selectedIndex=$SETTINGS.onscreenMapStyle,zoomSetting.value=$SETTINGS.zoom,graphicsQualitySetting.selectedIndex=$SETTINGS.graphicsQuality,musicSetting.selectedIndex=$SETTINGS.music,volumeSetting.value=10*$SETTINGS.volume,joysticksSetting.selectedIndex=$SETTINGS.joysticks,onscreenMapStyleSetting.onchange=function(){$SETTINGS.onscreenMapStyle=onscreenMapStyleSetting.selectedIndex,updateOnscreenMapStyle(),saveSettings()},musicSetting.onchange=function(){$SETTINGS.music=musicSetting.selectedIndex,$SETTINGS.music?currentTrack.pause():playNextTrack(),saveSettings()},zoomSetting.onchange=function(){$SETTINGS.zoom=zoomSetting.value,updateZoom(),saveSettings()},volumeSetting.onchange=function(){$SETTINGS.volume=volumeSetting.value/10,currentTrack.volume=$SETTINGS.volume,saveSettings()},graphicsQualitySetting.onchange=function(){$SETTINGS.graphicsQuality=graphicsQualitySetting.selectedIndex,saveSettings()},joysticksSetting.onchange=function(){$SETTINGS.joysticks=joysticksSetting.selectedIndex,saveSettings()},applySettings(),window.updateCombatStats=function(){document.querySelector(".onscreen-stats__kills").innerText=$AVATAR.state.kills,document.querySelector(".onscreen-stats__score").innerText=$SCORE};var titleCard=document.querySelector(".title-card-wrapper"),titlePlayButton=document.querySelector(".play__button"),usernameInput=document.querySelector(".play__username");usernameInput.value=$PLAYER_NAME||"";var onScreenPlayerName=document.querySelector(".onscreen-stats__player"),scoreDisplay=document.querySelector(".content__score"),highscoreDisplay=document.querySelector(".content__highscore");highscoreDisplay.innerText="Your current highscore: ".concat($HIGHSCORE),titlePlayButton.onclick=function(){$CONTENT_LOADED&&!$TRANSITIONING&&(titleCard.style.display="none",onScreenPlayerName.innerText=usernameInput.value||"Unnamed Human",localStorage.setItem("player-name",usernameInput.value),$SPECTATING=!1,$AVATAR.nameObj.update(usernameInput.value),$AVATAR.character=usernameInput.value,$AVATAR.respawn())};var titleSettingsButton=document.querySelector(".buttons__settings");titleSettingsButton.onclick=openSettings;var titleHelpButton=document.querySelector(".buttons__help");titleHelpButton.onclick=function(){toggleNote("Use 'E' on desktop or the 'A' button to interact with an object. The 'A' button at the right of the screen will light up with an interaction is avaliable when you're close enough to an object. This works when for things like entering doors or adding items to your inventory.",(function(){toggleNote("Use 'Q' on desktop or the 'G' button to pick up an item to carry it. Use the key a second time to drop the item.",(function(){toggleNote("Kill as many enemies as you can to gain the highest score possible. Use the gun store at the top of the map to buy and access more weapons.\n\nGo into settings to see more information on controls.",!1,"Objective.","/public/images/combat.png")}),"Grabbing","/public/images/grabbing.png")}),"Interaction","/public/images/interaction.png")},window.returnToTitleScreen=function(){titleCard.style.display="flex",onScreenPlayerName.innerText="- - - - -",$SPECTATING=!0,noclip=!0,$SCORE>$HIGHSCORE&&($HIGHSCORE=$SCORE,localStorage.setItem("highscore",$HIGHSCORE)),scoreDisplay.innerText="Your score: ".concat($SCORE),scoreDisplay.style.display="block",highscoreDisplay.innerText="Your current highscore: ".concat($HIGHSCORE),$SCORE=0,$AVATAR.state.kills=0,$AVATAR.state.totalDamage=0,updateCombatStats()},window.togglePressEDisplay=function(e){document.querySelector("#press-e").style.display=e?"block":"none"},__webpack_async_result__()}catch(e){__webpack_async_result__(e)}}),1)},146:(e,t,o)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function r(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,"string");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}o.d(t,{A:()=>c});var a={defaultOptions:[]},s=function(){return e=function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.content=t,this.dest=r,this.con=o,this.rep=n,this.rel=i,this.action=s,this.enabled=!c,this.label=a},(t=[{key:"getContent",value:function(e){return this.content instanceof Function?this.content(e):this.content}},{key:"getDestination",value:function(e){return this.dest instanceof Function?this.dest(e):this.dest}}])&&i(e.prototype,t),o&&i(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o}();a.defaultOptions.push(new s("...",0,0,0,!1,"[exit]",(function(){endDialogue()})));const c=a}}]);