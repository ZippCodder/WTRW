"use strict";(self.webpackChunkWTRW=self.webpackChunkWTRW||[]).push([[20],{690:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AmmoBox:()=>AmmoBox,AssassinsKnife:()=>AssassinsKnife,Atm:()=>Atm,Avatar:()=>Avatar,Barrier:()=>Barrier,BasicArmour:()=>BasicArmour,Bench:()=>Bench,BlackBackpack:()=>BlackBackpack,BlackBook:()=>BlackBook,Bot:()=>Bot,Bullet:()=>Bullet,BulletShell:()=>BulletShell,Bush:()=>Bush,Chair:()=>Chair,CombatKnife:()=>CombatKnife,ConvenienceStore:()=>ConvenienceStore,DX_9:()=>DX_9,Door:()=>Door,DownwardLight:()=>DownwardLight,FURS_55:()=>FURS_55,Floor:()=>Floor,GLOCK_20:()=>GLOCK_20,GP_K100:()=>GP_K100,Gazebo:()=>Gazebo,Grass:()=>Grass,Grass2:()=>Grass2,GreyBackpack:()=>GreyBackpack,GunStore:()=>GunStore,House1:()=>House1,House2:()=>House2,KC_357:()=>KC_357,KitchenKnife:()=>KitchenKnife,Laptop:()=>Laptop,LightBush:()=>LightBush,LightSwitch:()=>LightSwitch,MedKit:()=>MedKit,MercenaryArmour:()=>MercenaryArmour,MetalFence:()=>MetalFence,MetalFenceVertical:()=>MetalFenceVertical,MixedBush:()=>MixedBush,Money:()=>Money,MultiAmmoBox:()=>MultiAmmoBox,NOSS_7:()=>NOSS_7,NXR_44_MAG:()=>NXR_44_MAG,PickupRing:()=>PickupRing,PicnicTable:()=>PicnicTable,Pinboard:()=>Pinboard,Plus100:()=>Plus100,ProximityExplosive:()=>ProximityExplosive,RemoteDetonator:()=>RemoteDetonator,RemoteExplosive:()=>RemoteExplosive,Road:()=>Road,RoadCorner:()=>RoadCorner,RoadDouble:()=>RoadDouble,RoadQuadCorner:()=>RoadQuadCorner,RoadRail:()=>RoadRail,RoadRailVertical:()=>RoadRailVertical,RoadSign:()=>RoadSign,RoadTriCorner:()=>RoadTriCorner,Rocks1:()=>Rocks1,Rocks2:()=>Rocks2,Sensor:()=>Sensor,Shed:()=>Shed,SmallPlant:()=>SmallPlant,SmallTable:()=>SmallTable,SteakAndFries:()=>SteakAndFries,Stopper:()=>Stopper,StreetLight:()=>StreetLight,SwatArmour:()=>SwatArmour,Syringe:()=>Syringe,Table:()=>Table,Text:()=>Text,Tile:()=>Tile,Trigger:()=>Trigger,USP_45:()=>USP_45,UrbanFence:()=>UrbanFence,UrbanFenceHalf:()=>UrbanFenceHalf,UrbanFenceVertical:()=>UrbanFenceVertical,Vendor1:()=>Vendor1,VisibleBarrier:()=>VisibleBarrier,WhiteBackpack:()=>WhiteBackpack,WhiteBook:()=>WhiteBook,Whiteboard:()=>Whiteboard,X6_91:()=>X6_91,_Ammo_:()=>_Ammo_,_Blade_:()=>_Blade_,_Building_:()=>_Building_,_BulletClusterClient_:()=>_BulletClusterClient_,_BulletCluster_:()=>_BulletCluster_,_Button_:()=>_Button_,_Gun_:()=>_Gun_,_InstancedClusterClient_:()=>_InstancedClusterClient_,_InstancedCluster_:()=>_InstancedCluster_,_Joystick_:()=>_Joystick_,_LineMatrix_:()=>_LineMatrix_,_Map_:()=>_Map_,_Medicine_:()=>_Medicine_,_MixedStaticClusterClient_:()=>_MixedStaticClusterClient_,_MixedStaticCluster_:()=>_MixedStaticCluster_,_Object_:()=>_Object_,_Pickup_:()=>_Pickup_,_StaticClusterClient_:()=>_StaticClusterClient_,_StaticCluster_:()=>_StaticCluster_});var _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(277);function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,e);var i=new(t.bind.apply(t,s));return r&&_setPrototypeOf(i,r.prototype),i}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var s,i,a,n,o=[],l=!0,h=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(s=a.call(r)).done)&&(o.push(s.value),o.length!==e);l=!0);}catch(t){h=!0,i=t}finally{try{if(!l&&null!=r.return&&(n=r.return(),Object(n)!==n))return}finally{if(h)throw i}}return o}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var s=0,i=function(){};return{s:i,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n=!0,o=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return n=t.done,t},e:function(t){o=!0,a=t},f:function(){try{n||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,s=Array(e);r<e;r++)s[r]=t[r];return s}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,_toPropertyKey(s.key),s)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var s=r.call(t,e||"default");if("object"!=_typeof(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var pathfinder=new Worker("/src/scripts/pathfinder.js");pathfinder.registerMap=function(t){pathfinder.postMessage({requestType:1,mapId:t.id,nodes:t.GRAPH.nodes})},pathfinder.requestPath=function(t,e,r){this.postMessage({mapId:t.map.id,blocked:t.map.GRAPH.blocked,requestType:0,avatarId:t.id,path:{start:e,end:r}})},pathfinder.onmessage=function(t){var e,r=t.data;null===(e=_Map_._all[r.mapId].avatars[r.avatarId])||void 0===e||e.findPathTo(r.result)};var _Object_=function(){return _createClass((function t(e,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,n=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,h=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0;_classCallCheck(this,t),_defineProperty(this,"texture",void 0),_defineProperty(this,"buffer",void 0),_defineProperty(this,"segments",void 0),_defineProperty(this,"obstacle",void 0),_defineProperty(this,"pickup",void 0),_defineProperty(this,"interactable",void 0),s=s.bind(this),this.vao=ext.createVertexArrayOES(),this.vertices=new Float32Array(e),this.imp=r.bind(this),this.render=function(){this.preRender&&this.preRender(),s()},this.trans={offsetX:n||0,offsetY:o||0,rotation:l*Math.PI/180||0},this.width=i,this.height=a,this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.type=h,this.scale=1,this.topLayer=!1,this.name=c,this.textures=[],ext.bindVertexArrayOES(this.vao),this.imp()}),[{key:"delete",value:function(){this.map.unlink(this.id)}},{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e}},{key:"rotate",value:function(t){t=t*Math.PI/180,this.trans.rotation=t}}])}(),_StaticCluster_=function(){return _createClass((function t(e,r){_classCallCheck(this,t),this.vao=ext.createVertexArrayOES(),this.linked=!1,this.isCluster=!0,this.vertices=[],this.verticesCount=0,this.texture=e,this.members=0,this.trans={offsetX:0,offsetY:0,rotation:0},this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.type="static cluster",this.topLayer=r||!1,ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.DYNAMIC_DRAW),gl.disableVertexAttribArray(locations.offset),gl.disableVertexAttribArray(locations.textrUnit)}),[{key:"delete",value:function(){this.map.unlink(this.id)}},{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e}},{key:"translateVertices",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.vertices[t]=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.h2)(e,r,s,-i),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices.flat(1)),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords)}},{key:"link",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5;this.vertices.push((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.h2)(t,e,r,-s,i));var a=this.vertices.flat(1);return this.verticeCount=a.length,ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(a),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),this.vertices.length-1}},{key:"unlink",value:function(t){delete this.vertices[t];var e=this.vertices.flat(1);this.verticeCount=e.length,ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(e),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords)}},{key:"render",value:function(){gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,this.verticeCount/5)}}])}(),_BulletCluster_=function(){return _createClass((function t(e,r){_classCallCheck(this,t),this.vao=ext.createVertexArrayOES(),this.linked=!1,this.topLayer=!0,this.isCluster=!0,this.animation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){for(var t=0;t<this.bullets.length;t++)if(this.bullets[t]){var e=this.bullets[t],r=3*t;this.offsets[r]+=e.rate.x,this.offsets[r+1]+=e.rate.y,e.translate(e.rate.x,e.rate.y);t:for(var s in this.map.obstacles){var i,a=_createForOfIteratorHelper(this.map.obstacles[s].segments);try{for(a.s();!(i=a.n()).done;){var n=_slicedToArray(i.value,4),o=n[0],l=n[1],h=n[2],c=n[3];if(o+=this.map.obstacles[s].trans.offsetX,o+=h/2,l+=this.map.obstacles[s].trans.offsetY,l+=c/2,Math.abs(o-e.trans.offsetX)<e.width/2+h/2&&Math.abs(l-e.trans.offsetY)<e.height/2+c/2){e.delete(),this.map.obstacles[s].hit&&this.map.obstacles[s].hit(e.damage,e.owner,e);break t}}}catch(t){a.e(t)}finally{a.f()}}}}),this,bulletResolution),this.vertices=e,this.bullets=[],this.offsets=[],this.texture=r,this.verticeCount=e.length/5,this.members=0,this.instances=0,this.trans={offsetX:0,offsetY:0,rotation:0},this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.type="bullet cluster",ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),this.offsetBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.offsetBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.offsets),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.offset,3,gl.FLOAT,!1,12,0),instExt.vertexAttribDivisorANGLE(locations.offset,1),gl.enableVertexAttribArray(locations.offset),gl.disableVertexAttribArray(locations.textrUnit)}),[{key:"delete",value:function(){this.map.unlink(this.id)}},{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e}},{key:"translateVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=3*t;this.offsets[i]+=e,this.offsets[i+1]+=r,this.offsets[i+2]=s,ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.offsetBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.offsets),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.offset,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.offset)}},{key:"link",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0,i=3*this.members;return this.members,this.offsets[i]=t,this.offsets[i+1]=e,this.offsets[i+2]=r,this.bullets[this.members]=s,ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.offsetBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.offsets),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.offset,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.offset),this.instances++,this.members++}},{key:"unlink",value:function(t){var e=3*t;delete this.offsets[e],delete this.offsets[e+1],delete this.offsets[e+2],delete this.bullets[t],ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.offsetBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.offsets),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.offset,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.offset)}},{key:"preRender",value:function(){this.animation.run()}},{key:"render",value:function(){ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.offsetBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.offsets),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.offset,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.offset),gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),instExt.drawArraysInstancedANGLE(gl.TRIANGLES,0,this.verticeCount,this.instances)}}])}(),_InstancedCluster_=function(){return _createClass((function t(e,r,s){_classCallCheck(this,t),this.vao=ext.createVertexArrayOES(),this.linked=!1,this.isCluster=!0,this.vertices=e,this.offsets=[],this.useLight=s,this.texture=r,this.verticeCount=e.length/5,this.members=0,this.instances=0,this.trans={offsetX:0,offsetY:0,rotation:0},this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.type="instanced cluster",this.topLayer=s,ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),this.offsetBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.offsetBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.offsets),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.offset,3,gl.FLOAT,!1,12,0),instExt.vertexAttribDivisorANGLE(locations.offset,1),gl.enableVertexAttribArray(locations.offset),gl.disableVertexAttribArray(locations.textrUnit)}),[{key:"delete",value:function(){this.map.unlink(this.id)}},{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e}},{key:"updateBuffer",value:function(){ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.offsetBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.offsets),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.offset,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.offset)}},{key:"translateVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=3*t;this.offsets[i]+=e,this.offsets[i+1]+=r,this.offsets[i+2]=-s*(Math.PI/180),this.updateBuffer()}},{key:"link",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=3*this.members;return this.offsets[s]=t,this.offsets[s+1]=e,this.offsets[s+2]=-r*(Math.PI/180),this.updateBuffer(),this.instances++,this.members++}},{key:"unlink",value:function(t){var e=3*t;delete this.offsets[e],delete this.offsets[e+1],delete this.offsets[e+2],this.updateBuffer()}},{key:"render",value:function(){gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),this.useLight&&(gl.uniform1f(locations.darkness,1),gl.blendFuncSeparate(gl.DST_COLOR,gl.DST_ALPHA,gl.ONE,gl.ONE)),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),instExt.drawArraysInstancedANGLE(gl.TRIANGLES,0,this.verticeCount,this.instances),this.useLight&&(gl.uniform1f(locations.darkness,this.map.darkness+globalDarkness),gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA))}}])}(),_MixedStaticCluster_=function(){function _MixedStaticCluster_(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=arguments.length>2?arguments[2]:void 0;_classCallCheck(this,_MixedStaticCluster_),this.vao=ext.createVertexArrayOES(),this.linked=!1,this.isCluster=!0,this.stride=e,this.sources=[],this.vertices=[],this.textures=t,this.verticesCount=0,this.members=0,this.trans={offsetX:0,offsetY:0,rotation:0},this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.type="mixed static cluster",this.topLayer=r,ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.DYNAMIC_DRAW)}return _createClass(_MixedStaticCluster_,[{key:"delete",value:function(){this.map.unlink(this.id)}},{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e}},{key:"translateVertices",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.vertices[t]=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.h2)(e,r,s,-i,this.stride),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices.flat(1)),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(locations.textrUnit,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.enableVertexAttribArray(locations.textrUnit)}},{key:"link",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.vertices.push((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.h2)(t,e,r,s,this.stride));var i=this.vertices.flat(1);return this.verticeCount=i.length,ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(i),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(locations.textrUnit,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.enableVertexAttribArray(locations.textrUnit),this.members++,this.vertices.length-1}},{key:"unlink",value:function(t){delete this.vertices[t];var e=this.vertices.flat(1);this.verticeCount=e.length,ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(e),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(locations.textrUnit,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.enableVertexAttribArray(locations.textrUnit)}},{key:"render",value:function render(){gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer);for(var i=0;i<this.textures.length;i++)eval("gl.activeTexture(gl.TEXTURE".concat(i,")")),gl.bindTexture(gl.TEXTURE_2D,this.textures[i]);gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,this.verticeCount/this.stride)}}])}();_defineProperty(_MixedStaticCluster_,"groupings",{0:[textures.objects.roads],1:[textures.objects.fences]});var _LineMatrix_=function(){return _createClass((function t(){_classCallCheck(this,t),this.vao=ext.createVertexArrayOES(),this.isCluster=!0,this.vertices=[],this.shotQueue=[],this.animation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){this.removeShot(this.shotQueue.shift())}),this,.1),this.trans={offsetX:0,offsetY:0,rotation:0},this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.type="line matrix",this.topLayer=!0,ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.coords),gl.disableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.textrUnit)}),[{key:"delete",value:function(){this.map.unlink(this.id)}},{key:"showShot",value:function(t,e){var r=_slicedToArray(t,2),s=r[0],i=r[1],a=_slicedToArray(e,2),n=a[0],o=a[1],l=this.vertices.length;return this.vertices.push(s,i,0,n,o,0),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.coords),gl.disableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.textrUnit),l}},{key:"removeShot",value:function(t){this.vertices.splice(t,6,void 0,void 0,void 0,void 0,void 0,void 0),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.DYNAMIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.coords),gl.disableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.textrUnit)}},{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e}},{key:"render",value:function(){gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),gl.uniform4fv(locations.color,[0,0,0,1]),gl.uniform1i(locations.lines,1),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.useProgram(program),gl.drawArrays(gl.LINES,0,this.vertices.length/3),gl.uniform1i(locations.lines,0),gl.uniform4fv(locations.color,[0,0,0,0])}}])}(),_MixedStaticClusterClient_=function(){return _createClass((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,t),_defineProperty(this,"hasCluster",!0),_defineProperty(this,"clusterType",_MixedStaticCluster_),_defineProperty(this,"id",(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)()),this.trans={offsetX:e,offsetY:r,rotation:s}}),[{key:"translate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;this.trans.offsetX+=t,this.trans.offsetY+=e,r&&(this.trans.rotation=r),s&&this.cluster.translateVertices(this.clusterIndex,this.constructor._defaultVertices,-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}},{key:"moveToTop",value:function(){this.cluster.unlink(this.clusterIndex),this.clusterIndex=this.cluster.link(this.constructor._defaultVertices,-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}},{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),_StaticClusterClient_=function(){return _createClass((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,t),_defineProperty(this,"hasCluster",!0),_defineProperty(this,"clusterType",_StaticCluster_),_defineProperty(this,"id",(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)()),this.trans={offsetX:e,offsetY:r,rotation:s}}),[{key:"translate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;this.trans.offsetX+=t,this.trans.offsetY+=e,r&&(this.trans.rotation=r),s&&this.cluster.translateVertices(this.clusterIndex,this.constructor._defaultVertices,-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}},{key:"moveToTop",value:function(){this.cluster.unlink(this.clusterIndex),this.clusterIndex=this.cluster.link(this.constructor._defaultVertices,-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}},{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),_InstancedClusterClient_=function(){return _createClass((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,t),_defineProperty(this,"hasCluster",!0),_defineProperty(this,"clusterType",_InstancedCluster_),_defineProperty(this,"id",(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)()),this.trans={offsetX:e,offsetY:r,rotation:s}}),[{key:"translate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;this.trans.offsetX+=t,this.trans.offsetY+=e,r&&(this.trans.rotation=r),s&&this.cluster.translateVertices(this.clusterIndex,t,e,this.trans.rotation)}},{key:"moveToTop",value:function(){this.cluster.unlink(this.clusterIndex),this.clusterIndex=this.cluster.link(-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}},{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),_BulletClusterClient_=function(){return _createClass((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;_classCallCheck(this,t),_defineProperty(this,"hasCluster",!0),_defineProperty(this,"name","bullet"),_defineProperty(this,"id",(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)()),_defineProperty(this,"exclude",!0),this.trans={offsetX:e,offsetY:r,rotation:s*Math.PI/180},this.rate={x:i,y:a},this.damage=n,this.owner=o}),[{key:"postLink",value:function(){this.cluster=this.map._bulletMatrix,this.clusterIndex=this.cluster.link(-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation,this)}},{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e}},{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),DownwardLight=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),(a=_callSuper(this,e,[[],function(){this.vertices=[-24,24,1,0,0,24,24,1,.9375,0,-24,-24,1,0,.9375,24,24,1,.9375,0,-24,-24,1,0,.9375,24,-24,1,.9375,.9375],this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.offset),gl.disableVertexAttribArray(locations.textrUnit),gl.useProgram(program)},function(){ext.bindVertexArrayOES(this.vao),gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),gl.uniform1f(locations.darkness,1),gl.uniform2fv(locations.size,[this.scale,this.scale]),gl.uniform4fv(locations.lightColor,this._color),gl.blendFuncSeparate(gl.DST_COLOR,gl.DST_ALPHA,gl.ONE,gl.ONE),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,this.vertices.length/5),gl.uniform1f(locations.darkness,this.map.darkness),gl.uniform2fv(locations.size,[1,1]),gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),gl.uniform4fv(locations.lightColor,[0,0,0,0])},48,48,t,r,s])).texture=textures.objects.downwardlight,a.name="downward light",a.topLayer=!0,a.color=i||[0,0,0,0],a}return _inherits(e,t),_createClass(e,[{key:"color",set:function(t){this._color=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Wg)(t)}}])}(_Object_),Bullet=function(t){function e(t,r,s,i,a,n,o){var l;return _classCallCheck(this,e),_defineProperty(l=_callSuper(this,e,[t,r,s,i,a,n,o]),"width",1.8),_defineProperty(l,"height",.8),l}return _inherits(e,t),_createClass(e)}(_BulletClusterClient_),Grass=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",2),_defineProperty(i,"height",2),_defineProperty(i,"name","grass"),_defineProperty(i,"clusterName","grass"),_defineProperty(i,"texture",textures.objects.grass1),_defineProperty(i,"preserveCluster",!0),_defineProperty(i,"bottomLayer",!0),i}return _inherits(e,t),_createClass(e,[{key:"postLink",value:function(){this.delete()}}])}(_InstancedClusterClient_);_defineProperty(Grass,"_defaultVertices",[-1.5,1.5,1,0,0,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,-1.5,1,.9375,.9375]);var BulletShell=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"width",1.8),_defineProperty(a,"height",1),_defineProperty(a,"name","bullet shell"),_defineProperty(a,"clusterName","bullet shell"),_defineProperty(a,"texture",textures.objects.bulletshell),_defineProperty(a,"exclude",!0),_defineProperty(a,"bottomLayer",!0),_defineProperty(a,"preserveCluster",!0),a.directionX=s,a.directionY=i,a.animation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){this.translate(s/=2,i/=2,this.trans.rotation-2*this.trans.rotation,!0)}),a,.01),a.timeout=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.delete()}],a,[.2]),a}return _inherits(e,t),_createClass(e,[{key:"preRender",value:function(){this.animation.run(),this.timeout.start(),this.timeout.run()}}])}(_InstancedClusterClient_);_defineProperty(BulletShell,"_defaultVertices",[-.9,.5,1,0,0,.9,.5,1,.5625,0,-.9,-.5,1,0,.625,.9,.5,1,.5625,0,-.9,-.5,1,0,.625,.9,-.5,1,.5625,.625]);var Plus100=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",8.3),_defineProperty(i,"height",2.2),_defineProperty(i,"name","plus 100"),_defineProperty(i,"clusterName","plus 100"),_defineProperty(i,"texture",textures.misc.plus100),i.animation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){this.translate(0,.2,0,!0),this.trans.offsetY>r+10&&this.delete()}),i,.01),i}return _inherits(e,t),_createClass(e,[{key:"preRender",value:function(){this.animation.run()}}])}(_InstancedClusterClient_);_defineProperty(Plus100,"_defaultVertices",[-4.15,1.1,1,0,0,4.15,1.1,1,.6484375,0,-4.15,-1.1,1,0,.6875,4.15,1.1,1,.6484375,0,-4.15,-1.1,1,0,.6875,4.15,-1.1,1,.6484375,.6875]);var Grass2=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",2),_defineProperty(i,"height",2),_defineProperty(i,"name","grass2"),_defineProperty(i,"clusterName","grass2"),_defineProperty(i,"texture",textures.objects.grass2),_defineProperty(i,"preserveCluster",!0),_defineProperty(i,"bottomLayer",!0),i}return _inherits(e,t),_createClass(e,[{key:"postLink",value:function(){this.delete()}}])}(_InstancedClusterClient_);_defineProperty(Grass2,"_defaultVertices",[-1.5,1.5,1,0,0,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,-1.5,1,.9375,.9375]);var Rocks1=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s||(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"width",2),_defineProperty(i,"height",2),_defineProperty(i,"clusterName","three rocks"),_defineProperty(i,"texture",textures.objects.rocks1),_defineProperty(i,"name","three rocks"),_defineProperty(i,"preserveCluster",!0),_defineProperty(i,"bottomLayer",!0),i}return _inherits(e,t),_createClass(e,[{key:"postLink",value:function(){this.delete()}}])}(_InstancedClusterClient_);_defineProperty(Rocks1,"_defaultVertices",[-1.5,1.5,1,0,0,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,-1.5,1,.9375,.9375]);var Rocks2=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s||(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"width",2),_defineProperty(i,"height",2),_defineProperty(i,"clusterName","two rocks"),_defineProperty(i,"texture",textures.objects.rocks2),_defineProperty(i,"name","two rocks"),_defineProperty(i,"preserveCluster",!0),_defineProperty(i,"bottomLayer",!0),i}return _inherits(e,t),_createClass(e,[{key:"postLink",value:function(){this.delete()}}])}(_InstancedClusterClient_);_defineProperty(Rocks2,"_defaultVertices",[-1.5,1.5,1,0,0,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,1.5,1,.9375,0,-1.5,-1.5,1,0,.9375,1.5,-1.5,1,.9375,.9375]);var BlackBook=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s||(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"width",6.0200000000000005),_defineProperty(i,"height",8.32),_defineProperty(i,"name","black book"),_defineProperty(i,"clusterName","black book"),_defineProperty(i,"texture",textures.objects.book1),_defineProperty(i,"subLayer",1),_defineProperty(i,"moveable",!0),i}return _inherits(e,t),_createClass(e)}(_InstancedClusterClient_);_defineProperty(BlackBook,"_defaultVertices",[-3.0100000000000002,4.16,1,0,0,3.0100000000000002,4.16,1,.940625,0,-3.0100000000000002,-4.16,1,0,.65,3.0100000000000002,4.16,1,.940625,0,-3.0100000000000002,-4.16,1,0,.65,3.0100000000000002,-4.16,1,.940625,.65]);var WhiteBook=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s||(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"width",6.0200000000000005),_defineProperty(i,"height",8.32),_defineProperty(i,"name","white book"),_defineProperty(i,"clusterName","white book"),_defineProperty(i,"texture",textures.objects.book2),_defineProperty(i,"subLayer",1),_defineProperty(i,"moveable",!0),i}return _inherits(e,t),_createClass(e)}(_InstancedClusterClient_);_defineProperty(WhiteBook,"_defaultVertices",[-3.0100000000000002,4.16,1,0,0,3.0100000000000002,4.16,1,.940625,0,-3.0100000000000002,-4.16,1,0,.65,3.0100000000000002,4.16,1,.940625,0,-3.0100000000000002,-4.16,1,0,.65,3.0100000000000002,-4.16,1,.940625,.65]);var RoadRail=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",26.4),_defineProperty(i,"height",11.4),_defineProperty(i,"clusterName","road rail"),_defineProperty(i,"texture",textures.objects.fences),_defineProperty(i,"name","road rail"),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-13.2,-5.7,3.4,11.4],[9.8,-5.7,3.4,11.4],[-10.2,-4.7,20.4,8.6]]),i}return _inherits(e,t),_createClass(e)}(_InstancedClusterClient_);_defineProperty(RoadRail,"_defaultVertices",[-13.4,5.9,1,0,0,-10,5.9,1,.033203125,0,-13.4,-5.5,1,0,.111328125,-10,5.9,1,.033203125,0,-13.4,-5.5,1,0,.111328125,-10,-5.5,1,.033203125,.111328125,9.6,5.9,1,.224609375,0,12.999999999999998,5.9,1,.2578125,0,9.6,-5.5,1,.224609375,.111328125,12.999999999999998,5.9,1,.2578125,0,9.6,-5.5,1,.224609375,.111328125,12.999999999999998,-5.5,1,.2578125,.111328125,-10.4,4.9,1,.029296875,.009765625,9.999999999999998,4.9,1,.228515625,.009765625,-10.4,-3.7,1,.029296875,.09375,9.999999999999998,4.9,1,.228515625,.009765625,-10.4,-3.7,1,.029296875,.09375,9.999999999999998,-3.7,1,.228515625,.09375]);var RoadRailVertical=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",3.4),_defineProperty(i,"height",25.4),_defineProperty(i,"name","road rail vertical"),_defineProperty(i,"clusterName","road rail vertical"),_defineProperty(i,"texture",textures.objects.roadrailvertical),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-1.7,-12.7,3.4,25.4]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(RoadRailVertical,"_defaultVertices",[-1.7,12.7,1,0,0,1.7,12.7,1,.53125,0,-1.7,-12.7,1,0,.49609375,1.7,12.7,1,.53125,0,-1.7,-12.7,1,0,.49609375,1.7,-12.7,1,.53125,.49609375]);var StreetLight=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",31.6),_defineProperty(a,"height",49),_defineProperty(a,"name","street light"),_defineProperty(a,"clusterName","street light"),_defineProperty(a,"texture",textures.objects.streetlight),_defineProperty(a,"obstacle",!0),_defineProperty(a,"segments",[[-.6,-24.3,1.2,1.2]]),_defineProperty(a,"topLayer",!0),_defineProperty(a,"on",!1),_defineProperty(a,"hideFromMap",!0),a._color=i||void 0,a.lights=[new DownwardLight(a.trans.offsetX-12.7,a.trans.offsetY-18.5,0,a._color),new DownwardLight(a.trans.offsetX+12.7,a.trans.offsetY-18.5,0,a._color)],a}return _inherits(e,t),_createClass(e,[{key:"color",set:function(t){this._color=t;var e,r=_createForOfIteratorHelper(this.lights);try{for(r.s();!(e=r.n()).done;)e.value.color=this._color}catch(t){r.e(t)}finally{r.f()}}},{key:"postLink",value:function(){var t,e=_createForOfIteratorHelper(this.lights);try{for(e.s();!(t=e.n()).done;){var r=t.value;this.on||(r.hidden=!0),r.managedMovement=!0,r.exclude=!0,r.scale=1.7,this.map.link(r)}}catch(t){e.e(t)}finally{e.f()}}},{key:"clean",value:function(){var t,e=_createForOfIteratorHelper(this.lights);try{for(e.s();!(t=e.n()).done;)t.value.delete()}catch(t){e.e(t)}finally{e.f()}}},{key:"toggle",value:function(){var t,e=_createForOfIteratorHelper(this.lights);try{for(e.s();!(t=e.n()).done;)t.value.hidden=this.on}catch(t){e.e(t)}finally{e.f()}this.on=!this.on}},{key:"preRender",value:function(){(this.map.lighting&&!this.on||!this.map.lighting&&this.on)&&this.toggle()}},{key:"translate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;this.trans.offsetX+=t,this.trans.offsetY+=e,r&&(this.trans.rotation=r);var i,a=_createForOfIteratorHelper(this.lights);try{for(a.s();!(i=a.n()).done;)i.value.translate(t,e)}catch(t){a.e(t)}finally{a.f()}s&&this.cluster.translateVertices(this.clusterIndex,this.constructor._defaultVertices,-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}}])}(_StaticClusterClient_);_defineProperty(StreetLight,"_defaultVertices",[-15.8,24.5,1,0,0,15.8,24.5,1,.6171875,0,-15.8,-24.5,1,0,.95703125,15.8,24.5,1,.6171875,0,-15.8,-24.5,1,0,.95703125,15.8,-24.5,1,.6171875,.95703125]);var _Seat_=function(t){function e(t,r,s,i){var a;_classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"type","seat"),_defineProperty(a,"interactable",!0),_defineProperty(a,"minDistance",15),a.seats=[];for(var n=0;n<i.length;n++){var o=_slicedToArray(i[n],4),l=o[0],h=o[1],c=o[2],_=o[3];a.seats[n]={x:l,y:h,r:c,exit:{x:_[0],y:_[1]},occupied:!1,id:n}}return a}return _inherits(e,t),_createClass(e,[{key:"getSeat",value:function(t){var e,r=void 0,s=_createForOfIteratorHelper(this.seats);try{for(s.s();!(e=s.n()).done;){var i=e.value;r&&!((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.trans.offsetX+i.x,this.trans.offsetY+i.y,t.trans.offsetX,t.trans.offsetY)<(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.trans.offsetX+r.x,this.trans.offsetY+r.y,t.trans.offsetX,t.trans.offsetY))||i.occupied||(r=i)}}catch(t){s.e(t)}finally{s.f()}return r}},{key:"action",value:function(){if($AVATAR.state.seat.ref)return!1;var t=this.getSeat($AVATAR);t&&(noclip=!0,$CURRENT_MAP.translate(this.trans.offsetX+t.x,this.trans.offsetY+t.y),$AVATAR.trans.rotation=t.r*Math.PI/180,noclip=!1,$AVATAR.state.seat.id=t.id,$AVATAR.state.seat.ref=this,this.seats[t.id].occupied=!0)}}])}(_StaticClusterClient_),Bench=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s,[[-8,1,180,[-8,-16]],[8,1,180,[8,-16]]]]),"width",27.4),_defineProperty(i,"height",21.4),_defineProperty(i,"name","bench"),_defineProperty(i,"clusterName","bench"),_defineProperty(i,"texture",textures.objects.bench),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-13.7,-7.3,27.4,18]]),i}return _inherits(e,t),_createClass(e)}(_Seat_);_defineProperty(Bench,"_defaultVertices",[-13.7,10.7,1,0,0,13.7,10.7,1,.53515625,0,-13.7,-10.7,1,0,.8359375,13.7,10.7,1,.53515625,0,-13.7,-10.7,1,0,.8359375,13.7,-10.7,1,.53515625,.8359375]);var Tile=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",8.4),_defineProperty(i,"height",8.4),_defineProperty(i,"clusterName","tile"),_defineProperty(i,"texture",textures.objects.tile),_defineProperty(i,"bottomLayer",!0),_defineProperty(i,"name","tile"),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Tile,"_defaultVertices",[-4.2,4.2,1,0,0,4.2,4.2,1,.65625,0,-4.2,-4.2,1,0,.65625,4.2,4.2,1,.65625,0,-4.2,-4.2,1,0,.65625,4.2,-4.2,1,.65625,.65625]);var LightSwitch=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",3.2),_defineProperty(i,"height",4.8),_defineProperty(i,"clusterName","light switch"),_defineProperty(i,"texture",textures.objects.lightswitch),_defineProperty(i,"name","light switch"),_defineProperty(i,"interactable",!0),_defineProperty(i,"minDistance",18),i}return _inherits(e,t),_createClass(e,[{key:"action",value:function(){if(this.map.darkness<=1)return this.map.lighting=!0,this.map.darkness=5,void(this.on=!1);this.map.lighting=!1,this.map.darkness=1}}])}(_StaticClusterClient_);_defineProperty(LightSwitch,"_defaultVertices",[-1.6,2.4,1,0,0,1.6,2.4,1,.5,0,-1.6,-2.4,1,0,.75,1.6,2.4,1,.5,0,-1.6,-2.4,1,0,.75,1.6,-2.4,1,.5,.75]);var Chair=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s,[[0,1,180,[0,-16]]]]),"width",11.4),_defineProperty(i,"height",21.4),_defineProperty(i,"name","chair"),_defineProperty(i,"clusterName","chair"),_defineProperty(i,"texture",textures.objects.chair),_defineProperty(i,"obstacle",!0),_defineProperty(i,"interactable",!0),_defineProperty(i,"minDistance",12),_defineProperty(i,"segments",[[-5.7,-7.5,11.4,18.2]]),i}return _inherits(e,t),_createClass(e)}(_Seat_);_defineProperty(Chair,"_defaultVertices",[-5.7,10.7,1,0,0,5.7,10.7,1,.890625,0,-5.7,-10.7,1,0,.8359375,5.7,10.7,1,.890625,0,-5.7,-10.7,1,0,.8359375,5.7,-10.7,1,.890625,.8359375]);var SmallPlant=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",5.4),_defineProperty(i,"height",16),_defineProperty(i,"texture",textures.objects.smallplant),_defineProperty(i,"name","small plant"),_defineProperty(i,"clusterName","small plant"),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-2.7,-.5,5.4,8.4]]),_defineProperty(i,"topLayer",!0),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(SmallPlant,"_defaultVertices",[-2.7,.5,1,0,.29296875,2.7,.5,1,.421875,.29296875,-2.7,-7.9,1,0,.62109375,2.7,.5,1,.421875,.29296875,-2.7,-7.9,1,0,.62109375,2.7,-7.9,1,.421875,.62109375,-2.7,8.100000000000001,1,0,-.00390625,2.7,8.100000000000001,1,.421875,-.00390625,-2.7,.09999999999999964,1,0,.30859375,2.7,8.100000000000001,1,.421875,-.00390625,-2.7,.09999999999999964,1,0,.30859375,2.7,.09999999999999964,1,.421875,.30859375]);var RoadSign=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",8),_defineProperty(i,"height",30.8),_defineProperty(i,"name","road sign"),_defineProperty(i,"clusterName","road sign"),_defineProperty(i,"texture",textures.objects.fences),_defineProperty(i,"topLayer",!0),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-.8,10,1.6,5.4]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(RoadSign,"_defaultVertices",[-4.2,15.6,1,.2578125,0,3.8,15.6,1,.3359375,0,-4.2,4.799999999999999,1,.2578125,.10546875,3.8,15.6,1,.3359375,0,-4.2,4.799999999999999,1,.2578125,.10546875,3.8,4.799999999999999,1,.3359375,.10546875,-1,5.200000000000001,1,.2890625,.1015625,.5999999999999996,5.200000000000001,1,.3046875,.1015625,-1,-15.2,1,.2890625,.30078125,.5999999999999996,5.200000000000001,1,.3046875,.1015625,-1,-15.2,1,.2890625,.30078125,.5999999999999996,-15.2,1,.3046875,.30078125]);var Laptop=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s||(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"width",8.72),_defineProperty(i,"clusterName","laptop"),_defineProperty(i,"texture",textures.objects.laptop),_defineProperty(i,"height",9.72),_defineProperty(i,"subLayer",1),_defineProperty(i,"moveable",!0),_defineProperty(i,"name","laptop"),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Laptop,"_defaultVertices",[-4.36,4.86,1,0,0,4.36,4.86,1,.68125,0,-4.36,-4.86,1,0,.759375,4.36,4.86,1,.68125,0,-4.36,-4.86,1,0,.759375,4.36,-4.86,1,.68125,.759375]);var SteakAndFries=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s||(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"width",10.4),_defineProperty(i,"clusterName","steak and fries"),_defineProperty(i,"texture",textures.objects.steakandfries),_defineProperty(i,"height",10.4),_defineProperty(i,"subLayer",1),_defineProperty(i,"moveable",!0),_defineProperty(i,"name","stak and fries"),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(SteakAndFries,"_defaultVertices",[-5.2,5.2,1,0,0,5.2,5.2,1,.8125,0,-5.2,-5.2,1,0,.8125,5.2,5.2,1,.8125,0,-5.2,-5.2,1,0,.8125,5.2,-5.2,1,.8125,.8125]);var UrbanFence=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",48.4),_defineProperty(i,"height",28.4),_defineProperty(i,"name","urban fence"),_defineProperty(i,"obstacle",!0),_defineProperty(i,"clusterName","urban fence"),_defineProperty(i,"grouping",1),_defineProperty(i,"texture",textures.objects.fences),_defineProperty(i,"segments",[[-24.2,-14.2,48.4,28.4]]),i}return _inherits(e,t),_createClass(e)}(_MixedStaticClusterClient_);_defineProperty(UrbanFence,"_defaultVertices",[-24.2,14.2,1,0,.30078125,0,24.2,14.2,1,.47265625,.30078125,0,-24.2,-14.2,1,0,.578125,0,24.2,14.2,1,.47265625,.30078125,0,-24.2,-14.2,1,0,.578125,0,24.2,-14.2,1,.47265625,.578125,0]);var UrbanFenceVertical=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",4.4),_defineProperty(i,"height",56.4),_defineProperty(i,"name","urban fence vertical"),_defineProperty(i,"clusterName","urban fence"),_defineProperty(i,"grouping",1),_defineProperty(i,"texture",textures.objects.fences),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-2.2,-28.2,4.4,56.4]]),i}return _inherits(e,t),_createClass(e)}(_MixedStaticClusterClient_);_defineProperty(UrbanFenceVertical,"_defaultVertices",[-2.2,28.2,1,.47265625,.30078125,0,2.2,28.2,1,.515625,.30078125,0,-2.2,-28.2,1,.47265625,.8515625,0,2.2,28.2,1,.515625,.30078125,0,-2.2,-28.2,1,.47265625,.8515625,0,2.2,-28.2,1,.515625,.8515625,0]);var UrbanFenceHalf=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",24.4),_defineProperty(i,"height",28.4),_defineProperty(i,"name","urban fence half"),_defineProperty(i,"clusterName","urban fence"),_defineProperty(i,"grouping",1),_defineProperty(i,"texture",textures.objects.urbanfencehalf),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-12.2,-14.2,24.4,28.4]]),i}return _inherits(e,t),_createClass(e)}(_MixedStaticClusterClient_);_defineProperty(UrbanFenceHalf,"_defaultVertices",[-12.2,14.2,1,.3359375,0,0,12.2,14.2,1,.57421875,0,0,-12.2,-14.2,1,.3359375,.27734375,0,12.2,14.2,1,.57421875,0,0,-12.2,-14.2,1,.3359375,.27734375,0,12.2,-14.2,1,.57421875,.27734375,0]);var PicnicTable=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",28.4),_defineProperty(i,"height",17.4),_defineProperty(i,"name","picnic table"),_defineProperty(i,"obstacle",!0),_defineProperty(i,"clusterName","picnic table"),_defineProperty(i,"texture",textures.objects.picnictable),_defineProperty(i,"segments",[[-14.2,-12.1,8.4,18.4],[-6.2,-11.7,12.4,20.4],[5.8,-12.1,8.4,18.4]]),_defineProperty(i,"interactable",!0),_defineProperty(i,"minDistance",20),i}return _inherits(e,t),_createClass(e,[{key:"action",value:function(){noclip=!0,this.trans.offsetX>$AVATAR.trans.offsetX?($CURRENT_MAP.translate(this.trans.offsetX-11,this.trans.offsetY-2),$AVATAR.trans.rotation=-90*Math.PI/180):($CURRENT_MAP.translate(this.trans.offsetX+11,this.trans.offsetY-2),$AVATAR.trans.rotation=90*Math.PI/180),noclip=!1}}])}(_StaticClusterClient_);_defineProperty(PicnicTable,"_defaultVertices",[-14.2,6.300000000000001,1,0,.09375,-5.799999999999999,6.300000000000001,1,.1640625,.09375,-14.2,-12.1,1,0,.8125,-5.799999999999999,6.300000000000001,1,.1640625,.09375,-14.2,-12.1,1,0,.8125,-5.799999999999999,-12.1,1,.1640625,.8125,-6.199999999999999,8.7,1,.15625,0,6.199999999999999,8.7,1,.3984375,0,-6.199999999999999,-11.7,1,.15625,.796875,6.199999999999999,8.7,1,.3984375,0,-6.199999999999999,-11.7,1,.15625,.796875,6.199999999999999,-11.7,1,.3984375,.796875,5.800000000000001,6.300000000000001,1,.390625,.09375,14.2,6.300000000000001,1,.5546875,.09375,5.800000000000001,-12.1,1,.390625,.8125,14.2,6.300000000000001,1,.5546875,.09375,5.800000000000001,-12.1,1,.390625,.8125,14.2,-12.1,1,.5546875,.8125,-8.2,-11.299999999999999,1,.1171875,.78125,8.2,-11.299999999999999,1,.4375,.78125,-8.2,-15.7,1,.1171875,.953125,8.2,-11.299999999999999,1,.4375,.78125,-8.2,-15.7,1,.1171875,.953125,8.2,-15.7,1,.4375,.953125]);var Road=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",50),_defineProperty(i,"height",28.2),_defineProperty(i,"name","road"),_defineProperty(i,"clusterName","road"),_defineProperty(i,"bottomLayer",!0),_defineProperty(i,"texture",textures.objects.roads),_defineProperty(i,"grouping",0),i}return _inherits(e,t),_createClass(e)}(_MixedStaticClusterClient_);_defineProperty(Road,"_defaultVertices",[-25,14.1,1,0,0,0,25,14.1,1,.48828125,0,0,-25,-14.1,1,0,.275390625,0,25,14.1,1,.48828125,0,0,-25,-14.1,1,0,.275390625,0,25,-14.1,1,.48828125,.275390625,0]);var RoadDouble=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",50),_defineProperty(i,"height",28.2),_defineProperty(i,"name","road double"),_defineProperty(i,"clusterName","road"),_defineProperty(i,"bottomLayer",!0),_defineProperty(i,"texture",textures.objects.roads),_defineProperty(i,"grouping",0),i}return _inherits(e,t),_createClass(e)}(_MixedStaticClusterClient_);_defineProperty(RoadDouble,"_defaultVertices",[-25,14.1,1,0,0,1,25,14.1,1,.9765625,0,1,-25,-14.1,1,0,.55078125,1,25,14.1,1,.9765625,0,1,-25,-14.1,1,0,.55078125,1,25,-14.1,1,.9765625,.55078125,1]);var RoadCorner=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",28.2),_defineProperty(i,"height",28.2),_defineProperty(i,"name","road corner"),_defineProperty(i,"bottomLayer",!0),_defineProperty(i,"clusterName","road"),_defineProperty(i,"texture",textures.objects.roads),_defineProperty(i,"grouping",0),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(RoadCorner,"_defaultVertices",[-14.1,14.1,1,0,.275390625,0,14.1,14.1,1,.275390625,.275390625,0,-14.1,-14.1,1,0,.55078125,0,14.1,14.1,1,.275390625,.275390625,0,-14.1,-14.1,1,0,.55078125,0,14.1,-14.1,1,.275390625,.55078125,0]);var RoadTriCorner=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",28.2),_defineProperty(i,"height",28.2),_defineProperty(i,"name","road tri corner"),_defineProperty(i,"clusterName","road"),_defineProperty(i,"grouping",0),_defineProperty(i,"bottomLayer",!0),_defineProperty(i,"texture",textures.objects.roads),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(RoadTriCorner,"_defaultVertices",[-14.1,14.1,1,.275390625,.275390625,0,14.1,14.1,1,.55078125,.275390625,0,-14.1,-14.1,1,.275390625,.55078125,0,14.1,14.1,1,.55078125,.275390625,0,-14.1,-14.1,1,.275390625,.55078125,0,14.1,-14.1,1,.55078125,.55078125,0]);var RoadQuadCorner=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",28.2),_defineProperty(i,"height",28.2),_defineProperty(i,"clusterName","road"),_defineProperty(i,"texture",textures.objects.roads),_defineProperty(i,"grouping",0),_defineProperty(i,"bottomLayer",!0),_defineProperty(i,"name","road quad corner"),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(RoadQuadCorner,"_defaultVertices",[-14.1,14.1,1,0,0,4,14.1,14.1,1,.55078125,0,4,-14.1,-14.1,1,0,.55078125,4,14.1,14.1,1,.55078125,0,4,-14.1,-14.1,1,0,.55078125,4,14.1,-14.1,1,.55078125,.55078125,4]);var Door=function(t){function e(t){var r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;return _classCallCheck(this,e),_defineProperty(r=_callSuper(this,e,[i,a,n]),"width",14.8),_defineProperty(r,"height",20.6),_defineProperty(r,"clusterName","door"),_defineProperty(r,"texture",textures.objects.door),_defineProperty(r,"name","door"),_defineProperty(r,"obstacle",!0),_defineProperty(r,"segments",[[-7.3,-.2,14.6,9.4]]),_defineProperty(r,"exclude",!0),_defineProperty(r,"interactable",!0),_defineProperty(r,"minDistance",17),t&&(r.label=new Text(t.substring(0,10),50,!1,r.trans.offsetX,r.trans.offsetY+3)),r.text=t||!1,r.roomIndex=s,r.room=s,r.buildingExit=l,r.outPoint=o,r}return _inherits(e,t),_createClass(e,[{key:"postLink",value:function(){this.label&&(this.label.exclude=!0,this.label.managedMovement=!0,this.map.link(this.label))}},{key:"action",value:function(){"number"==typeof this.room&&(this.room=this.room<0?this.map.PARENT_MAP:this.map.SUB_MAPS[this.room]),this.room&&requestTransition(function(){if(delete $CURRENT_MAP.avatars[$AVATAR.id],delete $CURRENT_MAP.obstacles[$AVATAR.id],$CURRENT_MAP=this.room,$AVATAR.rotate(180),this.map.move=!0,$AVATAR.state.pickup.current&&($AVATAR.state.pickup.current.delete(),$CURRENT_MAP.link($AVATAR.state.pickup.current)),this.outPoint){var t=_slicedToArray(this.outPoint,2),e=t[0],r=t[1];if(this.buildingExit&&this.map.building){var s=this.map.building;noclip=!0,$CURRENT_MAP.translate(-$CURRENT_MAP.centerX+(s.trans.offsetX+$CURRENT_MAP.centerX+e),-$CURRENT_MAP.centerY+(s.trans.offsetY+$CURRENT_MAP.centerY+r)),noclip=!1}else noclip=!0,$CURRENT_MAP.translate(-$CURRENT_MAP.centerX+e,-$CURRENT_MAP.centerY+r),noclip=!1}$CURRENT_MAP.avatars[$AVATAR.id]=$AVATAR,$CURRENT_MAP.obstacles[$AVATAR.id]=$AVATAR,$MAP_DISPLAY.update()}.bind(this))}},{key:"clean",value:function(){this.label&&this.label.delete()}},{key:"translate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;this.label&&this.label.translate(t,e),this.trans.offsetX+=t,this.trans.offsetY+=e,r&&(this.trans.rotation=r),s&&this.cluster.translateVertices(this.clusterIndex,this.constructor._defaultVertices,-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}}])}(_StaticClusterClient_);_defineProperty(Door,"_defaultVertices",[-7.4,10.3,1,0,0,7.4,10.3,1,.578125,0,-7.4,-10.3,1,0,.8046875,7.4,10.3,1,.578125,0,-7.4,-10.3,1,0,.8046875,7.4,-10.3,1,.578125,.8046875]);var Table=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",28.4),_defineProperty(i,"height",19.4),_defineProperty(i,"name","table"),_defineProperty(i,"clusterName","table"),_defineProperty(i,"texture",textures.objects.table),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-14.2,-6.5,28.4,16.2]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Table,"_defaultVertices",[-14.2,9.7,1,0,0,14.2,9.7,1,.5546875,0,-14.2,-9.7,1,0,.7578125,14.2,9.7,1,.5546875,0,-14.2,-9.7,1,0,.7578125,14.2,-9.7,1,.5546875,.7578125]);var SmallTable=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",16.4),_defineProperty(i,"height",17.4),_defineProperty(i,"name","small table"),_defineProperty(i,"clusterName","small table"),_defineProperty(i,"texture",textures.objects.smalltable),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-8.2,-5.7,16.4,14.4]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(SmallTable,"_defaultVertices",[-8.2,8.7,1,0,0,8.2,8.7,1,.640625,0,-8.2,-8.7,1,0,.6796875,8.2,8.7,1,.640625,0,-8.2,-8.7,1,0,.6796875,8.2,-8.7,1,.640625,.6796875]);var Gazebo=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",64.4),_defineProperty(i,"height",68.4),_defineProperty(i,"name","gazebo"),_defineProperty(i,"clusterName","gazebo"),_defineProperty(i,"texture",textures.objects.gazebo),_defineProperty(i,"topLayer",!0),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-28.2,-2,4,4],[23.8,-2,4,4],[-28.2,-34,4,4],[23.8,-34,4,4]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Gazebo,"_defaultVertices",[-32.2,34.2,1,0,0,32.2,34.2,1,.62890625,0,-32.2,-34.2,1,0,.66796875,32.2,34.2,1,.62890625,0,-32.2,-34.2,1,0,.66796875,32.2,-34.2,1,.62890625,.66796875]);var Vendor1=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",40.4),_defineProperty(i,"height",28.4),_defineProperty(i,"name","vendor 1"),_defineProperty(i,"clusterName","vendor 1"),_defineProperty(i,"texture",textures.objects.vendor1),_defineProperty(i,"topLayer",!0),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-28.2,-2,4,4]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Vendor1,"_defaultVertices",[-20.2,14.2,1,0,0,20.2,14.2,1,.7890625,0,-20.2,-14.2,1,0,.5546875,20.2,14.2,1,.7890625,0,-20.2,-14.2,1,0,.5546875,20.2,-14.2,1,.7890625,.5546875]);var Bush=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",17.4),_defineProperty(i,"height",18),_defineProperty(i,"name","bush"),_defineProperty(i,"clusterName","bush"),_defineProperty(i,"texture",textures.objects.bush),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-6.5,-6.5,13,13]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Bush,"_defaultVertices",[-8.899999999999999,9.2,1,-.0078125,-.0078125,8.5,9.2,1,.671875,-.0078125,-8.899999999999999,-8.8,1,-.0078125,.6953125,8.5,9.2,1,.671875,-.0078125,-8.899999999999999,-8.8,1,-.0078125,.6953125,8.5,-8.8,1,.671875,.6953125]);var Whiteboard=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",30.9),_defineProperty(i,"height",16.9),_defineProperty(i,"name","whiteboard"),_defineProperty(i,"clusterName","whiteboard"),_defineProperty(i,"texture",textures.objects.whiteboard),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Whiteboard,"_defaultVertices",[-15.649999999999999,8.650000000000002,1,-.00390625,-.0078125,15.25,8.650000000000002,1,.599609375,-.0078125,-15.649999999999999,-8.25,1,-.00390625,.65234375,15.25,8.650000000000002,1,.599609375,-.0078125,-15.649999999999999,-8.25,1,-.00390625,.65234375,15.25,-8.25,1,.599609375,.65234375]);var Pinboard=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",33),_defineProperty(i,"height",19),_defineProperty(i,"name","pinboard"),_defineProperty(i,"clusterName","pinboard"),_defineProperty(i,"texture",textures.objects.pinboard),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Pinboard,"_defaultVertices",[-16.7,9.7,1,-.00390625,-.0078125,16.299999999999997,9.7,1,.640625,-.0078125,-16.7,-9.3,1,-.00390625,.734375,16.299999999999997,9.7,1,.640625,-.0078125,-16.7,-9.3,1,-.00390625,.734375,16.299999999999997,-9.3,1,.640625,.734375]);var MetalFence=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",29.6),_defineProperty(i,"height",16),_defineProperty(i,"name","metal fence"),_defineProperty(i,"clusterName","metal fence"),_defineProperty(i,"texture",textures.objects.metalfence),_defineProperty(i,"obstacle",!0),_defineProperty(i,"topLayer",!0),_defineProperty(i,"segments",[[-14.8,-7.6,29.2,2]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(MetalFence,"_defaultVertices",[-14.8,8,1,0,0,14.8,8,1,.578125,0,-14.8,-8,1,0,.625,14.8,8,1,.578125,0,-14.8,-8,1,0,.625,14.8,-8,1,.578125,.625]);var MetalFenceVertical=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",1.7),_defineProperty(i,"height",36),_defineProperty(i,"name","metal fence vertical"),_defineProperty(i,"clusterName","metal fence vertical"),_defineProperty(i,"texture",textures.objects.metalfencevertical),_defineProperty(i,"obstacle",!0),_defineProperty(i,"topLayer",!0),_defineProperty(i,"segments",[[-.85,-18,1.7,36]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(MetalFenceVertical,"_defaultVertices",[-.85,18,1,0,0,.85,18,1,.53125,0,-.85,-18,1,0,.703125,.85,18,1,.53125,0,-.85,-18,1,0,.703125,.85,-18,1,.53125,.703125]);var Atm=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",11.4),_defineProperty(i,"height",20.4),_defineProperty(i,"name","atm"),_defineProperty(i,"clusterName","atm"),_defineProperty(i,"texture",textures.objects.atm),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-5.7,-5.2,11.4,15.4]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Atm,"_defaultVertices",[-5.7,10.2,1,0,0,5.7,10.2,1,.890625,0,-5.7,-10.2,1,0,.796875,5.7,10.2,1,.890625,0,-5.7,-10.2,1,0,.796875,5.7,-10.2,1,.890625,.796875]);var Stopper=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",9.4),_defineProperty(i,"height",24.4),_defineProperty(i,"name","stopper"),_defineProperty(i,"clusterName","stopper"),_defineProperty(i,"texture",textures.objects.stopper),_defineProperty(i,"topLayer",!0),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-4.7,-12,9,6]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(Stopper,"_defaultVertices",[-4.7,12.2,1,0,0,4.7,12.2,1,.734375,0,-4.7,-12.2,1,0,.953125,4.7,12.2,1,.734375,0,-4.7,-12.2,1,0,.953125,4.7,-12.2,1,.734375,.953125]);var MixedBush=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",17.4),_defineProperty(i,"height",18),_defineProperty(i,"name","mixed bush"),_defineProperty(i,"clusterName","mixed bush"),_defineProperty(i,"texture",textures.objects.mixedbush),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-6.5,-6.5,13,13]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(MixedBush,"_defaultVertices",[-8.899999999999999,9.2,1,-.0078125,-.0078125,8.5,9.2,1,.671875,-.0078125,-8.899999999999999,-8.8,1,-.0078125,.6953125,8.5,9.2,1,.671875,-.0078125,-8.899999999999999,-8.8,1,-.0078125,.6953125,8.5,-8.8,1,.671875,.6953125]);var LightBush=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",17.4),_defineProperty(i,"height",18),_defineProperty(i,"name","light bush"),_defineProperty(i,"clusterName","light bush"),_defineProperty(i,"texture",textures.objects.lightbush),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-6.5,-6.5,13,13]]),i}return _inherits(e,t),_createClass(e)}(_StaticClusterClient_);_defineProperty(LightBush,"_defaultVertices",[-8.899999999999999,9.2,1,-.0078125,-.0078125,8.5,9.2,1,.671875,-.0078125,-8.899999999999999,-8.8,1,-.0078125,.6953125,8.5,9.2,1,.671875,-.0078125,-8.899999999999999,-8.8,1,-.0078125,.6953125,8.5,-8.8,1,.671875,.6953125]);var _Building_=function(t){function e(t,r,s){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6?arguments[6]:void 0;_classCallCheck(this,e),(i=_callSuper(this,e,[t,r,s])).setup=l,i.doors=[],i.type="building",i.rooms=n||[new _Map_(150,80,!1).init([[0+o,35]],o)];var h,c=_createForOfIteratorHelper(a);try{var _=function(){var t=h.value,e=new Trigger(i.trans.offsetX+t[0],i.trans.offsetY+t[1],function(){requestTransition(function(){if(delete $CURRENT_MAP.avatars[$AVATAR.id],delete $CURRENT_MAP.obstacles[$AVATAR.id],$CURRENT_MAP=this.rooms[t[2]],$AVATAR.rotate(180),this.map.move=!0,$AVATAR.state.pickup.current&&($AVATAR.state.pickup.current.delete(),$CURRENT_MAP.link($AVATAR.state.pickup.current)),t[3]){var e=_slicedToArray(t[3],2),r=e[0],s=e[1];noclip=!0,$CURRENT_MAP.translate(-$CURRENT_MAP.centerX+r,-$CURRENT_MAP.centerY+s),noclip=!1}$CURRENT_MAP.avatars[$AVATAR.id]=$AVATAR,$CURRENT_MAP.obstacles[$AVATAR.id]=$AVATAR,$MAP_DISPLAY.update()}.bind(this))}.bind(i),!0);e.outPoint=t[3],i.doors.push(e)};for(c.s();!(h=c.n()).done;)_()}catch(t){c.e(t)}finally{c.f()}return i}return _inherits(e,t),_createClass(e,[{key:"postLink",value:function(){var t,e=_createForOfIteratorHelper(this.doors);try{for(e.s();!(t=e.n()).done;){var r=t.value;this.map.link(r)}}catch(t){e.e(t)}finally{e.f()}var s,i=_createForOfIteratorHelper(this.rooms);try{for(i.s();!(s=i.n()).done;){var a=s.value;a.building=this,this.map.addSubMap(a)}}catch(t){i.e(t)}finally{i.f()}this.setup&&this.setup()}},{key:"clean",value:function(){var t,e=_createForOfIteratorHelper(this.doors);try{for(e.s();!(t=e.n()).done;)t.value.delete()}catch(t){e.e(t)}finally{e.f()}var r,s=_createForOfIteratorHelper(this.rooms);try{for(s.s();!(r=s.n()).done;){var i=r.value;this.map.deleteSubMap(i.mapId)}}catch(t){s.e(t)}finally{s.f()}}},{key:"translate",value:function(t,e){var r,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,a=_createForOfIteratorHelper(this.doors);try{for(a.s();!(r=a.n()).done;)r.value.translate(t,e)}catch(t){a.e(t)}finally{a.f()}this.trans.offsetX+=t,this.trans.offsetY+=e,s&&(this.trans.rotation=s),i&&this.cluster.translateVertices(this.clusterIndex,this.constructor._defaultVertices,-this.cluster.trans.offsetX+this.trans.offsetX,-this.cluster.trans.offsetY+this.trans.offsetY,this.trans.rotation)}}])}(_StaticClusterClient_),ConvenienceStore=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s,[[-26.1,-33,0,[0,44.38]],[23,25,0,[-50,44.38]],[23,-57,1],[-30,-65,0]],[new _Map_(150,100,!1,"House 1").init(void 0,void 0,[-26,-41],!0),new _Map_(150,80,!1,"House 1").init(),new _Map_(150,80,!1,"House 1").init()],void 0]),"width",124.4),_defineProperty(i,"height",92.2),_defineProperty(i,"name","convenience store"),_defineProperty(i,"clusterName","convenience store"),_defineProperty(i,"texture",textures.objects.conveniencestore),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-60,-43.9,120,36],[-62,-8.1,124,54]]),i}return _inherits(e,t),_createClass(e)}(_Building_);_defineProperty(ConvenienceStore,"_defaultVertices",[-62.2,46.1,1,0,0,62.2,46.1,1,.607421875,0,-62.2,-46.1,1,0,.900390625,62.2,46.1,1,.607421875,0,-62.2,-46.1,1,0,.900390625,62.2,-46.1,1,.607421875,.900390625]);var GunStore=function(t){function e(t,r,s){var i;_classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s,[[-35,-46,0,[0,44.38]]],[new _Map_(150,100,!1,"Gun Store").init(void 0,void 0,[-35,-53],!0)],void 0]),"width",152.5),_defineProperty(i,"height",98.5),_defineProperty(i,"name","gun store"),_defineProperty(i,"clusterName","gun store"),_defineProperty(i,"texture",textures.objects.gunstore),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-76.01,-12.989999999999998,152,62],[-70.01,-46.989999999999995,140,34]]);var a=new Floor(0,0,150,100,0);return a.exclude=!0,i.rooms[0].link(a),i}return _inherits(e,t),_createClass(e)}(_Building_);_defineProperty(GunStore,"_defaultVertices",[-76.25,49.25,1,0,0,76.25,49.25,1,.74462890625,0,-76.25,-49.25,1,0,.9619140625,76.25,49.25,1,.74462890625,0,-76.25,-49.25,1,0,.9619140625,76.25,-49.25,1,.74462890625,.9619140625]);var Shed=function(t){function e(t,r,s){var i;_classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s,[[0,-20,0,[0,20]]],[new _Map_(90,50,!1,"Shed").init(void 0,void 0,[0,-30],!0)],void 0]),"width",60.4),_defineProperty(i,"height",49.2),_defineProperty(i,"name","shed"),_defineProperty(i,"clusterName","shed"),_defineProperty(i,"texture",textures.objects.shed),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-30,-3.6,60,28],[-28,-23.6,56,20]]);var a=new Floor(0,0,150,100,1);return a.exclude=!0,i.rooms[0].link(a),i}return _inherits(e,t),_createClass(e)}(_Building_);_defineProperty(Shed,"_defaultVertices",[-30.2,24.6,1,0,0,30.2,24.6,1,.58984375,0,-30.2,-24.6,1,0,.9609375,30.2,24.6,1,.58984375,0,-30.2,-24.6,1,0,.9609375,30.2,-24.6,1,.58984375,.9609375]);var House1=function(t){function e(t,r,s){var i;_classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s,[[-26.1,-33,0,[0,44.38]],[23,25,0,[-50,44.38]],[23,-57,1],[-30,-65,0]],[new _Map_(150,100,!1,"House 1").init(void 0,void 0,[-26,-41],!0),new _Map_(150,80,!1,"House 1").init(),new _Map_(150,80,!1,"House 1").init()],void 0]),"width",147.4),_defineProperty(i,"height",144.4),_defineProperty(i,"name","house 1"),_defineProperty(i,"clusterName","house 1"),_defineProperty(i,"texture",textures.objects.house1),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[12.5,-70,50,24],[-71.5,-62,34,34],[-73.5,2,111,70],[2.5,-48,70,30],[2.5,-72,10,30],[62.5,-72,10,30],[2.5,0,70,64],[2.5,-20,6,64],[66.5,-20,6,64],[-71.5,-56,78,120]]);var a=new Door("Balcony",-1,-50,i.rooms[0].height/2+9.2,-1,[23,15],!0),n=new Floor(0,0,150,100,1);return n.exclude=!0,i.rooms[0].link(n),i.rooms[0].link(a),i}return _inherits(e,t),_createClass(e)}(_Building_);_defineProperty(House1,"_defaultVertices",[-73.7,72.2,1,0,0,73.7,72.2,1,.7197265625,0,-73.7,-72.2,1,0,.705078125,73.7,72.2,1,.7197265625,0,-73.7,-72.2,1,0,.705078125,73.7,-72.2,1,.7197265625,.705078125]);var House2=function(t){function e(t,r,s){var i;_classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s,[[-26.1,-33,0,[0,44.38]],[23,25,0,[-50,44.38]],[23,-57,1],[-30,-65,0]],[new _Map_(150,100,!1,"House 1").init(void 0,void 0,[-26,-41],!0),new _Map_(150,80,!1,"House 1").init(),new _Map_(150,80,!1,"House 1").init()],void 0]),"width",170.4),_defineProperty(i,"height",172.4),_defineProperty(i,"name","house 2"),_defineProperty(i,"clusterName","house 2"),_defineProperty(i,"texture",textures.objects.house2),_defineProperty(i,"obstacle",!0),_defineProperty(i,"segments",[[-85,-20,110,106],[-85,-26,102,112],[-85,-30,94,116],[-75,-42,2,24],[-76,-86,92,16],[82,-54,3,76],[17,-86,68,32],[25,18,60,52]]);var a=new Door("Balcony",-1,-50,i.rooms[0].height/2+9.2,-1,[23,15],!0),n=new Floor(0,0,150,100,1);return n.exclude=!0,i.rooms[0].link(n),i.rooms[0].link(a),i}return _inherits(e,t),_createClass(e)}(_Building_);_defineProperty(House2,"_defaultVertices",[-85.2,86.2,1,0,0,85.2,86.2,1,.83203125,0,-85.2,-86.2,1,0,.841796875,85.2,86.2,1,.83203125,0,-85.2,-86.2,1,0,.841796875,85.2,-86.2,1,.83203125,.841796875]);var _Pickup_=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,null!=s?s:(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)]),"pickup",!0),_defineProperty(i,"interactable",!0),_defineProperty(i,"minDistance",5),_defineProperty(i,"moveable",!0),_defineProperty(i,"subLayer",1),i.ring=new PickupRing(i.trans.offsetX,i.trans.offsetY),i.deletionAnimation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.delete()}],i,[20]),i}return _inherits(e,t),_createClass(e,[{key:"preRender",value:function(){this.linked&&this.dropped&&this!==$AVATAR.state.pickup.current&&this.deletionAnimation.run()}},{key:"postLink",value:function(){this.ring&&this.map.link(this.ring)}},{key:"clean",value:function(){this.ring&&this.ring.delete()}},{key:"action",value:function(){$AVATAR.addItem(this)}},{key:"translate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;this.trans.offsetX+=t,this.trans.offsetY+=e,this.ring&&this.ring.translate(this.trans.offsetX-this.ring.trans.offsetX,this.trans.offsetY-this.ring.trans.offsetY,!1,s),r&&(this.trans.rotation=r),s&&this.cluster.translateVertices(this.clusterIndex,t,e,this.trans.rotation)}}])}(_InstancedClusterClient_),_Gun_=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"reloadProgress",0),_defineProperty(i,"loaded",!0),_defineProperty(i,"type","gun"),i}return _inherits(e,t),_createClass(e)}(_Pickup_),_Blade_=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"type","knife"),_defineProperty(i,"integrity",100),i}return _inherits(e,t),_createClass(e,[{key:"degrade",value:function(){this.integrity-=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.np)(100-this.constructor._properties.durability,5),this.integrity<=0&&this===$AVATAR.state.equippedItems.mainTool&&($AVATAR.dropItem(this.slot),this.delete())}}])}(_Pickup_),_Medicine_=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"type","medicine"),_defineProperty(i,"used",!1),i}return _inherits(e,t),_createClass(e)}(_Pickup_),_Ammo_=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"type","ammo"),_defineProperty(i,"used",!1),i}return _inherits(e,t),_createClass(e)}(_Pickup_),Syringe=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",2.5),_defineProperty(i,"height",10.6),_defineProperty(i,"clusterName","syringe"),_defineProperty(i,"texture",textures.objects.syringe),_defineProperty(i,"name","syringe"),i}return _inherits(e,t),_createClass(e)}(_Medicine_);_defineProperty(Syringe,"_properties",{regain:25}),_defineProperty(Syringe,"_defaultVertices",[-1.25,5.3,1,0,0,1.25,5.3,1,.78125,0,-1.25,-5.3,1,0,.828125,1.25,5.3,1,.78125,0,-1.25,-5.3,1,0,.828125,1.25,-5.3,1,.78125,.828125]);var Money=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",7.4),_defineProperty(a,"height",3.8),_defineProperty(a,"clusterName","money"),_defineProperty(a,"texture",textures.objects.money),_defineProperty(a,"name","money"),_defineProperty(a,"type","cash"),a.amount=i||5+(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(100),a}return _inherits(e,t),_createClass(e)}(_Pickup_);_defineProperty(Money,"_defaultVertices",[-3.7,1.9,1,0,0,3.7,1.9,1,.578125,0,-3.7,-1.9,1,0,.59375,3.7,1.9,1,.578125,0,-3.7,-1.9,1,0,.59375,3.7,-1.9,1,.578125,.59375]);var MedKit=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",11.4),_defineProperty(i,"height",7.6),_defineProperty(i,"clusterName","med kit"),_defineProperty(i,"texture",textures.objects.medkit),_defineProperty(i,"name","med kit"),i}return _inherits(e,t),_createClass(e)}(_Medicine_);_defineProperty(MedKit,"_properties",{regain:75}),_defineProperty(MedKit,"_defaultVertices",[-5.7,3.8,1,0,0,5.7,3.8,1,.890625,0,-5.7,-3.8,1,0,.59375,5.7,3.8,1,.890625,0,-5.7,-3.8,1,0,.59375,5.7,-3.8,1,.890625,.59375]);var BasicArmour=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",7.4),_defineProperty(i,"height",10.2),_defineProperty(i,"clusterName","basic armour"),_defineProperty(i,"texture",textures.objects.basicarmour),_defineProperty(i,"name","basic armour"),_defineProperty(i,"type","armour"),i.integrity=50,i}return _inherits(e,t),_createClass(e)}(_Pickup_);_defineProperty(BasicArmour,"_properties",{strength:50}),_defineProperty(BasicArmour,"_defaultVertices",[-3.7,5.1,1,0,0,3.7,5.1,1,.578125,0,-3.7,-5.1,1,0,.796875,3.7,5.1,1,.578125,0,-3.7,-5.1,1,0,.796875,3.7,-5.1,1,.578125,.796875]);var RemoteDetonator=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",2.4),_defineProperty(i,"height",6),_defineProperty(i,"clusterName","remote detonator"),_defineProperty(i,"texture",textures.objects.remotedetonator),_defineProperty(i,"name","remote detonator"),_defineProperty(i,"type","detonator"),i}return _inherits(e,t),_createClass(e,[{key:"activate",value:function(){var t,e=_createForOfIteratorHelper($AVATAR.inventory.explosives);try{for(e.s();!(t=e.n()).done;){var r,s=t.value;null===(r=$CURRENT_MAP.objects[s])||void 0===r||r.detonate()}}catch(t){e.e(t)}finally{e.f()}}}])}(_Pickup_);_defineProperty(RemoteDetonator,"_defaultVertices",[-1.2,3,1,0,0,1.2,3,1,.75,0,-1.2,-3,1,0,.9375,1.2,3,1,.75,0,-1.2,-3,1,0,.9375,1.2,-3,1,.75,.9375]);var ProximityExplosive=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",4.2),_defineProperty(a,"height",7.6),_defineProperty(a,"clusterName","proximity explosive"),_defineProperty(a,"texture",textures.objects.proximityexplosive),_defineProperty(a,"name","proximity explosive"),_defineProperty(a,"type","explosive"),_defineProperty(a,"obstacle",!0),_defineProperty(a,"passable",!0),_defineProperty(a,"armed",!1),_defineProperty(a,"hideFromMap",!0),_defineProperty(a,"segments",[[-2.1,-3.8,4.2,7.6]]),a.owner=i,a.proximityCheckAnimation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){for(var t in $CURRENT_MAP.avatars)if((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.trans.offsetX,this.trans.offsetY,$CURRENT_MAP.avatars[t].trans.offsetX,$CURRENT_MAP.avatars[t].trans.offsetY)<20){this.detonate();break}}),a,1),a.activationTimeout=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.armed=!0}],a,[3]),a}return _inherits(e,t),_createClass(e,[{key:"detonate",value:function(){if(this.armed){for(var t=this.map,e=0;e<40;e++){var r=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360),s=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,1,r),2),i=s[0],a=s[1],n=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10)+3;t.link(new Bullet(this.trans.offsetX,this.trans.offsetY,r,i*n,a*n,100,$AVATAR))}this.delete()}}},{key:"arm",value:function(){this.armed=!0}},{key:"hit",value:function(){this.detonate()}},{key:"preRender",value:function(){this.activationTimeout.run(),this.armed&&this.proximityCheckAnimation.run()}}])}(_Pickup_);_defineProperty(ProximityExplosive,"_defaultVertices",[-2.1,3.8,1,0,0,2.1,3.8,1,.65625,0,-2.1,-3.8,1,0,.59375,2.1,3.8,1,.65625,0,-2.1,-3.8,1,0,.59375,2.1,-3.8,1,.65625,.59375]);var RemoteExplosive=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",4.2),_defineProperty(a,"height",7.6),_defineProperty(a,"clusterName","remote explosive"),_defineProperty(a,"texture",textures.objects.remoteexplosive),_defineProperty(a,"name","remote explosive"),_defineProperty(a,"type","explosive"),_defineProperty(a,"obstacle",!0),_defineProperty(a,"passable",!0),_defineProperty(a,"armed",!1),_defineProperty(a,"hideFromMap",!0),_defineProperty(a,"segments",[[-2.1,-3.8,4.2,7.6]]),a.owner=i,a}return _inherits(e,t),_createClass(e,[{key:"detonate",value:function(){if(this.armed){for(var t=this.map,e=0;e<40;e++){var r=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360),s=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,1,r),2),i=s[0],a=s[1],n=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10)+3;t.link(new Bullet(this.trans.offsetX,this.trans.offsetY,r,i*n,a*n,100,$AVATAR))}this.delete()}}},{key:"arm",value:function(){this.armed=!0}},{key:"hit",value:function(){this.detonate()}}])}(_Pickup_);_defineProperty(RemoteExplosive,"_defaultVertices",[-2.1,3.8,1,0,0,2.1,3.8,1,.65625,0,-2.1,-3.8,1,0,.59375,2.1,3.8,1,.65625,0,-2.1,-3.8,1,0,.59375,2.1,-3.8,1,.65625,.59375]);var MercenaryArmour=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",7.4),_defineProperty(i,"height",10.2),_defineProperty(i,"clusterName","mercenary armour"),_defineProperty(i,"texture",textures.objects.mercenaryarmour),_defineProperty(i,"name","mercenary armour"),_defineProperty(i,"type","armour"),i.integrity=150,i}return _inherits(e,t),_createClass(e)}(_Pickup_);_defineProperty(MercenaryArmour,"_properties",{strength:150}),_defineProperty(MercenaryArmour,"_defaultVertices",[-3.7,5.1,1,0,0,3.7,5.1,1,.578125,0,-3.7,-5.1,1,0,.796875,3.7,5.1,1,.578125,0,-3.7,-5.1,1,0,.796875,3.7,-5.1,1,.578125,.796875]);var SwatArmour=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",7.4),_defineProperty(i,"height",10.2),_defineProperty(i,"clusterName","swat armour"),_defineProperty(i,"texture",textures.objects.swatarmour),_defineProperty(i,"name","swat armour"),_defineProperty(i,"type","armour"),i.integrity=100,i}return _inherits(e,t),_createClass(e)}(_Pickup_);_defineProperty(SwatArmour,"_properties",{strength:100}),_defineProperty(SwatArmour,"_defaultVertices",[-3.7,5.1,1,0,0,3.7,5.1,1,.578125,0,-3.7,-5.1,1,0,.796875,3.7,5.1,1,.578125,0,-3.7,-5.1,1,0,.796875,3.7,-5.1,1,.578125,.796875]);var AmmoBox=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",6.4),_defineProperty(i,"height",8.6),_defineProperty(i,"clusterName","ammo box"),_defineProperty(i,"type","ammo"),_defineProperty(i,"texture",textures.objects.ammobox),_defineProperty(i,"name","ammo box"),i}return _inherits(e,t),_createClass(e)}(_Ammo_);_defineProperty(AmmoBox,"_properties",{increase:5}),_defineProperty(AmmoBox,"_defaultVertices",[-3.2,4.3,1,0,0,3.2,4.3,1,.5,0,-3.2,-4.3,1,0,.671875,3.2,4.3,1,.5,0,-3.2,-4.3,1,0,.671875,3.2,-4.3,1,.5,.671875]);var MultiAmmoBox=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",12.4),_defineProperty(i,"height",8.6),_defineProperty(i,"clusterName","multi ammo box"),_defineProperty(i,"type","ammo"),_defineProperty(i,"texture",textures.objects.multiammobox),_defineProperty(i,"name","multi ammo box"),i}return _inherits(e,t),_createClass(e)}(_Ammo_);_defineProperty(MultiAmmoBox,"_properties",{increase:3}),_defineProperty(MultiAmmoBox,"_defaultVertices",[-6.2,4.3,1,0,0,6.2,4.3,1,.96875,0,-6.2,-4.3,1,0,.671875,6.2,4.3,1,.96875,0,-6.2,-4.3,1,0,.671875,6.2,-4.3,1,.96875,.671875]);var KitchenKnife=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",2.48),_defineProperty(i,"height",13.14),_defineProperty(i,"clusterName","kitchen knife"),_defineProperty(i,"texture",textures.objects.kitchenknife),_defineProperty(i,"name","kitchen knife"),i}return _inherits(e,t),_createClass(e)}(_Blade_);_defineProperty(KitchenKnife,"_properties",{damage:25,durability:10,useTextures:[14,15,16,17,18]}),_defineProperty(KitchenKnife,"_defaultVertices",[-1.24,6.57,1,0,0,1.24,6.57,1,.775,0,-1.24,-6.57,1,0,.51328125,1.24,6.57,1,.775,0,-1.24,-6.57,1,0,.51328125,1.24,-6.57,1,.775,.51328125]);var AssassinsKnife=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",3.46),_defineProperty(i,"height",13.540000000000001),_defineProperty(i,"name","assassins knife"),_defineProperty(i,"clusterName","assassins knife"),_defineProperty(i,"texture",textures.objects.assassinsknife),i}return _inherits(e,t),_createClass(e)}(_Blade_);_defineProperty(AssassinsKnife,"_properties",{damage:100,durability:30,useTextures:[19,20,21,22,23]}),_defineProperty(AssassinsKnife,"_defaultVertices",[-1.73,6.7700000000000005,1,0,0,1.73,6.7700000000000005,1,.540625,0,-1.73,-6.7700000000000005,1,0,.52890625,1.73,6.7700000000000005,1,.540625,0,-1.73,-6.7700000000000005,1,0,.52890625,1.73,-6.7700000000000005,1,.540625,.52890625]);var CombatKnife=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",3.6),_defineProperty(i,"height",13.6),_defineProperty(i,"clusterName","combat knife"),_defineProperty(i,"texture",textures.objects.combatknife),_defineProperty(i,"name","combat knife"),i}return _inherits(e,t),_createClass(e)}(_Blade_);_defineProperty(CombatKnife,"_properties",{damage:50,durability:50,useTextures:[textures.skins.avatarcombatknife1.id,textures.skins.avatarcombatknife2.id,textures.skins.avatarcombatknife3.id,textures.skins.avatarcombatknifewalking1.id,textures.skins.avatarcombatknifewalking2.id]}),_defineProperty(CombatKnife,"_defaultVertices",[-1.8,6.8,1,0,0,1.8,6.8,1,.5625,0,-1.8,-6.8,1,0,.53125,1.8,6.8,1,.5625,0,-1.8,-6.8,1,0,.53125,1.8,-6.8,1,.5625,.53125]);var GLOCK_20=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",8.780000000000001),_defineProperty(a,"height",6.180000000000001),_defineProperty(a,"name","glock 20"),_defineProperty(a,"clusterName","glock 20"),_defineProperty(a,"texture",textures.objects.glock20),a.bullets=null!=i?i:65,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(GLOCK_20,"_properties",{fireRate:1.5,bulletSpeed:5,damage:16,accuracy:5,nozzelLength:13,capacity:18,reloadTime:3,useTextures:[4,5]}),_defineProperty(GLOCK_20,"_defaultVertices",[-4.390000000000001,3.0900000000000003,1,0,0,4.390000000000001,3.0900000000000003,1,.6859375000000001,0,-4.390000000000001,-3.0900000000000003,1,0,.965625,4.390000000000001,3.0900000000000003,1,.6859375000000001,0,-4.390000000000001,-3.0900000000000003,1,0,.965625,4.390000000000001,-3.0900000000000003,1,.6859375000000001,.965625]);var DX_9=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",9.1),_defineProperty(a,"height",6.4),_defineProperty(a,"name","dx 9"),_defineProperty(a,"clusterName","dx 9"),_defineProperty(a,"texture",textures.objects.dx9),a.bullets=null!=i?i:65,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(DX_9,"_properties",{fireRate:3,bulletSpeed:5,damage:12,accuracy:5,nozzelLength:13,capacity:26,reloadTime:2.5,useTextures:[textures.skins.avatardrawdx9.id,textures.skins.avatardrawdx9pullback.id]}),_defineProperty(DX_9,"_defaultVertices",[-4.55,3.2,1,0,0,4.55,3.2,1,.7109375,0,-4.55,-3.2,1,0,.5,4.55,3.2,1,.7109375,0,-4.55,-3.2,1,0,.5,4.55,-3.2,1,.7109375,.5]);var NOSS_7=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",14.4),_defineProperty(a,"height",6.6),_defineProperty(a,"name","noss 7"),_defineProperty(a,"clusterName","noss 7"),_defineProperty(a,"texture",textures.objects.noss7),a.bullets=null!=i?i:216,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(NOSS_7,"_properties",{fireRate:12,bulletSpeed:8,damage:28,accuracy:15,nozzelLength:19,capacity:46,reloadTime:5,useTextures:[textures.skins.avatardrawnoss7.id,textures.skins.avatardrawnoss7pullback.id]}),_defineProperty(NOSS_7,"_defaultVertices",[-7.2,3.3,1,0,0,7.2,3.3,1,.5625,0,-7.2,-3.3,1,0,.515625,7.2,3.3,1,.5625,0,-7.2,-3.3,1,0,.515625,7.2,-3.3,1,.5625,.515625]);var FURS_55=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",12.6),_defineProperty(a,"height",7.4),_defineProperty(a,"name","furs 55"),_defineProperty(a,"clusterName","furs 55"),_defineProperty(a,"texture",textures.objects.furs55),a.bullets=null!=i?i:65,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(FURS_55,"_properties",{fireRate:1.3,bulletSpeed:5,damage:23,accuracy:5,nozzelLength:13,capacity:8,reloadTime:4,useTextures:[textures.skins.avatardrawfurs55.id,textures.skins.avatardrawfurs55pullback.id]}),_defineProperty(FURS_55,"_defaultVertices",[-6.3,3.7,1,0,0,6.3,3.7,1,.984375,0,-6.3,-3.7,1,0,.578125,6.3,3.7,1,.984375,0,-6.3,-3.7,1,0,.578125,6.3,-3.7,1,.984375,.578125]);var GP_K100=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",14.8),_defineProperty(a,"height",6.180000000000001),_defineProperty(a,"name","gp k100"),_defineProperty(a,"clusterName","gp k100"),_defineProperty(a,"texture",textures.objects.gpk100),a.bullets=null!=i?i:58,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(GP_K100,"_properties",{fireRate:3,bulletSpeed:8,damage:13,accuracy:2,nozzelLength:21,capacity:12,reloadTime:2,useTextures:[6,7]}),_defineProperty(GP_K100,"_defaultVertices",[-7.4,3.0900000000000003,1,0,0,7.4,3.0900000000000003,1,.578125,0,-7.4,-3.0900000000000003,1,0,.965625,7.4,3.0900000000000003,1,.578125,0,-7.4,-3.0900000000000003,1,0,.965625,7.4,-3.0900000000000003,1,.578125,.965625]);var NXR_44_MAG=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",13.820000000000002),_defineProperty(a,"height",6.88),_defineProperty(a,"clusterName","nxr 44 mag"),_defineProperty(a,"texture",textures.objects.nxr44mag),_defineProperty(a,"name","nxr 44 mag"),a.bullets=null!=i?i:24,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(NXR_44_MAG,"_properties",{fireRate:.8,bulletSpeed:10,damage:42,accuracy:8,nozzelLength:21,capacity:6,reloadTime:5,useTextures:[8,9]}),_defineProperty(NXR_44_MAG,"_defaultVertices",[-6.910000000000001,3.44,1,0,0,6.910000000000001,3.44,1,.5398437500000001,0,-6.910000000000001,-3.44,1,0,.5375,6.910000000000001,3.44,1,.5398437500000001,0,-6.910000000000001,-3.44,1,0,.5375,6.910000000000001,-3.44,1,.5398437500000001,.5375]);var KC_357=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",8.52),_defineProperty(a,"height",5.6),_defineProperty(a,"clusterName","kc 357"),_defineProperty(a,"texture",textures.objects.kc357),_defineProperty(a,"name","kc 357"),a.bullets=null!=i?i:48,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(KC_357,"_properties",{fireRate:2.5,bulletSpeed:5,damage:12,accuracy:5,nozzelLength:15,capacity:6,reloadTime:3,useTextures:[textures.skins.avatardrawkc357.id,textures.skins.avatardrawkc357pullback.id]}),_defineProperty(KC_357,"_defaultVertices",[-4.26,2.8,1,0,0,4.26,2.8,1,.665625,0,-4.26,-2.8,1,0,.875,4.26,2.8,1,.665625,0,-4.26,-2.8,1,0,.875,4.26,-2.8,1,.665625,.875]);var X6_91=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",9.2),_defineProperty(a,"height",6.8),_defineProperty(a,"clusterName","x6 91"),_defineProperty(a,"texture",textures.objects.x691),_defineProperty(a,"name","x6 91"),a.bullets=null!=i?i:52,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(X6_91,"_properties",{fireRate:2.2,bulletSpeed:4,damage:64,accuracy:1,nozzelLength:21,capacity:7,reloadTime:4,useTextures:[textures.skins.avatardrawx691.id,textures.skins.avatardrawx691pullback.id]}),_defineProperty(X6_91,"_defaultVertices",[-4.6,3.4,1,0,0,4.6,3.4,1,.71875,0,-4.6,-3.4,1,0,.53125,4.6,3.4,1,.71875,0,-4.6,-3.4,1,0,.53125,4.6,-3.4,1,.71875,.53125]);var USP_45=function(t){function e(t,r,s,i){var a;return _classCallCheck(this,e),_defineProperty(a=_callSuper(this,e,[t,r,s]),"width",16.3),_defineProperty(a,"height",7.860000000000001),_defineProperty(a,"clusterName","usp 45"),_defineProperty(a,"texture",textures.objects.usp45),_defineProperty(a,"name","usp 45"),a.bullets=null!=i?i:52,a}return _inherits(e,t),_createClass(e)}(_Gun_);_defineProperty(USP_45,"_properties",{fireRate:2,bulletSpeed:7,damage:52,accuracy:5,nozzelLength:21,capacity:8,reloadTime:4,useTextures:[textures.skins.avatardrawusp45.id,textures.skins.avatardrawusp45pullback.id]}),_defineProperty(USP_45,"_defaultVertices",[-8.15,3.9300000000000006,1,0,0,8.15,3.9300000000000006,1,.63671875,0,-8.15,-3.9300000000000006,1,0,.6140625000000001,8.15,3.9300000000000006,1,.63671875,0,-8.15,-3.9300000000000006,1,0,.6140625000000001,8.15,-3.9300000000000006,1,.63671875,.6140625000000001]);var GreyBackpack=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",8),_defineProperty(i,"clusterName","grey backpack"),_defineProperty(i,"texture",textures.objects.greybackpack),_defineProperty(i,"height",10.8),_defineProperty(i,"subLayer",1),_defineProperty(i,"moveable",!0),_defineProperty(i,"name","grey backpack"),_defineProperty(i,"type","backpack"),i}return _inherits(e,t),_createClass(e)}(_Pickup_);_defineProperty(GreyBackpack,"_properties",{capacity:10,useTexture:textures.skins.grey_backpack_acc.id}),_defineProperty(GreyBackpack,"_defaultVertices",[-4,5.4,1,0,0,4,5.4,1,.625,0,-4,-5.4,1,0,.84375,4,5.4,1,.625,0,-4,-5.4,1,0,.84375,4,-5.4,1,.625,.84375]);var WhiteBackpack=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",8),_defineProperty(i,"clusterName","white backpack"),_defineProperty(i,"texture",textures.objects.whitebackpack),_defineProperty(i,"height",10.8),_defineProperty(i,"subLayer",1),_defineProperty(i,"moveable",!0),_defineProperty(i,"name","white backpack"),_defineProperty(i,"type","backpack"),i}return _inherits(e,t),_createClass(e)}(_Pickup_);_defineProperty(WhiteBackpack,"_properties",{capacity:25,useTexture:textures.skins.white_backpack_acc.id}),_defineProperty(WhiteBackpack,"_defaultVertices",[-4,5.4,1,0,0,4,5.4,1,.625,0,-4,-5.4,1,0,.84375,4,5.4,1,.625,0,-4,-5.4,1,0,.84375,4,-5.4,1,.625,.84375]);var BlackBackpack=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",8),_defineProperty(i,"clusterName","black backpack"),_defineProperty(i,"texture",textures.objects.blackbackpack),_defineProperty(i,"height",10.8),_defineProperty(i,"subLayer",1),_defineProperty(i,"moveable",!0),_defineProperty(i,"name","black backpack"),_defineProperty(i,"type","backpack"),i}return _inherits(e,t),_createClass(e)}(_Pickup_);_defineProperty(BlackBackpack,"_properties",{capacity:50,useTexture:textures.skins.black_backpack_acc.id}),_defineProperty(BlackBackpack,"_defaultVertices",[-4,5.4,1,0,0,4,5.4,1,.625,0,-4,-5.4,1,0,.84375,4,5.4,1,.625,0,-4,-5.4,1,0,.84375,4,-5.4,1,.625,.84375]);var PickupRing=function(t){function e(t,r,s){var i;return _classCallCheck(this,e),_defineProperty(i=_callSuper(this,e,[t,r,s]),"width",8.56),_defineProperty(i,"height",8.56),_defineProperty(i,"name","pickup ring"),_defineProperty(i,"clusterName","pickup ring"),_defineProperty(i,"exclude",!0),_defineProperty(i,"texture",textures.misc.pickupring),_defineProperty(i,"managedMovement",!0),_defineProperty(i,"subLayer",2),i.rot=0,i.animation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){360===this.rot?this.rot=0:this.translate(0,0,this.rot+=2,!0)}),i,.1,.2),i}return _inherits(e,t),_createClass(e,[{key:"preRender",value:function(){this.animation.run()}}])}(_InstancedClusterClient_);_defineProperty(PickupRing,"_defaultVertices",[-4.28,4.28,1,0,0,4.28,4.28,1,.66875,0,-4.28,-4.28,1,0,.66875,4.28,4.28,1,.66875,0,-4.28,-4.28,1,0,.66875,4.28,-4.28,1,.66875,.66875]);var Avatar=function(){return _createClass((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unnamed Human",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,t),this.character=e,this.nameObj=new Text(e,25),this.nameObj.translate(r+0,s+10),this.vao=ext.createVertexArrayOES(),ext.bindVertexArrayOES(this.vao),this.vertices={body:[-7.0200000000000005,21.4,1,0,0,0,7.0200000000000005,21.4,1,.5484375,0,0,-7.0200000000000005,-21.4,1,0,.8359375,0,7.0200000000000005,21.4,1,.5484375,0,0,-7.0200000000000005,-21.4,1,0,.8359375,0,7.0200000000000005,-21.4,1,.5484375,.8359375,0],eyes:[-2.7,3.379999999999999,1,.16875,.351953125,1,2.7,3.379999999999999,1,.3796875,.351953125,1,-2.7,1.4800000000000004,1,.16875,.3890625,1,2.7,3.379999999999999,1,.3796875,.351953125,1,-2.7,1.4800000000000004,1,.16875,.3890625,1,2.7,1.4800000000000004,1,.3796875,.3890625,1],accessory1:[-7.12,4.3799999999999955,1,-.00390625,.332421875,2,6.920000000000001,4.3799999999999955,1,.54453125,.332421875,2,-7.12,-38.42,1,-.00390625,1.168359375,2,6.920000000000001,4.3799999999999955,1,.54453125,.332421875,2,-7.12,-38.42,1,-.00390625,1.168359375,2,6.920000000000001,-38.42,1,.54453125,1.168359375,2],accessory2:[-7.12,4.3799999999999955,1,-.00390625,.332421875,3,6.920000000000001,4.3799999999999955,1,.54453125,.332421875,3,-7.12,-38.42,1,-.00390625,1.168359375,3,6.920000000000001,4.3799999999999955,1,.54453125,.332421875,3,-7.12,-38.42,1,-.00390625,1.168359375,3,6.920000000000001,-38.42,1,.54453125,1.168359375,3]},this.trans={offsetX:r||0,offsetY:s||0,rotation:i*Math.PI/180||0},this.width=8.56,this.height=8.56,this.obstacle=!0,this.segments=[[-4.08,-4.08,8.16,8.16]],this.bounds={width:this.height,height:this.height},this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.playerId=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(20),this.inventory=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.rI,this.type="avatar",this.name="avatar",this.state={strength:5,agility:.5,armour:0,invinsible:!1,kills:0,deaths:0,hitboxes:{leftPunch:{x:-4,y:7,width:2,height:2},rightPunch:{x:4,y:7,width:2,height:2},knife:{x:5,y:12,width:4,height:4},pickup:{x:0,y:0,width:1,height:1}},seat:{ref:void 0,id:void 0},pickup:{offset:{x:0,y:0,aRotation:0,bRotation:0},current:!1,reachDistance:8},vitals:{health:100,hunger:100,thirst:100},targetId:void 0,confidence:25,reputation:25,walking:!1,punching:!1,stabbing:!1,armed:!1,melee:!1,draw:!1,fire:!1,equippedItems:{mainTool:void 0,armour:void 0,accessory1:void 0,accessory2:void 0},punchingAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){var t=this.state.leftPunchAnimation,e=this.state.rightPunchAnimation;t.active?t.run():e.active&&e.run(),t.active||e.active||((Math.random()<.5?t:e).active=!0)}),this,.01),reloadTimeout:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.state.equippedItems.mainTool?(this.state.equippedItems.mainTool.reloadProgress=0,this.state.equippedItems.mainTool.loaded=!0,enableReloadDisplay(),updateAmmoDisplay()):enableReloadDisplay()}],this,[0],(function(){enableReloadDisplay()})),fireAnimation:void 0,recoilAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[1]},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]}],this,[.05,.05],(function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]}),.5,!0),walkingAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[4]:2},function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[0]:0},function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[3]:3},function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[0]:0}],this,[.08,.08,.08,.08],(function(){this.state.position.body.texture=0}),.5),leftPunchAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=0},function(){this.state.position.body.texture=10},function(){this.state.position.body.texture=11,this.meleeAttack(this.state.strength,this.state.hitboxes.leftPunch)},function(){this.state.position.body.texture=0}],this,[.08,.08,.08,.15],(function(){this.state.position.body.texture=0})),rightPunchAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=0},function(){this.state.position.body.texture=12},function(){this.state.position.body.texture=13,this.meleeAttack(this.state.strength,this.state.hitboxes.rightPunch)},function(){this.state.position.body.texture=0}],this,[.08,.08,.08,.15],(function(){this.state.position.body.texture=0})),meleeAttackAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[2],this.meleeAttack(this.state.equippedItems.mainTool.constructor._properties.damage+this.state.strength,this.state.hitboxes.knife)},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[1]},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]}],this,[.08,.08,.08,.15],(function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]})),blinkingAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.eyes.texture=0},function(){this.state.position.eyes.texture=1},function(){this.state.position.eyes.texture=0}],this,[5*Math.random(),1,1]),position:{body:{texture:0},eyes:{texture:0},accessory1:{texture:0},accessory2:{texture:0}}},ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(locations.textrUnit,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.enableVertexAttribArray(locations.textrUnit),gl.disableVertexAttribArray(locations.offset),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([].concat(_toConsumableArray(this.vertices.body),_toConsumableArray(this.vertices.eyes))),gl.STATIC_DRAW),gl.useProgram(program)}),[{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e,this.nameObj.translate(t,e),gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY])}},{key:"rotate",value:function(t){t=t*Math.PI/180,this.trans.rotation=t,gl.uniform1f(locations.rotation,this.trans.rotation)}},{key:"postLink",value:function(){this.state.leftPunchAnimation.animationMultFactor=this.state.agility,this.state.rightPunchAnimation.animationMultFactor=this.state.agility,this.state.meleeAttackAnimation.animationMultFactor=2*this.state.agility,this.state.fireAnimation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){this.state.recoilAnimation.start();var t=$CURRENT_MAP,e=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,1,180*this.trans.rotation/Math.PI),2),r=e[0],s=e[1],i=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(this.state.equippedItems.mainTool.constructor._properties.accuracy||0);i=Math.random()<.5?-i:i;var a=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(r,s,i),2),n=a[0],o=a[1],l=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,this.state.equippedItems.mainTool.constructor._properties.nozzelLength,180*this.trans.rotation/Math.PI),2),h=l[0],c=l[1];t.link(new Bullet(h+this.trans.offsetX,c+this.trans.offsetY,180*this.trans.rotation/Math.PI+90,n*this.state.equippedItems.mainTool.constructor._properties.bulletSpeed,o*this.state.equippedItems.mainTool.constructor._properties.bulletSpeed,this.state.equippedItems.mainTool.constructor._properties.damage,this));var _=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(20,0,180*this.trans.rotation/Math.PI),2),u=_[0],f=_[1],d=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10),p=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(u,f,Math.random()<.5?-d:d),2),y=p[0],g=p[1],b=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,8,180*this.trans.rotation/Math.PI),2),m=b[0],v=b[1];t.link(new BulletShell(this.trans.offsetX+m,this.trans.offsetY+v,y,g)),this.inventory.weapons[this.state.equippedItems.mainTool.name].ammo--,this.state.equippedItems.mainTool.reloadProgress++,this.state.equippedItems.mainTool.reloadProgress===this.state.equippedItems.mainTool.constructor._properties.capacity&&(this.state.equippedItems.mainTool.loaded=!1),updateAmmoDisplay()}),this,0)}},{key:"hit",value:function(t,e,r){if(!this.state.invinsible&&(this.state.armour>0?(t>this.state.armour&&(this.state.vitals.health=Math.max(0,this.state.vitals.health-Math.abs(this.state.armour-t))),this.state.armour=Math.max(0,this.state.armour-t),this.state.equippedItems.armour&&(this.state.equippedItems.armour.integrity=Math.max(0,this.state.equippedItems.armour.integrity-t),updateArmourDisplay()),0===this.state.armour&&hideArmourDisplay()):this.state.vitals.health=Math.max(0,this.state.vitals.health-t),updateHealthBar(),this.state.vitals.health<=0&&0===this.state.armour)){var s=$CURRENT_MAP.avatars[e.id];return s&&(s.state.kills+=1),$AVATAR.state.deaths+=1,this.purgeItems(5),delete $CURRENT_MAP.avatars[this.id],delete $CURRENT_MAP.obstacles[this.id],endDialogue(),this.state.pickup.current&&this.drop(),this.hidden=!0,noclip=!0,void returnToTitleScreen()}}},{key:"drawWeapon",value:function(){this.state.equippedItems.mainTool&&!this.state.stabbing&&(this.state.armed||this.state.melee)&&(this.state.draw=!0,this.state.walking&&this.state.melee||(this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]))}},{key:"holsterWeapon",value:function(){(this.state.armed||this.state.melee)&&(this.state.draw=!1,this.state.position.body.texture=0)}},{key:"reload",value:function(){this.state.equippedItems.mainTool.reloadProgress&&(this.state.reloadTimeout.start(),disableReloadDisplay())}},{key:"addItem",value:function(t,e){return!!this.inventory.addItem(t,e)&&(updateInventoryItem(t.slot,t.name),!0)}},{key:"dropItem",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.inventory.items[t])return!1;updateInventoryItem(this.inventory.items[t].slot,this.inventory.items[t].name,!0),this.unequipItem(t);var r=this.inventory.ejectItem(t);return r.dropped=!0,e?(r.ring.trans.offsetX=r.trans.offsetX=this.trans.offsetX+(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10,!0),r.ring.trans.offsetY=r.trans.offsetY=this.trans.offsetY+(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10,!0),r.trans.rotation=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)):delete r.ring,$CURRENT_MAP.link(r),!0}},{key:"purgeItems",value:function(t){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r<t;r++)e.includes(r)||this.inventory.items[r]&&this.dropItem(r)}},{key:"equipItem",value:function(t){if(!this.state.pickup.current){var e=this.inventory.items[t],r=!1;if(e){switch(e.type){case"cash":$AVATAR.inventory.cash+=e.amount,this.dropItem(t),e.delete(),updateMoneyDisplay();break;case"detonator":e.activate();break;case"explosive":"remote explosive"===e.name?(e.arm(),$AVATAR.inventory.explosives.push(e.id)):e.activationTimeout.start(),this.dropItem(t,!1);break;case"armour":this.state.equippedItems.armour!==e&&(this.state.equippedItems.armour=e,this.state.armour=e.integrity,updateArmourDisplay(),showArmourDisplay());break;case"ammo":var s,i;if(!e.used)if("ammo box"===e.name&&"gun"===(null===(s=this.state.equippedItems.mainTool)||void 0===s?void 0:s.type))this.inventory.weapons[this.state.equippedItems.mainTool.name].ammo+=this.state.equippedItems.mainTool.constructor._properties.capacity*e.constructor._properties.increase,e.used=!0,this.dropItem(t),updateAmmoDisplay();else if("multi ammo box"===e.name&&"gun"===(null===(i=this.state.equippedItems.mainTool)||void 0===i?void 0:i.type)){for(var a in this.inventory.weapons)this.inventory.weapons[a].ammo+=this.state.equippedItems.mainTool.constructor._properties.capacity*e.constructor._properties.increase;e.used=!0,this.dropItem(t),updateAmmoDisplay()}break;case"medicine":this.state.armed=!1,!e.used&&this.state.vitals.health<100&&(this.state.vitals.health+=Math.min(e.constructor._properties.regain,100-this.state.vitals.health),e.used=!0,updateDescription(),this.dropItem(t),updateHealthBar());break;case"gun":this.state.armed=!0,this.state.melee=!1,this.state.equippedItems.mainTool=e,this.state.equippedItems.mainTool.reloadProgress=e.reloadProgress,this.state.equippedItems.mainTool.loaded=e.loaded,this.state.reloadTimeout.timingConfig[0]=this.state.equippedItems.mainTool.constructor._properties.reloadTime,this.state.fireAnimation.rate=.5/this.state.equippedItems.mainTool.constructor._properties.fireRate,this.state.reloadTimeout.end(),updateAmmoDisplay(),showAmmoDisplay();break;case"knife":this.state.armed=!1,this.state.melee=!0,this.state.equippedItems.mainTool=e,this.state.reloadTimeout.end();break;case"backpack":var n;this.state.position.accessory1.texture=e.constructor._properties.useTexture,this.state.equippedItems.accessory1=e,15+e.constructor._properties.capacity<this.inventory.slots&&(this.purgeItems(this.inventory.slots,15+e.constructor._properties.capacity,[t]),t>15+e.constructor._properties.capacity&&(n=this.inventory.ejectItem(t))),setInventoryCapacity(15+e.constructor._properties.capacity),t>15+e.constructor._properties.capacity&&!this.addItem(n)&&(this.dropItem(14),this.inventory.addItem(n,14)),r=!0}if(this.state.equippedItems.mainTool&&"gun"===this.state.equippedItems.mainTool.type||hideAmmoDisplay(),r){ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(locations.textrUnit,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.enableVertexAttribArray(locations.textrUnit),gl.disableVertexAttribArray(locations.offset);var o=[].concat(_toConsumableArray(this.vertices.body),_toConsumableArray(this.vertices.eyes));this.state.position.accessory1.texture&&(o=o.concat(this.vertices.accessory1)),this.state.position.accessory2.texture&&(o=o.concat(this.vertices.accessory2)),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(o),gl.STATIC_DRAW)}return!0}return!1}}},{key:"unequipItem",value:function(t){if(!this.inventory.items[t]||this.inventory.items[t]!==this.state.equippedItems.mainTool&&this.inventory.items[t]!==this.state.equippedItems.accessory1&&this.inventory.items[t]!==this.state.equippedItems.accessory2&&this.inventory.items[t]!==this.state.equippedItems.armour)return!1;var e=this.inventory.items[t],r=!1;switch(e.type){case"armour":this.state.equippedItems.armour=void 0,this.state.armour=0,hideArmourDisplay();break;case"gun":this.state.equippedItems.mainTool&&e.slot===this.state.equippedItems.mainTool.slot&&(this.state.armed=!1,this.state.draw=!1,this.state.equippedItems.mainTool=void 0,this.state.reloadTimeout.end(),hideAmmoDisplay());break;case"knife":this.state.melee=!1,this.state.draw=!1,this.state.stabbing=!1,this.state.equippedItems.mainTool=void 0;break;case"backpack":var s;this.state.equippedItems.accessory1=void 0,this.state.position.accessory1.texture=0,this.purgeItems(this.inventory.slots,15,[t]),t>14&&(s=this.inventory.ejectItem(t)),setInventoryCapacity(15),t>14&&!this.addItem(s)&&(this.dropItem(14),this.addItem(s,14)),r=!0}if(r){ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(locations.textrUnit,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.enableVertexAttribArray(locations.textrUnit),gl.disableVertexAttribArray(locations.offset);var i=[].concat(_toConsumableArray(this.vertices.body),_toConsumableArray(this.vertices.eyes));this.state.position.accessory1.texture&&(i=i.concat(this.vertices.accessory1)),this.state.position.accessory2.texture&&(i=i.concat(this.vertices.accessory2)),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(i),gl.STATIC_DRAW)}return!0}},{key:"preRender",value:function(){var t;this.state.blinkingAnimation.run(),!this.state.walking||this.state.armed&&this.state.draw||this.state.punching||this.state.stabbing?this.state.punching||this.state.stabbing||this.state.walkingAnimation.end():this.state.walkingAnimation.run(),!this.state.punching||this.state.armed||this.state.melee||this.state.punchingAnimation.run(),(this.state.armed||this.state.melee&&!this.state.walking)&&this.state.draw&&!this.state.stabbing&&(this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]),this.state.stabbing&&this.state.melee&&!this.state.armed&&this.state.meleeAttackAnimation.run(),this.state.fire&&this.state.armed&&null!==(t=this.state.equippedItems.mainTool)&&void 0!==t&&t.loaded&&!this.state.reloadTimeout.reset&&this.inventory.weapons[this.state.equippedItems.mainTool.name].ammo&&this.state.fireAnimation.run(),this.state.armed&&this.state.equippedItems.mainTool&&this.state.recoilAnimation.run(),this.state.reloadTimeout.reset&&this.state.reloadTimeout.run(),this.state.pickup.current&&(this.state.position.body.texture=24),this.state.equippedItems.mainTool&&!$IS_MOBILE&&(this.state.draw=!0),this.movePickup()}},{key:"render",value:function(){gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,textures.skins.index[this.state.position.body.texture]),gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,textures.skins.index[this.state.position.eyes.texture]),gl.activeTexture(gl.TEXTURE2),gl.bindTexture(gl.TEXTURE_2D,textures.skins.index[this.state.position.accessory1.texture]),gl.activeTexture(gl.TEXTURE3),gl.bindTexture(gl.TEXTURE_2D,textures.skins.index[this.state.position.accessory2.texture]),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,24),this.nameObj.render()}},{key:"meleeAttack",value:function(t,e){var r=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(e.x,e.y,180*this.trans.rotation/Math.PI),2),s=r[0],i=r[1],a=$CURRENT_MAP;s+=this.trans.offsetX,i+=this.trans.offsetY;var n=e.width,o=e.height;for(var l in a.avatars){var h,c=a.avatars[l];Math.abs(s-c.trans.offsetX)<c.width/2+n/2&&Math.abs(i-c.trans.offsetY)<c.height/2+o/2&&(c.hit(t,this),"knife"===(null===(h=this.state.equippedItems.mainTool)||void 0===h?void 0:h.type)&&this.state.equippedItems.mainTool.degrade())}}},{key:"grab",value:function(){if(!this.state.pickup.current){var t=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,this.state.pickup.reachDistance,180*this.trans.rotation/Math.PI),2),e=t[0],r=t[1],s=this.state.hitboxes.pickup,i=s.width,a=s.height;for(var n in $CURRENT_MAP.moveables){var o=$CURRENT_MAP.moveables[n];if(Math.abs(e-o.trans.offsetX)<o.width/2+i/2&&Math.abs(r-o.trans.offsetY)<o.height/2+a/2)return o.moveToTop(),this.state.pickup.offset.x=o.trans.offsetX,this.state.pickup.offset.y=o.trans.offsetY,this.state.pickup.offset.aRotation=180*this.trans.rotation/Math.PI,this.state.pickup.offset.bRotation=o.trans.rotation,this.state.pickup.current=o,!0}}}},{key:"movePickup",value:function(){if(this.state.pickup.current){var t=this.state.pickup.current.trans,e=t.offsetX,r=t.offsetY,s=this.state.pickup.current,i=180*this.trans.rotation/Math.PI,a=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(this.state.pickup.offset.x,this.state.pickup.offset.y,i-this.state.pickup.offset.aRotation),2),n=a[0],o=a[1];s.translate(n-e,o-r,this.state.pickup.offset.bRotation+(this.state.pickup.offset.aRotation-i),!0)}}},{key:"drop",value:function(){this.state.pickup.current&&(this.state.pickup.current=void 0)}},{key:"respawn",value:function(){requestTransition(function(){this.state.vitals.health=100,updateHealthBar(),$CURRENT_MAP.avatars[this.id]=this,$CURRENT_MAP.obstacles[this.id]=this;var t=$CURRENT_MAP.GRAPH.getRandomPoint(),e=t.x,r=t.y,s=$CURRENT_MAP,i=s.centerX,a=s.centerY;$CURRENT_MAP.move=!0,$CURRENT_MAP.translate(e-i,r-a),noclip=!1,$MAP_DISPLAY.update()}.bind(this))}},{key:"clean",value:function(){this.state.goto.reserve&&this.map.GRAPH.reserved.splice(this.map.GRAPH.reserved.indexOf(this.state.goto.reserve),1)}},{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),Bot=function(){return _createClass((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unnamed Human",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,t),this.character=e,this.nameObj=new Text(e,25),this.nameObj.translate(r+0,s+10),this.vao=ext.createVertexArrayOES(),ext.bindVertexArrayOES(this.vao),this.vertices={body:[-7.0200000000000005,21.4,1,0,0,0,7.0200000000000005,21.4,1,.5484375,0,0,-7.0200000000000005,-21.4,1,0,.8359375,0,7.0200000000000005,21.4,1,.5484375,0,0,-7.0200000000000005,-21.4,1,0,.8359375,0,7.0200000000000005,-21.4,1,.5484375,.8359375,0],eyes:[-3.1,3.379999999999999,1,.153125,.351953125,1,3.1000000000000005,3.379999999999999,1,.3953125,.351953125,1,-3.1,1.4800000000000004,1,.153125,.3890625,1,3.1000000000000005,3.379999999999999,1,.3953125,.351953125,1,-3.1,1.4800000000000004,1,.153125,.3890625,1,3.1000000000000005,1.4800000000000004,1,.3953125,.3890625,1]},this.trans={offsetX:r||0,offsetY:s||0,rotation:i*Math.PI/180||0},this.width=8.56,this.height=8.56,this.obstacle=!0,this.segments=[[-4.08,-4.08,8.16,8.16]],this.bounds={width:this.height,height:this.height},this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.playerId=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(20),this.inventory=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.rI,this.type="avatar",this.name="avatar",this.state={hostile:!1,baseSpeed:1,runningSpeed:2,speed:1,strength:5,armour:0,relationship:0,agreeableness:(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(50),invinsible:!1,kills:0,passive:!1,aggressive:!1,hitboxes:{leftPunch:{x:-4,y:12,width:2,height:2},rightPunch:{x:4,y:12,width:2,height:2},knife:{x:5,y:14,width:4,height:4}},vitals:{health:100},goto:{x:0,y:0,target:{x:0,y:0},engaged:!1,reserve:void 0},path:{current:[],index:0,engaged:!1,start:void 0,end:void 0,request:!0},seat:{ref:void 0,id:void 0},targetId:void 0,target:{current:void 0,id:[],engaged:!1,shot:!0},wander:{active:!1,waiting:!1,rate:0,anchor:{x:0,y:0},radius:50},follow:{target:void 0,rush:!1,run:!1,engageDistance:100,slowdownDistance:50,settleDistance:30,disengageDistance:200},attack:{openCarry:!0,meleeAttackSpeed:.5,engageDistance:100,slowdownDistance:50,settleDistance:30,disengageDistance:200,attackSpeed:1,multiple:!1,forget:!1,invertTargets:!1,reactionTime:{targetUpdateRate:1,shotCheckRate:1}},baseRotation:0,walking:!1,punching:!1,stabbing:!1,running:!1,sitting:!1,armed:!1,melee:!1,draw:!1,fire:!1,equippedItems:{mainTool:void 0},rotationSpeed:.1,rotationTarget:void 0,wanderRateTimeout:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.state.wander.waiting=!1,this.state.speed=this.state.baseSpeed;var t=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(this.state.wander.radius,!0),e=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(this.state.wander.radius,!0);this.requestPath(this.state.wander.anchor.x+t-this.map.centerX,this.state.wander.anchor.y+e-this.map.centerY)}],this,[0]),rotationAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){var t=180*this.trans.rotation/Math.PI;if(Math.abs(t-this.state.rotationTarget)<=.1)return this.rotate(this.state.rotationTarget),void(this.state.rotationTarget=void 0);if(t!==this.state.rotationTarget){var e=Math.max(this.state.rotationTarget,t)-Math.min(this.state.rotationTarget,t),r=Math.min(e,360-e)*this.state.rotationSpeed;this.rotate((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.qT)(t+(e<180&&this.state.rotationTarget>t||e>180&&t>this.state.rotationTarget?r:-r)))}}),this,.01),punchingAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){var t=this.state.leftPunchAnimation,e=this.state.rightPunchAnimation;t.active?t.run():e.active&&e.run(),t.active||e.active||((Math.random()<.5?t:e).active=!0)}),this,.01),shotCheckAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){this.state.target.shot=!0;t:for(var t in this.map.obstacles){var e=this.map.obstacles[t];if(e.id!==this.id&&e.id!==this.state.target.current.id){var r,s=_createForOfIteratorHelper(e.segments);try{for(s.s();!(r=s.n()).done;){var i=_slicedToArray(r.value,4),a=i[0],n=i[1],o=i[2],l=i[3];a+=e.trans.offsetX,n+=e.trans.offsetY;var h=this.trans.offsetX,c=this.trans.offsetY,_=this.state.target.current.trans.offsetX,u=this.state.target.current.trans.offsetY,f=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.A_)(h,c,_,u,a,n,o,l);if(f){this.state.target.shot=!f;break t}}}catch(t){s.e(t)}finally{s.f()}}}}),this,1),reloadTimeout:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.state.equippedItems.mainTool.reloadProgress=0,this.state.equippedItems.mainTool.loaded=!0}],this,[0]),sittingTimeout:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.stopSitting()}],this,[0]),pathRequestRateLimit:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.state.path.request=!0}],this,[1]),targetUpdateAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){var t=this.map;if(this.state.attack.multiple){var e,r=this.state.attack.engageDistance,s=[];for(var i in t.avatars)if(t.avatars[i].id!==this.id){var a=t.avatars[i].trans,n=a.offsetX,o=a.offsetY,l=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.trans.offsetX,this.trans.offsetY,n,o);(this.state.target.id.includes(t.avatars[i].state.targetId)&&!this.state.attack.invertTargets||!this.state.target.id.includes(this.map.avatars[i].state.targetId)&&this.state.attack.invertTargets)&&(l<r&&t.avatars[i]!==this&&(r=l,e=t.avatars[i]),l<this.state.attack.disengageDistance&&this.state.attack.forget&&!s.includes(t.avatars[i].state.targetId)&&s.push(t.avatars[i].state.targetId))}this.state.attack.forget&&(this.state.target.id=s),e&&this.state.target.current!==e?(this.state.target.current=e,this.state.target.engaged=!0,this.state.hostile=!0):e||this.state.target.current||(this.state.target.engaged=!1,this.state.hostile=!1)}else if(t.avatars[this.state.target.id[0]]){var h=t.avatars[this.state.target.id[0]].trans,c=h.offsetX,_=h.offsetY,u=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.trans.offsetX,this.trans.offsetY,c,_);!this.state.target.engaged&&u<this.state.attack.engageDistance&&!this.state.attack.forget&&this.killTarget([this.state.target.id[0]])}}),this,1),gotoAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){var t=0,e=0;this.state.goto.x=this.state.goto.target.x-this.map.centerX,this.state.goto.y=this.state.goto.target.y-this.map.centerY,this.state.goto.x!==this.trans.offsetX&&(t=Math.abs(this.state.goto.x-this.trans.offsetX)<this.state.speed?this.state.goto.x-this.trans.offsetX:this.trans.offsetX<this.state.goto.x?this.state.speed:-this.state.speed),this.state.goto.y!==this.trans.offsetY&&(e=Math.abs(this.state.goto.y-this.trans.offsetY)<this.state.speed?this.state.goto.y-this.trans.offsetY:this.trans.offsetY<this.state.goto.y?this.state.speed:-this.state.speed),this.translate(t,e),this.state.goto.x===this.trans.offsetX&&this.state.goto.y===this.trans.offsetY&&this.disengageGoto()}),this,.03),fireAnimation:void 0,recoilAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.QF([function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[1]},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]}],this,[.05,.05],(function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]}),.5,!0),walkingAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[4]:2},function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[0]:0},function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[3]:3},function(){this.state.position.body.texture=this.state.draw&&this.state.melee?this.state.equippedItems.mainTool.constructor._properties.useTextures[0]:0}],this,[.08,.08,.08,.08],(function(){this.state.position.body.texture=0}),.5),leftPunchAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=0},function(){this.state.position.body.texture=10},function(){this.state.position.body.texture=11,this.meleeAttack(this.state.strength,this.state.hitboxes.leftPunch)},function(){this.state.position.body.texture=0}],this,[.08,.08,.08,.15],(function(){this.state.position.body.texture=0})),rightPunchAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=0},function(){this.state.position.body.texture=12},function(){this.state.position.body.texture=13,this.meleeAttack(this.state.strength,this.state.hitboxes.rightPunch)},function(){this.state.position.body.texture=0}],this,[.08,.08,.08,.15],(function(){this.state.position.body.texture=0})),meleeAttackAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[2],this.meleeAttack(this.state.equippedItems.mainTool.constructor._properties.damage+this.state.strength,this.state.hitboxes.knife)},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[1]},function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]}],this,[.08,.08,.08,.15],(function(){this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]})),blinkingAnimation:new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.bp([function(){this.state.position.eyes.texture=0},function(){this.state.position.eyes.texture=1},function(){this.state.position.eyes.texture=0}],this,[5*Math.random(),1,1]),position:{body:{texture:0},eyes:{texture:0}}},ext.bindVertexArrayOES(this.vao),this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,24,12),gl.vertexAttribPointer(locations.textrUnit,1,gl.FLOAT,!1,24,20),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.enableVertexAttribArray(locations.textrUnit),gl.disableVertexAttribArray(locations.offset),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([].concat(_toConsumableArray(this.vertices.body),_toConsumableArray(this.vertices.eyes))),gl.STATIC_DRAW),gl.useProgram(program)}),[{key:"translate",value:function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e,this.nameObj.translate(t,e),gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY])}},{key:"rotate",value:function(t){t=t*Math.PI/180,this.trans.rotation=t,gl.uniform1f(locations.rotation,this.trans.rotation)}},{key:"postLink",value:function(){this.state.wanderRateTimeout.timingConfig[0]=this.state.wander.rate,this.state.targetUpdateAnimation.rate=this.state.attack.reactionTime.targetUpdateRate,this.state.shotCheckAnimation.rate=this.state.attack.reactionTime.shotCheckRate,this.state.leftPunchAnimation.animationMultFactor=this.state.attack.meleeAttackSpeed,this.state.rightPunchAnimation.animationMultFactor=this.state.attack.meleeAttackSpeed,this.state.meleeAttackAnimation.animationMultFactor=2*this.state.attack.meleeAttackSpeed,this.state.fireAnimation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){this.state.recoilAnimation.start();var t=this.map,e=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,1,180*this.trans.rotation/Math.PI),2),r=e[0],s=e[1],i=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(this.state.equippedItems.mainTool.constructor._properties.accuracy||0);i=Math.random()<.5?-i:i;var a=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(r,s,i),2),n=a[0],o=a[1],l=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,this.state.equippedItems.mainTool.constructor._properties.nozzelLength,180*this.trans.rotation/Math.PI),2),h=l[0],c=l[1];t.link(new Bullet(h+this.trans.offsetX,c+this.trans.offsetY,180*this.trans.rotation/Math.PI+90,n*this.state.equippedItems.mainTool.constructor._properties.bulletSpeed,o*this.state.equippedItems.mainTool.constructor._properties.bulletSpeed,this.state.equippedItems.mainTool.constructor._properties.damage,this));var _=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(20,0,180*this.trans.rotation/Math.PI),2),u=_[0],f=_[1],d=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10),p=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(u,f,Math.random()<.5?-d:d),2),y=p[0],g=p[1],b=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(0,8,180*this.trans.rotation/Math.PI),2),m=b[0],v=b[1];t.link(new BulletShell(this.trans.offsetX+m,this.trans.offsetY+v,y,g)),this.inventory.weapons[this.state.equippedItems.mainTool.name].ammo--,this.state.equippedItems.mainTool.reloadProgress++,this.state.equippedItems.mainTool.reloadProgress===this.state.equippedItems.mainTool.constructor._properties.capacity&&(this.state.equippedItems.mainTool.loaded=!1)}),this,0)}},{key:"hit",value:function(t,e,r){if(!this.state.invinsible&&(this.state.armour>0?this.state.armour-=t:this.state.vitals.health-=t,this.state.vitals.health<=0)){var s=this.map.avatars[e.id];return s&&(s.state.kills+=1),s===$AVATAR&&($SCORE+=this.state.killValue,updateCombatStats()),this.purgeItems(5),this===$ACTIVE_DIALOGUE_PARTY&&endDialogue(),void this.delete()}!(this.state.passive||this.state.armed&&this.inventory.weapons[this.state.equippedItems.mainTool.name].ammo<=0)||this.state.running||this.state.follow.target||this===$ACTIVE_DIALOGUE_PARTY?!this.state.target.id.includes(e.state.targetId)&&this.map.avatars[e.id]&&this.state.aggressive&&(this.stopSitting(),this.state.target.id.push(e.state.targetId),this.state.target.engaged=!0,this.state.attack.multiple=!0):(this.stopSitting(),this.run())}},{key:"drawWeapon",value:function(){this.state.equippedItems.mainTool&&!this.state.stabbing&&(this.state.armed||this.state.melee)&&(this.state.draw=!0,this.state.walking&&this.state.melee||(this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]))}},{key:"holsterWeapon",value:function(){(this.state.armed||this.state.melee)&&(this.state.draw=!1,this.state.position.body.texture=0)}},{key:"reload",value:function(){this.state.reloadTimeout.start()}},{key:"wander",value:function(t,e){this.state.wander.anchor={x:this.state.wander.anchor.x||t,y:this.state.wander.anchor.y||e};var r=this.state.wander.anchor,s=r.x,i=r.y;s&&i&&(this.state.wander.active=!0)}},{key:"stopWander",value:function(){this.state.wander.active=!1,this.disengagePath()}},{key:"follow",value:function(t){this.state.speed=this.state.follow.run?this.state.runningSpeed:this.state.baseSpeed,this.state.follow.target=this.map.avatars[t]}},{key:"disengageFollow",value:function(){this.state.follow.target=void 0}},{key:"sit",value:function(t){if(!this.state.seat.ref&&!this.state.target.engaged&&!this.state.running){var e=Object.values(this.map.seats),r=t||e[(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(e.length)];if(!r)return!1;this.state.seat.ref=r}}},{key:"stopSitting",value:function(){if(this.state.seat.ref){if(this.state.sitting){var t=this.state.seat.ref.seats[this.state.seat.id];t.occupied=!1,this.state.sitting=!1;var e=this.map.GRAPH.getPoint(this.state.seat.ref.trans.offsetX+$MAP.centerX+t.exit.x,this.state.seat.ref.trans.offsetY+$MAP.centerY+t.exit.y),r=e.x,s=e.y;this.translate(r-(this.trans.offsetX+$MAP.centerX)+5,s-(this.trans.offsetY+$MAP.centerY)-5)}this.state.sittingTimeout.end(),this.state.seat.ref=void 0,this.state.seat.id=void 0}}},{key:"addItem",value:function(t,e){return this.inventory.addItem(t,e)}},{key:"dropItem",value:function(t){if(!this.inventory.items[t])return!1;this.unequipItem(t);var e=this.inventory.ejectItem(t);return e.dropped=!0,e.ring.trans.offsetX=e.trans.offsetX=this.trans.offsetX+(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10,!0),e.ring.trans.offsetY=e.trans.offsetY=this.trans.offsetY+(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10,!0),e.trans.rotation=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360),this.map.link(e),!0}},{key:"purgeItems",value:function(t){for(var e=0;e<t;e++)this.inventory.items[e]&&this.dropItem(e)}},{key:"equipItem",value:function(t){var e=this.inventory.items[t];if(e){switch(e.type){case"gun":this.state.armed=!0,this.state.melee=!1,this.state.equippedItems.mainTool=e,this.state.equippedItems.mainTool.reloadProgress=e.reloadProgress,this.state.equippedItems.mainTool.loaded=e.loaded,this.state.reloadTimeout.timingConfig[0]=this.state.equippedItems.mainTool.constructor._properties.reloadTime,this.state.fireAnimation.rate=.5/this.state.equippedItems.mainTool.constructor._properties.fireRate;break;case"knife":this.state.armed=!1,this.state.melee=!0,this.state.equippedItems.mainTool=e}return!0}return!1}},{key:"unequipItem",value:function(t){if(!this.inventory.items[t])return!1;var e=this.inventory.items[t];switch(e.type){case"gun":this.state.equippedItems.mainTool&&e.slot===this.state.equippedItems.mainTool.slot&&(this.state.armed=!1,this.state.draw=!1,this.state.equippedItems.mainTool=void 0);break;case"knife":this.state.melee=!1,this.state.draw=!1,this.state.stabbing=!1,this.state.equippedItems.mainTool=void 0}return!0}},{key:"preRender",value:function(){var t,e;this.state.blinkingAnimation.run(),"number"==typeof this.state.rotationTarget&&this.state.rotationAnimation.run(),!this.state.walking||this.state.armed&&this.state.draw||this.state.punching||this.state.stabbing?this.state.punching||this.state.stabbing||this.state.meleeAttackAnimation.active||this.state.walkingAnimation.end():this.state.walkingAnimation.run(),!this.state.punching||this.state.armed||this.state.melee||this.state.punchingAnimation.run(),(this.state.armed||this.state.melee&&!this.state.walking)&&this.state.draw&&!this.state.stabbing&&!this.state.meleeAttackAnimation.active&&(this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[0]),(this.state.stabbing||this.state.meleeAttackAnimation.active)&&!this.state.armed&&this.state.melee&&this.state.meleeAttackAnimation.run(),this.state.fire&&this.state.armed&&this.state.target.shot&&null!==(t=this.state.equippedItems.mainTool)&&void 0!==t&&t.loaded&&this.inventory.weapons[this.state.equippedItems.mainTool.name].ammo&&this.state.fireAnimation.run(),this.state.armed&&this.state.recoilAnimation.run(),null!==(e=this.state.equippedItems.mainTool)&&void 0!==e&&e.loaded||this.state.reloadTimeout.run(),this.state.goto.engaged&&this.state.gotoAnimation.run(),this.state.path.request||this.state.pathRequestRateLimit.run(),this.state.sitting&&this.state.sittingTimeout.run();t:if(this.state.path.engaged&&!this.state.goto.engaged){if(this.state.path.index===this.state.path.current.length){if(this.state.seat.ref&&void 0!==this.state.seat.id){var r=this.state.seat.ref.seats[this.state.seat.id];if(r.occupied){this.stopSitting();break t}this.translate(this.state.seat.ref.trans.offsetX+r.x-this.trans.offsetX,this.state.seat.ref.trans.offsetY+r.y-this.trans.offsetY),this.state.rotationTarget=void 0,this.trans.rotation=r.r*Math.PI/180,this.state.seat.ref.seats[r.id].occupied=!0,this.state.sitting=!0,this.state.sittingTimeout.timingConfig[0]=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(10),this.state.sittingTimeout.start()}this.disengagePath();break t}var s=this.state.path.current[this.state.path.index],i=s.x,a=s.y,n=this.map.GRAPH.find(i,a).id;if(this.map.GRAPH.blocked.includes(n)||this.map.GRAPH.reserved.includes(n)){this.disengagePath(),this.state.path.request&&this.requestPath(this.state.path.end.x-this.map.centerX,this.state.path.end.y-this.map.centerY);break t}this.state.goto.reserve=n,this.map.GRAPH.reserved.push(n),this.goto(i+5,a-5);var o=45*Math.round(180*Math.atan2(this.state.goto.y-this.trans.offsetY,this.state.goto.x-this.trans.offsetX)/Math.PI/45);this.state.rotationTarget=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.qT)(o-90),this.state.path.index++}this.state.target.id.length>0&&this.state.targetUpdateAnimation.run();t:if(this.state.target.current&&this.state.target.engaged){if(this.state.target.current&&!this.map.avatars[this.state.target.current.id]){this.disengageTarget(),this.state.melee&&(this.state.position.body.texture=this.state.equippedItems.mainTool.constructor._properties.useTextures[2]);break t}var l=this.state.target.current.trans,h=l.offsetX,c=l.offsetY,_=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.trans.offsetX,this.trans.offsetY,h,c),u=this.map;if(!this.state.armed&&!this.state.melee){_>this.state.attack.disengageDistance&&this.state.target.engaged?this.disengageTarget():_<=this.state.attack.engageDistance&&!this.state.path.engaged&&!this.state.follow.target&&this.state.path.request&&this.requestPath(h,c),this.state.speed=this.state.baseSpeed*this.state.attack.attackSpeed,_<=30?(this.state.punching=!0,this.state.rotationTarget=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.qT)(180*Math.atan2(c-u.centerY-(this.trans.offsetY-u.centerY),h-u.centerX-(this.trans.offsetX-u.centerX))/Math.PI-90)):this.state.punching=!1;break t}if(!this.state.armed&&this.state.melee){_>this.state.attack.disengageDistance&&this.state.target.engaged?this.disengageTarget():_<=this.state.attack.engageDistance&&(this.state.speed=this.state.baseSpeed*this.state.attack.attackSpeed,this.state.attack.openCarry&&!this.state.draw&&this.drawWeapon(),this.state.path.engaged||this.state.follow.target||!this.state.path.request||this.requestPath(h,c)),_<=30?(this.state.stabbing=!0,this.state.draw||this.drawWeapon(),this.state.rotationTarget=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.qT)(180*Math.atan2(c-u.centerY-(this.trans.offsetY-u.centerY),h-u.centerX-(this.trans.offsetX-u.centerX))/Math.PI-70)):(this.state.stabbing=!1,!this.state.attack.openCarry&&this.state.draw&&this.holsterWeapon());break t}if(this.state.armed&&this.inventory.weapons[this.state.equippedItems.mainTool.name].ammo>0){var f;if(null!==(f=this.state.equippedItems.mainTool)&&void 0!==f&&f.loaded||this.state.reloadTimeout.running||this.reload(),this.state.shotCheckAnimation.run(),_>this.state.attack.disengageDistance&&this.state.target.engaged?this.disengageTarget():_>this.state.attack.engageDistance?(this.state.speed=this.state.baseSpeed*this.state.attack.attackSpeed,this.state.fire=!1,!this.state.attack.openCarry&&this.state.draw&&this.holsterWeapon(),this.state.path.engaged||this.state.follow.target||!this.state.path.request||this.requestPath(h,c)):_<this.state.attack.settleDistance?(this.state.target.shot&&this.state.path.engaged&&!this.state.follow.target&&_>=30&&this.disengagePath(),this.state.rotationTarget=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.qT)(180*Math.atan2(c-u.centerY-(this.trans.offsetY-u.centerY),h-u.centerX-(this.trans.offsetX-u.centerX))/Math.PI-90),this.state.draw||this.drawWeapon(),this.state.target.shot&&(this.state.fire=!0)):_<this.state.attack.slowdownDistance?(this.state.rotationTarget=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.qT)(180*Math.atan2(c-u.centerY-(this.trans.offsetY-u.centerY),h-u.centerX-(this.trans.offsetX-u.centerX))/Math.PI-90),this.state.draw||this.drawWeapon(),this.state.target.shot&&(this.state.fire=!0),this.state.follow.rush&&this.state.follow.target||(this.state.speed=this.state.baseSpeed*(this.state.attack.attackSpeed/3))):_<this.state.attack.engageDistance&&(this.state.speed=this.state.baseSpeed*this.state.attack.attackSpeed,this.state.rotationTarget=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.qT)(180*Math.atan2(c-u.centerY-(this.trans.offsetY-u.centerY),h-u.centerX-(this.trans.offsetX-u.centerX))/Math.PI-90),this.state.draw||this.drawWeapon(),this.state.target.shot&&(this.state.fire=!0),this.state.path.engaged||this.state.follow.target||!this.state.path.request||this.requestPath(h,c)),this.state.target.shot||!this.state.path.request||this.state.path.engaged||this.state.follow.target||this.requestPath(h,c),_<30&&!this.state.follow.target&&(this.state.speed=this.state.baseSpeed*this.state.attack.attackSpeed,this.state.path.request&&!this.state.path.engaged)){var d=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(h,c+30,(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(360)),2),p=d[0],y=d[1];this.requestPath(p,y)}break t}this.disengageTarget()}if(this.state.follow.target&&!this.state.seat.ref){var g=this.state.follow.target.trans,b=g.offsetX,m=g.offsetY,v=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.trans.offsetX,this.trans.offsetY,b,m),A=this.state.follow.run?this.state.runningSpeed*this.state.baseSpeed:this.state.baseSpeed;v>this.state.follow.settleDistance&&(this.state.speed=A,this.state.path.engaged||this.state.path.request&&!$AVATAR.state.seat.ref&&this.requestPath(b,m)),v<this.state.follow.slowdownDistance&&v>this.state.settleDistance?this.state.speed=A/3:v<this.state.follow.settleDistance&&this.state.path.engaged&&this.disengagePath()}!this.state.wander.active||this.state.running||this.state.seat.ref||(this.state.target.engaged||this.state.wanderRateTimeout.run(),this.state.path.engaged||!this.state.path.request||this.state.wander.waiting||(this.state.wander.waiting=!0,this.state.wanderRateTimeout.start()));t:if(this.state.seat.ref&&!this.state.sitting&&!this.state.path.engaged&&this.state.path.request){var P,x;if(void 0===this.state.seat.id){if(!(x=(P=this.state.seat.ref).getSeat(this))){this.stopSitting();break t}this.state.seat.id=x.id}P=this.state.seat.ref,x=this.state.seat.ref.seats[this.state.seat.id],this.requestPath(P.trans.offsetX+x.exit.x,P.trans.offsetY+x.exit.y)}}},{key:"render",value:function(){gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,textures.skins.index[this.state.position.body.texture]),gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,textures.skins.index[this.state.position.eyes.texture]),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,12),this.nameObj.render()}},{key:"goto",value:function(t,e){this.state.goto.x=t-this.map.centerX,this.state.goto.y=e-this.map.centerY,this.state.goto.target={x:t,y:e},this.state.goto.engaged=!0,this.state.walking=!0}},{key:"disengageGoto",value:function(){this.state.goto.engaged=!1,this.state.walking=!1,this.state.goto.reserve&&this.map.GRAPH.reserved.splice(this.map.GRAPH.reserved.indexOf(this.state.goto.reserve),1)}},{key:"killTarget",value:function(t,e,r){var s=this.map.avatars[t[0]];return this.state.attack.multiple=e,this.state.attack.invertTargets=r,t.includes($AVATAR.id)&&(this.state.hostile=!0),s&&!this.state.attack.multiple?(this.state.target.current=s,this.state.target.id=t,this.state.target.engaged=!0,this.stopSitting(),!0):!!this.state.attack.multiple&&(this.state.target.id=t,this.state.target.engaged=!0,this.stopSitting(),!0)}},{key:"disengageTarget",value:function(){this.state.target.engaged=!1,this.state.target.current=void 0,this.state.fire=!1,this.state.stabbing=!1,this.state.punching=!1,this.state.hostile=!1,this.state.attack.openCarry?this.drawWeapon():this.holsterWeapon()}},{key:"run",value:function(){var t={x:(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(this.map.width/2,!0),y:(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(this.map.height/2,!0)};t&&(this.state.speed=this.state.runningSpeed*this.state.baseSpeed,this.state.path.request&&this.requestPath(t.x-this.map.centerX,t.y-this.map.centerY)&&(this.state.running=!0))}},{key:"meleeAttack",value:function(t,e){var r=_slicedToArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.e$)(e.x,e.y,180*this.trans.rotation/Math.PI),2),s=r[0],i=r[1],a=this.map;s+=this.trans.offsetX,i+=this.trans.offsetY;var n=e.width,o=e.height;for(var l in a.avatars){var h=a.avatars[l];Math.abs(s-h.trans.offsetX)<h.width/2+n/2&&Math.abs(i-h.trans.offsetY)<h.height/2+o/2&&h.hit(t,this)}}},{key:"requestPath",value:function(t,e){t+=this.map.centerX,e+=this.map.centerY,this.state.path.request=!1,this.state.pathRequestRateLimit.start();var r=this.map.GRAPH.getPoint(this.trans.offsetX+this.map.centerX,this.trans.offsetY+this.map.centerY),s=this.map.GRAPH.getPoint(t,e);return!!(t>=-this.map.width/2&&t<this.map.width/2&&e<=this.map.height/2&&e>-this.map.height/2&&r&&s)&&(this.state.path.start=r,this.state.path.end=s,pathfinder.requestPath(this,this.state.path.start.unit,this.state.path.end.unit),!0)}},{key:"findPathTo",value:function(t){return t.result&&this.state.path.start&&(this.state.path.current=t.path,this.state.path.index=0,this.state.path.engaged=!0),!this.state.seat.ref||void 0===this.state.seat.id||t.result&&!this.map.GRAPH.blocked.includes(this.state.path.end.unit)||this.stopSitting(),t}},{key:"disengagePath",value:function(){this.state.path.current=[],this.state.path.index=0,this.state.path.engaged=!1,this.state.running=!1,this.disengageGoto()}},{key:"clean",value:function(){this.state.goto.reserve&&this.map.GRAPH.reserved.splice(this.map.GRAPH.reserved.indexOf(this.state.goto.reserve),1),this.state.seat.ref&&void 0!==this.state.seat.id&&(this.state.seat.ref.seats[this.state.seat.id].occupied=!1)}},{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),Floor=function(t){function e(t,r,s,i){var a,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return _classCallCheck(this,e),(a=_callSuper(this,e,[[],function(){var t=e._tileTypes[n];this.vertices=t.vertices,this.texture=t.texture,this.width=s,this.height=i,this.tileType=n,this.renderDimensions={width:s/t.width,height:i/t.height},this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.textrUnit),gl.useProgram(program)},function(){ext.bindVertexArrayOES(this.vao),gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform2fv(locations.size,[this.renderDimensions.width,this.renderDimensions.height]),gl.uniform2fv(locations.textureRange,[this.renderDimensions.width,this.renderDimensions.height]),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,this.vertices.length/5),gl.uniform2fv(locations.size,[1,1]),gl.uniform2fv(locations.textureRange,[0,0])},s,i,t,r,0])).name="floor",a.type="floor",a.bottomLayer=!0,a.subLayer=1,a}return _inherits(e,t),_createClass(e)}(_Object_);_defineProperty(Floor,"_tileTypes",{0:{vertices:[-6.390000000000001,6.390000000000001,1,0,0,6.390000000000001,6.390000000000001,1,.9984375000000001,0,-6.390000000000001,-6.390000000000001,1,0,.9984375000000001,6.390000000000001,6.390000000000001,1,.9984375000000001,0,-6.390000000000001,-6.390000000000001,1,0,.9984375000000001,6.390000000000001,-6.390000000000001,1,.9984375000000001,.9984375000000001],width:12.780000000000001,height:12.780000000000001,texture:textures.objects.floortile},1:{vertices:[-6.390000000000001,6.390000000000001,1,0,0,6.390000000000001,6.390000000000001,1,.9984375000000001,0,-6.390000000000001,-6.390000000000001,1,0,.9984375000000001,6.390000000000001,6.390000000000001,1,.9984375000000001,0,-6.390000000000001,-6.390000000000001,1,0,.9984375000000001,6.390000000000001,-6.390000000000001,1,.9984375000000001,.9984375000000001],width:12.780000000000001,height:12.780000000000001,texture:textures.objects.woodfloortile},2:{vertices:[-6.390000000000001,6.390000000000001,1,0,0,6.390000000000001,6.390000000000001,1,.9984375000000001,0,-6.390000000000001,-6.390000000000001,1,0,.9984375000000001,6.390000000000001,6.390000000000001,1,.9984375000000001,0,-6.390000000000001,-6.390000000000001,1,0,.9984375000000001,6.390000000000001,-6.390000000000001,1,.9984375000000001,.9984375000000001],width:25.6,height:25.6,texture:textures.objects.crosstile}});var Barrier=function(){return _createClass((function t(e,r,s,i){_classCallCheck(this,t),this.segments=[[0,-i,s,i]],this.trans={offsetX:0,offsetY:0},this.width=s,this.height=i,this.obstacle=!0,this.isValid=!0,this.name="invisible barrier",this.type="barrier",this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.hideFromMap=!0,this.translate=function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e},this.translate(e,r)}),[{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),VisibleBarrier=function(t){function e(t,r,s,i){var a,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[40,40,40,1];return _classCallCheck(this,e),(a=_callSuper(this,e,[[],function(){this.vertices=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Jj)([[-s/2,-i/2,s,i]],!1,[1],!0),this.width=s,this.height=i,this.color=n,this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,12,0),gl.enableVertexAttribArray(locations.coords),gl.disableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.textrUnit),gl.useProgram(program)},function(){ext.bindVertexArrayOES(this.vao),gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),gl.uniform4fv(locations.color,_toConsumableArray((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Wg)(this.color))),gl.uniform1i(locations.lines,1),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,this.vertices.length/3),gl.uniform1i(locations.lines,0),gl.uniform4fv(locations.color,[0,0,0,0])},s,i,t,r,0])).segments=[[-s/2,-i/2,s,i]],a.obstacle=!0,a.name="visible barrier",a.type="barrier",a}return _inherits(e,t),_createClass(e,[{key:"delete",value:function(){this.map.unlink(this.id)}}])}(_Object_),Sensor=function(t){function e(t,r,s,i,a){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,[t,r,s,i])).action=a,n.isValid=!0,n.name="sensor",n.type="sensor",n.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),n}return _inherits(e,t),_createClass(e,[{key:"delete",value:function(){this.map.unlink(this.id)}}])}(Barrier),Trigger=function(){return _createClass((function t(e,r,s){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,t),this.segments=[[-2.5,-2.5,2.5,2.5]],this.trans={offsetX:0,offsetY:0},this.width=5,this.height=5,this.interactable=!0,this.minDistance=10,this.isValid=!0,this.managedMovement=i,this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.action=s.bind(this),this.name="trigger",this.type="trigger",this.exclude=!0,this.translate=function(t,e){this.trans.offsetX+=t,this.trans.offsetY+=e},this.translate(e,r)}),[{key:"delete",value:function(){this.map.unlink(this.id)}}])}(),_Graph_=function(){return _createClass((function t(e,r){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.width=e,this.height=r,this.nodeCount=e*r,this.diagonal=s,this.blocked=[],this.reserved=[],this.grid=new Map,this.find=function(t,e){return this.grid.get("".concat(t,",").concat(e))}.bind(this);var i=_createClass((function t(e,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];_classCallCheck(this,t),this.position={x:e,y:r},this.f=0,this.g=0,this.h=0,this.id=void 0,this.edges=s,this.parent=void 0,this.fresh=!0}));this.nodes={};for(var a,n=0,o=0,l=1;l<=this.nodeCount;l++)(a=new i(10*(n-e/2),-10*(o-r/2))).id=l,this.nodes[l]=a,this.grid.set("".concat(10*(n-e/2),",").concat(-10*(o-r/2)),a),n>0&&a.edges.push(a.id-1),n<this.width-1&&a.edges.push(a.id+1),o>0&&a.edges.push(a.id-e),o<this.height-1&&a.edges.push(a.id+e),this.diagonal&&(n>0&&o>0&&a.edges.push(a.id-e-1),n<e-1&&o>0&&a.edges.push(a.id-e+1),o<r-1&&n<e-1&&a.edges.push(a.id+e+1),o<r-1&&n>0&&a.edges.push(a.id+e-1)),n===e-1?(n=0,o++):n++}),[{key:"getPath",value:function(t,e){var r=this;function s(t,e,r,s){return Math.abs(t-r)+Math.abs(e-s)}if(this.blocked.includes(e))return!1;for(var i,a,n,o,l,h=t,c=e,_=[t],u=[],f={result:!1,path:[]};_.length>0;){if(i=_.reduce((function(t,e){return r.nodes[e].f<t.f||r.nodes[e].f===t.f&&r.nodes[e].h<t.h?r.nodes[e]:t}),{f:1/0,h:1/0}),_.splice(_.indexOf(i.id),1),u.push(i.id),i.id===c){for(var d=i;d.id!==h&&(d=this.nodes[d.parent]).id!==h;)f.path.unshift(d.position);f.path.push(i.position),f.result=!0;break}var p,y=_createForOfIteratorHelper(i.edges);try{for(y.s();!(p=y.n()).done;){var g=p.value,b=this.nodes[g];if(void 0!==b){var m={g:i.g+(a=b.position.x,n=b.position.y,o=i.position.x,l=i.position.y,Math.sqrt(Math.pow(o-a,2)+Math.pow(l-n,2))),h:s(b.position.x,b.position.y,this.nodes[c].position.x,this.nodes[c].position.y)};m.f=m.g+m.h,this.blocked.includes(b.id)||u.includes(b.id)||(void 0===b.parent||!0===b.fresh||m.f<b.f)&&(b.parent=i.id,b.f=m.f,b.g=m.g,b.h=m.h,_.includes(b.id)||_.push(b.id))}}}catch(t){y.e(t)}finally{y.f()}i.f=0,i.h=0,i.g=0,i.fresh=!0}return f}},{key:"getFixedCoordinate",value:function(t,e){return{x:this.width%2==0?10*Math.floor(.1*t):10*Math.round(.1*t)-5,y:this.height%2==0?10*Math.ceil(.1*e):e%5==0&&e%2!=0?10*Math.round(.1*e)-5:10*Math.round(.1*e)+5}}},{key:"getPoint",value:function(t,e){var r=this.getFixedCoordinate(t,e),s=this.find(r.x,r.y);return!!s&&{x:r.x,y:r.y,unit:s.id}}},{key:"getRandomPoint",value:function(){for(var t=!1;!t||this.blocked.includes(t.id)&&this.blocked.length!==this.nodeCount;)t=this.nodes[(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)(this.nodeCount)||1];return t?{x:t.position.x,y:t.position.y}:t}},{key:"evalObstacle",value:function(t,e,r,s){var i=(t=Math.round(t))+r,a=(e=Math.round(e))+s,n=this.getFixedCoordinate(t,e),o=this.getFixedCoordinate(i,e),l=this.getFixedCoordinate(i,a);if(!(Math.abs(t+r/2)<this.map.width/2+r/2&&Math.abs(e+s/2)<this.map.height/2+s/2))return!1;for(var h=n.x;h<=o.x;h+=10)for(var c=o.y;c<=l.y;c+=10){var _=this.find(h,c);_&&this.blocked.push(_.id)}return!0}}])}(),_Map_=function(){function _Map_(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Unnamed Area";for(var i in _classCallCheck(this,_Map_),this.width=t,this.height=e,this.name=s,this.id=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.x9)(),this.root=r,this.objectCount=0,this.avatarCount=0,this.lighting=!1,this.spawnPoints=[],this.centerX=0,this.centerY=0,this.groundColor=r?[215,215,215,1]:[255,255,255,1],this.show=!0,this.freeze=!1,this.move=!0,this.objectSearchStride=r?4:5,this.darkness=1,this.units={width:t/10,height:e/10,total:t/10*(e/10)},this.objects={},this.avatars={},this.obstacles={},this.moveables={},this.locations={},this.clusters={},this.seats={},this.subLayers={1:[],2:[],3:[],4:[],5:[],6:[]},this.interactables={},this.GRAPH=new _Graph_(this.units.width,this.units.height,!0),this.GRAPH.map=this,this.SUB_MAP_COUNT=0,this.SUB_MAPS={},this.PARENT_MAP=void 0,this.mapId=void 0,this.pickups={},this.CARRY=void 0,this.barriers=r?[new Barrier(-t/2,e/2+20,t,20),new Barrier(-t/2,-e/2,t,20),new Barrier(-t/2-20,e/2,20,e),new Barrier(t/2,e/2,20,e)]:[new VisibleBarrier(-t/2-125,0,250,e+10),new VisibleBarrier(0,-e/2-125,t+500,250),new VisibleBarrier(t/2+125,0,250,e+10),new VisibleBarrier(0,e/2+125,t+500,250),new VisibleBarrier(0,e/2+12,t,24,[70,70,70,1])],this.barriers)this.barriers[i].exclude=!0,this.link(this.barriers[i]);this.groundPlate=new VisibleBarrier(0,0,500,500,this.groundColor),_Map_._all[this.id]=this,pathfinder.registerMap(this)}return _createClass(_Map_,[{key:"render",value:function(){if(gl.uniform1f(locations.scale,1),this.groundPlate.render(),gl.uniform1f(locations.scale,scale),gl.uniform1f(locations.darkness,this.darkness+globalDarkness),_Map_.spectating.active&&(_Map_.spectating.avatar||(_Map_.spectating.avatar=$CURRENT_MAP.avatars[(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.yT)($CURRENT_MAP.avatarCount)]),_Map_.spectating.avatar)){var t=_Map_.spectating.avatar.trans,e=t.x,r=t.y;for(var s in this.objects)this.objects[s]!==_Map_.spectating.avatar&&(this.objects[s].managedMovement||this.objects[s].translate(-e,-r),updateCoordsDisplay())}for(var i in _Map_._recording.isRecording&&_Map_._recording.recording.push($CURRENT_MAP.centerX,$CURRENT_MAP.centerY,180*$AVATAR.trans.rotation/Math.PI,$AVATAR.state.walking),this.updateGraph(),this.renderBottomLayer(),this.objects){var a=this.objects[i];a.preRender&&!this.freeze&&a.preRender(),a instanceof Barrier||a instanceof Trigger||a instanceof Bot||a.bottomLayer||a.topLayer||a.hasCluster||a.hidden||a.subLayer||!this.show||a.render()}for(var n in this.show&&this.renderSubLayers(),this.avatars){var o=this.avatars[n];o.preRender&&!this.freeze&&o.preRender(),this.show&&o.render()}}},{key:"renderTopLayer",value:function(){if(this.show){for(var t in this.objects){var e=this.objects[t];e instanceof Barrier||e instanceof Trigger||e instanceof Bot||e.bottomLayer||!e.topLayer||e.hasCluster||e.hidden||e.subLayer||e.render()}this.renderSubLayers("topLayer"),this._lineMatrix.hidden||this._lineMatrix.render()}}},{key:"renderBottomLayer",value:function(){if(this.show)for(var t in this.renderSubLayers("bottomLayer"),this.objects){var e=this.objects[t];e instanceof Barrier||e instanceof Trigger||e instanceof Bot||e.topLayer||!e.bottomLayer||e.hasCluster||e.hidden||e.subLayer||e.render()}}},{key:"renderSubLayers",value:function(t){for(var e in this.subLayers){var r,s=_createForOfIteratorHelper(this.subLayers[e]);try{for(s.s();!(r=s.n()).done;){var i=r.value;i instanceof Barrier||i instanceof Trigger||i instanceof Bot||!i[t]&&(t||i.bottomLayer||i.topLayer)||i.hasCluster||i.hidden||i.render()}}catch(t){s.e(t)}finally{s.f()}}}},{key:"link",value:function(t){if(!(t.render||t.hasCluster||t.isValid))return"invalid object.";if(t.hasCluster)switch(t.clusterType){case _StaticCluster_:if(!this.clusters[t.clusterName]){var e=new t.clusterType(t.texture,t.topLayer);e.bottomLayer=t.bottomLayer,e.topLayer=t.topLayer,e.subLayer=t.subLayer,this.registerCluster(t.clusterName,e)}t.cluster=this.clusters[t.clusterName],t.clusterIndex=this.clusters[t.clusterName].link(t.constructor._defaultVertices,-this.clusters[t.clusterName].trans.offsetX+t.trans.offsetX,-this.clusters[t.clusterName].trans.offsetY+t.trans.offsetY,t.trans.rotation);break;case _InstancedCluster_:if(!this.clusters[t.clusterName]){var r=new t.clusterType(t.constructor._defaultVertices,t.texture,"light"===t.type);r.bottomLayer=t.bottomLayer,r.topLayer=t.topLayer,r.subLayer=t.subLayer,this.registerCluster(t.clusterName,r)}t.cluster=this.clusters[t.clusterName],t.clusterIndex=this.clusters[t.clusterName].link(-this.clusters[t.clusterName].trans.offsetX+t.trans.offsetX,-this.clusters[t.clusterName].trans.offsetY+t.trans.offsetY,t.trans.rotation);break;case _MixedStaticCluster_:if(!this.clusters[t.clusterName]){var s=new t.clusterType(_MixedStaticCluster_.groupings[t.grouping]);s.bottomLayer=t.bottomLayer,s.topLayer=t.topLayer,s.subLayer=t.subLayer,this.registerCluster(t.clusterName,s)}t.cluster=this.clusters[t.clusterName],t.clusterIndex=this.clusters[t.clusterName].link(t.constructor._defaultVertices,-this.clusters[t.clusterName].trans.offsetX+t.trans.offsetX,-this.clusters[t.clusterName].trans.offsetY+t.trans.offsetY,t.trans.rotation)}if(t.preLink&&t.preLink(),t.map=this,t.index=this.objectCount,this.objects[t.id]=t,t.obstacle&&(this.obstacles[t.id]=t,$MAP_DISPLAY&&"avatar"!==t.type&&!t.hideFromMap&&$CURRENT_MAP===this&&$MAP_DISPLAY.addObject(t)),t.pickup&&(this.pickups[t.id]=t),t.moveable&&(this.moveables[t.id]=t),"seat"===t.type&&(this.seats[t.id]=t),t.interactable&&(this.interactables[t.id]=t),"avatar"===t.type&&(this.avatars[t.id]=t,this.avatarCount++),t.subLayer&&!t.hasCluster&&this.subLayers[t.subLayer].push(t),t.linked=!0,t.postLink&&t.postLink(),t.obstacle){var i,a=_createForOfIteratorHelper(t.segments);try{for(a.s();!(i=a.n()).done;){var n=i.value;this.GRAPH.evalObstacle(n[0]+t.trans.offsetX+this.centerX,n[1]+t.trans.offsetY+this.centerY,n[2],n[3])}}catch(t){a.e(t)}finally{a.f()}}this.objectCount++}},{key:"unlink",value:function(t){if(!this.objects[t])return"that object dosen't exist.";var e=this.objects[t];if(e.linked=!1,this.objects[t].clean&&this.objects[t].clean(),this.objects[t].hasCluster&&!this.objects[t].preserveCluster&&(this.objects[t].cluster.unlink(this.objects[t].clusterIndex),this.objects[t].cluster=void 0),this.objects[t].pickup||(this.objects[t].map=void 0),"avatar"===this.objects[t].type&&this.avatarCount--,e.subLayer&&!e.hasCluster){var r=this.subLayers[e.subLayer];r.splice(r.indexOf(e),1)}if(delete this.interactables[t],delete this.objects[t],delete this.pickups[t],delete this.avatars[t],delete this.seats[t],this.obstacles[t]){var s=this.obstacles[t];delete this.obstacles[t],s.hideFromMap||$CURRENT_MAP!==this||$MAP_DISPLAY.update()}this.objectCount--}},{key:"locateObject",value:function(t){var e,r,s=1e3;for(var i in this.objects)(i=this.objects[i]).constructor.name===t&&(r=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(i.trans.offsetX,i.trans.offsetY,0,0))<s&&(s=r,e=i);return e}},{key:"updateGraph",value:function(){for(var t in this.GRAPH.blocked=[],this.obstacles){var e=this.obstacles[t];if(!e.passable){var r,s=_createForOfIteratorHelper(e.segments);try{for(s.s();!(r=s.n()).done;){var i=r.value;this.GRAPH.evalObstacle(i[0]+e.trans.offsetX+this.centerX,i[1]+e.trans.offsetY+this.centerY,i[2],i[3])}}catch(t){s.e(t)}finally{s.f()}}}}},{key:"getObject",value:function(t){return Object.values(this.objects)[t+this.objectSearchStride]}},{key:"translateCluster",value:function(t,e,r,s){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=r;a<Object.keys(this.objects).length-1&&(i.includes(a)||this.getObject(a).isCluster||(this.getObject(a).translate(t,e,!0),a!==s));a++);return"cluster translated."}},{key:"printLayoutScript",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r={layout:[],settings:{groundColor:this.groundColor,lighting:this.lighting,darkness:this.darkness},root:this.root,nodes:this.SUB_MAP_COUNT,children:[]},s=Object.keys(this.objects),i=e;i<this.objectCount;i++){var a=this.objects[s[i]];if(!(a instanceof Barrier||a.isCluster||a.exclude)){var n=[a.constructor.name],o=a.trans.offsetX+this.centerX,l=a.trans.offsetY+this.centerY;switch(a.name){case"avatar":n=n.concat([a.character,o,l,a.trans.rotation*(180/Math.PI)]);break;case"text":n=n.concat([a.text,a.size,(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.$)(a._color),o,l,a.trans.rotation*(180/Math.PI),!1]);break;case"door":n=n.concat([a.text,a.roomIndex,o,l,a.trans.rotation*(180/Math.PI),a.outPoint]);break;case"visible barrier":n=n.concat([o,l,a.width,a.height,a.color]);break;case"street light":n=n.concat([o,l,a.trans.rotation,a._color]);break;case"floor":n=n.concat([o,l,a.width,a.height,a.tileType]);break;default:n=n.concat([o,l,a.trans.rotation])}r.layout.push(n)}}for(var h in this.SUB_MAPS)r.children.push(this.SUB_MAPS[h].printLayoutScript(!1));return t?JSON.stringify(r):r}},{key:"parseLayoutScript",value:function parseLayoutScript(layout){var json=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(layout){var objects=json?JSON.parse(layout):layout,objs=objects.layout,children=objects.children,settings=objects.settings;settings&&(this.lighting=settings.lighting,this.groundColor=settings.groundColor,this.groundPlate.color=this.groundColor,this.darkness=settings.darkness);var _iterator20=_createForOfIteratorHelper(objs),_step20;try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var _i4=_step20.value,attribs=_i4.slice(1,_i4.length),ob=_construct(eval("".concat(_i4[0])),_toConsumableArray(attribs));this.link(ob)}}catch(t){_iterator20.e(t)}finally{_iterator20.f()}for(var i=0;i<objects.nodes;i++)this.SUB_MAPS[i].parseLayoutScript(objects.children[i],!1);return"parsed layout."}}},{key:"translate",value:function(t,e){if(this.move){if(!noclip)for(var r in this.obstacles)if(this.obstacles[r]!==$AVATAR.state.pickup.current&&this.obstacles[r]!==$AVATAR&&!this.obstacles[r].passable){var s,i=_createForOfIteratorHelper(this.obstacles[r].segments);try{for(i.s();!(s=i.n()).done;){var a=_slicedToArray(s.value,4),n=a[0],o=a[1],l=a[2],h=a[3];if(n+=this.obstacles[r].trans.offsetX,n+=l/2,o+=this.obstacles[r].trans.offsetY,o+=h/2,Math.round(Math.abs($AVATAR.trans.offsetY-o))<Math.round($AVATAR.bounds.height/2+h/2)&&Math.abs($AVATAR.trans.offsetX-(n-t))<$AVATAR.bounds.width/2+l/2)if(this.obstacles[r]instanceof Sensor)this.obstacles[r].action();else{var c=t<0;t+=Math.abs($AVATAR.trans.offsetX-n)-($AVATAR.bounds.width/2+l/2+t),t=c?-t:t}if(Math.round(Math.abs($AVATAR.trans.offsetX-n))<Math.round($AVATAR.bounds.width/2+l/2)&&Math.abs($AVATAR.trans.offsetY-(o-e))<$AVATAR.bounds.height/2+h/2)if(this.obstacles[r]instanceof Sensor)this.obstacles[r].action();else{var _=e<0;e+=Math.abs($AVATAR.trans.offsetY-o)-($AVATAR.bounds.height/2+h/2+e),e=_?-e:e}}}catch(t){i.e(t)}finally{i.f()}}for(var u in this.centerX+=t,this.centerY+=e,this.CARRY&&this.CARRY.translate(t,e,0,!0),this.objects)this.objects[u].managedMovement||this.objects[u].translate(-t,-e);this._lineMatrix.translate(-t,-e),this.updateInteractable(),updateCoordsDisplay()}}},{key:"record",value:function(){if(_Map_._recording.isRecording){var t=_Map_._recording.recording;return _Map_._recording.isRecording=!1,_Map_._recording.recording=[],JSON.stringify(t)}return _Map_._recording.isRecording=!0,"recording..."}},{key:"pause",value:function(){_Map_._recording.isRecording=!1}},{key:"resume",value:function(){_Map_._recording.isRecording=!0}},{key:"getRecording",value:function(){var t=_Map_._recording.recording;return _Map_._recording.isRecording=!1,_Map_._recording.recording=[],JSON.stringify(t)}},{key:"registerCluster",value:function(t,e){this.clusters[t]=e,this.link(e),e.linked=!0}},{key:"updateInteractable",value:function(){for(var t in this.currentInteractable=void 0,this.interactables)t=this.interactables[t],(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)($AVATAR.trans.offsetX,$AVATAR.trans.offsetY,t.trans.offsetX,t.trans.offsetY)<t.minDistance&&(this.currentInteractable=t);this.currentInteractable?document.querySelector(".action-button").style.opacity="1":document.querySelector(".action-button").style.opacity="0.5"}},{key:"showGeometry",value:function(){this._lineMatrix.hidden=!1}},{key:"hideGeometry",value:function(){this._lineMatrix.hidden=!0}},{key:"addSubMap",value:function(t){t.PARENT_MAP=this,t.mapId=this.SUB_MAP_COUNT++,this.SUB_MAPS[String(t.mapId)]=t}},{key:"deleteSubMap",value:function(t){delete this.SUB_MAPS[t],this.SUB_MAP_COUNT--}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0]],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this._bulletMatrix=new _BulletCluster_([-.9,.4,1,0,0,.9,.4,1,.5625,0,-.9,-.4,1,0,.5,.9,.4,1,.5625,0,-.9,-.4,1,0,.5,.9,-.4,1,.5625,.5],textures.objects.bullet),this.link(this._bulletMatrix),this._lineMatrix=new _LineMatrix_,this._lineMatrix.hidden=!0,this._lineMatrix.showShot([-this.width/2,-this.height/2],[this.width/2,-this.height/2]),this._lineMatrix.showShot([-this.width/2,-this.height/2],[-this.width/2,this.height/2]),this._lineMatrix.showShot([-this.width/2,this.height/2],[this.width/2,this.height/2]),this._lineMatrix.showShot([this.width/2,this.height/2],[this.width/2,-this.height/2]),this._lineMatrix.showShot([-2.5,-2.5],[2.5,-2.5]),this._lineMatrix.showShot([-2.5,-2.5],[-2.5,2.5]),this._lineMatrix.showShot([-2.5,2.5],[2.5,2.5]),this._lineMatrix.showShot([2.5,2.5],[2.5,-2.5]);for(var a=10;a<this.width;a+=10)this._lineMatrix.showShot([-this.width/2+a,-this.height/2],[-this.width/2+a,this.height/2]);for(var n=10;n<this.height;n+=10)this._lineMatrix.showShot([-this.width/2,-this.height/2+n],[this.width/2,-this.height/2+n]);var o,l=_createForOfIteratorHelper(t);try{for(l.s();!(o=l.n()).done;){var h=o.value;this.spawnPoints.push(h)}}catch(t){l.e(t)}finally{l.f()}if(!this.root){var c=new Door(i,-1,0+e,this.height/2+9.2,0,r,s),_=new LightSwitch(25+e,this.height/2+12);_.exclude=!0,this.link(c),this.link(_)}return this}}])}();_defineProperty(_Map_,"_recording",{isRecording:!1,recording:void 0}),_defineProperty(_Map_,"spectating",{active:!0,avatar:void 0}),_defineProperty(_Map_,"_all",{});var Text=function(t){function e(t){var r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0;return _classCallCheck(this,e),(r=_callSuper(this,e,[[],function(){var e=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.GZ)(t,s);this.vertices=e.vertices,this.text=t,this.width=e.width,this.height=e.height,this.color=i||[0,0,0,1],this.size=s,this.texture=l||textures.misc.font,this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.offset),gl.disableVertexAttribArray(locations.textrUnit),gl.useProgram(program)},function(){ext.bindVertexArrayOES(this.vao),gl.uniform2fv(locations.translation,[this.trans.offsetX,this.trans.offsetY]),gl.uniform1f(locations.rotation,this.trans.rotation),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),gl.uniform4fv(locations.color,this._color),gl.uniform1i(locations.textColor,1),gl.drawArrays(gl.TRIANGLES,0,this.vertices.length/5),gl.uniform4fv(locations.color,[0,0,0,0]),gl.uniform1i(locations.textColor,0)},void 0,void 0,a,n,o])).segments=h,r.name="text",r.type="text",r.bottomLayer=!0,r.subLayer=1,r}return _inherits(e,t),_createClass(e,[{key:"update",value:function(t){var e=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.GZ)(t,this.size);this.vertices=new Float32Array(e.vertices),this.width=e.width,this.height=e.height,ext.bindVertexArrayOES(this.vao),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords)}},{key:"color",set:function(t){this._color=(0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Wg)(t)}}])}(_Object_),_Button_=function(t){function e(t,r,s,i,a,n){var o,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,h=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8?arguments[8]:void 0;return _classCallCheck(this,e),(o=_callSuper(this,e,[c||[-8.571428571428571,8.571428571428571,1,0,0,8.571428571428571,8.571428571428571,1,1,0,-8.571428571428571,-8.571428571428571,1,0,1,8.571428571428571,8.571428571428571,1,1,0,-8.571428571428571,-8.571428571428571,1,0,1,8.571428571428571,-8.571428571428571,1,1,1],function(){this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertices),gl.STATIC_DRAW),this.texture=t,this.textureActive=r,gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.offset),gl.disableVertexAttribArray(locations.textrUnit),gl.useProgram(program)},function(){ext.bindVertexArrayOES(this.vao),gl.uniform2fv(locations.translation,[this.trans.offsetX*this.scale,this.trans.offsetY*this.scale]),gl.uniform1f(locations.rotation,this.trans.rotation),gl.uniform1f(locations.scale,this.scale),this.enabled?gl.uniform1f(locations.transparency,1/controlTransparency):gl.uniform1f(locations.transparency,.5/controlTransparency),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.activeTexture(gl.TEXTURE0),this.active&&!h||h&&!this.on?gl.bindTexture(gl.TEXTURE_2D,this.textureActive):(!this.active&&!h||h&&this.on)&&gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,this.vertices.length/5),gl.uniform1f(locations.transparency,1)},2*n,2*n,s,i,0])).type="button",o.scale=l,o.enabled=!0,o.active=!1,o.radius=n/l,o.on=!1,o.action=a.bind(o),o}return _inherits(e,t),_createClass(e)}(_Object_),_Joystick_=function(t){function e(t){var r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0};return _classCallCheck(this,e),(r=_callSuper(this,e,[[-15,15,1,0,0,15,15,1,.5859375,0,-15,-15,1,0,.5859375,15,15,1,.5859375,0,-15,-15,1,0,.5859375,15,-15,1,.5859375,.5859375],function(){this.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),this.texture=textures.controls.joystick_disc,gl.vertexAttribPointer(locations.coords,3,gl.FLOAT,!1,20,0),gl.vertexAttribPointer(locations.tcoords,2,gl.FLOAT,!1,20,12),gl.enableVertexAttribArray(locations.coords),gl.enableVertexAttribArray(locations.tcoords),gl.disableVertexAttribArray(locations.offset),gl.disableVertexAttribArray(locations.textrUnit)},function(){this.desktopMovementAnimation.active&&this.desktopMovementAnimation.run(),(this.base.anchored||this.fixed)&&(ext.bindVertexArrayOES(this.vao),gl.uniform2fv(locations.translation,[this.base.x*s,this.base.y*s]),gl.uniform1f(locations.rotation,0),gl.uniform1f(locations.scale,this.scale),gl.uniform1f(locations.transparency,1/controlTransparency),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,this.vertices,gl.DYNAMIC_DRAW),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.useProgram(program),gl.drawArrays(gl.TRIANGLES,0,6),gl.uniform2fv(locations.translation,[this.thumb.x*s,this.thumb.y*s]),gl.bufferData(gl.ARRAY_BUFFER,this.thumbVertices,gl.DYNAMIC_DRAW),gl.drawArrays(gl.TRIANGLES,0,6),gl.uniform1f(locations.transparency,1),$CURRENT_MAP.move&&(t&&this.base.anchored&&($CURRENT_MAP.translate(this.distance.x*this.scale*movementMultFactor,this.distance.y*this.scale*movementMultFactor),$CURRENT_MAP.move&&($AVATAR.state.walking=!0,$AVATAR.state.seat.ref&&($AVATAR.state.seat.ref.seats[$AVATAR.state.seat.id].occupied=!1,$AVATAR.state.seat.ref=void 0,$AVATAR.state.seat.id=void 0))),!this.base.anchored||$AVATAR.state.equippedItems.mainTool||$AVATAR.state.punching||($AVATAR.trans.rotation=this.rotation),($CURRENT_MAP.move&&this.base.anchored&&!t||!$IS_MOBILE)&&$AVATAR.drawWeapon()))},30,30])).position=a,r.desktopMovementAnimation=new _src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.pF((function(){this.desktopMovementCallback()}),r,.01),r.base={x:a.x,y:a.y,width:30/s,height:30/s,anchored:!1,radius:15/s},r.scale=s,r.fixed=i,r.thumb={x:a.x,y:a.y,width:15/s,height:15/s},r.thumbVertices=new Float32Array([-7.5,7.5,1,0,0,7.5,7.5,1,.5859375,0,-7.5,-7.5,1,0,.5859375,7.5,7.5,1,.5859375,0,-7.5,-7.5,1,0,.5859375,7.5,-7.5,1,.5859375,.5859375]),r.distance={x:0,y:0,absolute:0},r.rotation=void 0,r.ratio=0,r.left=t,r.id=void 0,r.fix(),r}return _inherits(e,t),_createClass(e,[{key:"unanchor",value:function(){this.base.anchored=!1,!this.left&&$CURRENT_MAP.move&&($AVATAR.state.fire=!1,$AVATAR.state.punching=!1,$AVATAR.state.stabbing=!1)}},{key:"fix",value:function(){if(this.fixed){var t=this.position,e=t.x,r=t.y;this.base.x=e,this.base.y=r,this.thumb.x=e,this.thumb.y=r}}},{key:"translate",value:function(t,e){this.base.anchored||(this.fixed||(this.base.x=t,this.base.y=e),this.base.anchored=!0),this.thumb.x=t,this.thumb.y=e,this.distance.absolute=Math.round((0,_src_scripts_lib_js__WEBPACK_IMPORTED_MODULE_0__.Io)(this.base.x,this.base.y,t,e)),!this.left&&$CURRENT_MAP.move&&(this.distance.absolute!==this.base.radius||$AVATAR.state.pickup.current?($AVATAR.state.fire=!1,$AVATAR.state.punching=!1,$AVATAR.state.stabbing=!1):$AVATAR.state.armed?$AVATAR.state.fire=!0:$AVATAR.state.melee?$AVATAR.state.stabbing=!0:$AVATAR.state.punching=!0),this.distance.x=this.thumb.x-this.base.x,this.distance.y=this.thumb.y-this.base.y,this.rotation=Math.atan2(this.thumb.y-this.base.y,this.thumb.x-this.base.x)-1.5708,this.ratio=this.distance.x/this.distance.y}}])}(_Object_)}}]);